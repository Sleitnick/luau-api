
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Stephen Leitnick">
      
      
        <link rel="canonical" href="https://Sleitnick.github.io/luau-api/reference.html">
      
      
        <link rel="prev" href="index.html">
      
      
        <link rel="next" href="guides/setup.html">
      
      
        
      
      
      <link rel="icon" href="assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Reference - Luau C API</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#luau-c-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Luau C API" class="md-header__button md-logo" aria-label="Luau C API" data-md-component="logo">
      
  <img src="assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Luau C API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="reference.html" class="md-tabs__link">
        
  
  
    
  
  Reference

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="guides/setup.html" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Luau C API" class="md-nav__button md-logo" aria-label="Luau C API" data-md-component="logo">
      
  <img src="assets/logo.png" alt="logo">

    </a>
    Luau C API
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="reference.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#state-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        State Manipulation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="State Manipulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_newstate" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newstate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_newstate" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_newstate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_close" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_close
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_newthread" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newthread
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_mainthread" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_mainthread
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_resetthread" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_resetthread
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isthreadreset" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isthreadreset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_sandbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_sandbox
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_sandboxthread" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_sandboxthread
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-library-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Open Library Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Open Library Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lual_openlibs" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_openlibs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_base
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_coroutine" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_coroutine
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_os" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_os
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_string
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_bit32" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_bit32
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_buffer" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_buffer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_utf8" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_utf8
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_math" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_math
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_debug" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_debug
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#luaopen_vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaopen_vector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-stack-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic Stack Manipulation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic Stack Manipulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_absindex" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_absindex
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_gettop" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_gettop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_settop" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_settop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pop" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushvalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushvalue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_remove" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_remove
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_insert" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_insert
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_replace" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_replace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_checkstack" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_checkstack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkstack" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkstack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawcheckstack" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawcheckstack
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_xmove" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_xmove
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_xpush" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_xpush
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Access Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_iscfunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_iscfunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_islfunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isLfunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_typename" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_typename
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_equal" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_equal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawequal" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawequal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_lessthan" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_lessthan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_namecallatom" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_namecallatom
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_objlen" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_objlen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tocfunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tocfunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tothread" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tothread
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_topointer" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_topointer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#push-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Push Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Push Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_pushnil" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushnil
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushcclosurek" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushcclosurek
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushcclosure" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushcclosure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushcfunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushcfunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushthread" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushthread
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_createtable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_createtable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_newtable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newtable
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Get Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_gettable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_gettable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getfield" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getfield
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getglobal" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getglobal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawgetfield" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawgetfield
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawget" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawget
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawgeti" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawgeti
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setreadonly" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setreadonly
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getreadonly" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getreadonly
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setsafeenv" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setsafeenv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getsafeenv" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getsafeenv
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Set Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Set Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_settable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_settable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setfield" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setfield
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setglobal" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setglobal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawsetfield" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawsetfield
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawset" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawseti" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawseti
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setfenv" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setfenv
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#string-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        String Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="String Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_pushliteral" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushliteral
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushlstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushlstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushvfstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushvfstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushfstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushfstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tolstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tolstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tostring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tostring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tostringatom" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tostringatom
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tolstringatom" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tolstringatom
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_strlen" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_strlen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_tolstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_tolstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checklstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checklstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optlstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optlstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optstring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#number-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Number Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Number Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_pushnumber" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushnumber
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushinteger" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushinteger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushunsigned" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushunsigned
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tonumberx" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tonumberx
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tonumber" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tonumber
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tointegerx" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tointegerx
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tointeger" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tointeger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tounsignedx" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tounsignedx
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tounsigned" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tounsigned
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isnumber" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isnumber
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checknumber" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checknumber
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkinteger" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkinteger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkunsigned" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkunsigned
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optnumber" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optnumber
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optinteger" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optinteger
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optunsigned" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optunsigned
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boolean-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Boolean Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Boolean Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_pushboolean" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushboolean
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_toboolean" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_toboolean
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isboolean" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isboolean
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkboolean" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkboolean
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optboolean" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optboolean
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vector-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vector Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_pushvector" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushvector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tovector" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tovector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isvector" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isvector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkvector" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkvector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_optvector" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_optvector
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buffer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Buffer Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Buffer Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_newbuffer" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newbuffer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tobuffer" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tobuffer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isbuffer" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isbuffer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkbuffer" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkbuffer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metatable-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metatable Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metatable Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_setmetatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setmetatable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getmetatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getmetatable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setuserdatametatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setuserdatametatable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getuserdatametatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getuserdatametatable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getmetafield" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getmetafield
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_callmeta" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_callmeta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_newmetatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_newmetatable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_getmetatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_getmetatable
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userdata-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Userdata Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Userdata Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_newuserdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newuserdata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_newuserdatadtor" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newuserdatadtor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_newuserdatatagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newuserdatatagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_newuserdatataggedwithmetatable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_newuserdatataggedwithmetatable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_touserdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_touserdata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_touserdatatagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_touserdatatagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setuserdatatag" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setuserdatatag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_userdatatag" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_userdatatag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setuserdatadtor" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setuserdatadtor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getuserdatadtor" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getuserdatadtor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isuserdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isuserdata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkudata" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkudata
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#light-userdata-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Light Userdata Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Light Userdata Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_pushlightuserdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushlightuserdata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pushlightuserdatatagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pushlightuserdatatagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tolightuserdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tolightuserdata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_tolightuserdatatagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_tolightuserdatatagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_islightuserdata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_islightuserdata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_lightuserdatatag" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_lightuserdatatag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setlightuserdataname" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setlightuserdataname
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getlightuserdataname" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getlightuserdataname
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawsetptagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawsetptagged
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawgetptagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawgetptagged
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-and-call-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and Call Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Load and Call Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#luau_load" class="md-nav__link">
    <span class="md-ellipsis">
      
        luau_load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_call" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_call
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_pcall" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_pcall
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_cpcall" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_cpcall
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_callyieldable" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_callyieldable
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-and-call-functions_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and Call Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Load and Call Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_yield" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_yield
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_break" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_break
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_resume" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_resume
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_resumeerror" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_resumeerror
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_status" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_status
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isyieldable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isyieldable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getthreaddata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getthreaddata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setthreaddata" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setthreaddata
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_costatus" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_costatus
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Memory Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Memory Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_gc" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_gc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setmemcat" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setmemcat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_totalbytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_totalbytes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_error" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_error
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_error" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_error
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_typeerror" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_typeerror
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_argexpected" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_argexpected
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_argerror" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_argerror
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_argcheck" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_argcheck
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Miscellaneous Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Miscellaneous Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_next" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_next
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_rawiter" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_rawiter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_concat" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_concat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_encodepointer" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_encodepointer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_clock" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_clock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_clonefunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_clonefunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_cleartable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_cleartable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_clonetable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_clonetable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getallocf" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getallocf
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_callbacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_findtable" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_findtable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checktype" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checktype
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkoption" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkoption
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_checkany" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_checkany
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_register" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_register
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ref-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ref Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ref Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_ref" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_ref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_unref" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_unref
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getref" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getref
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Type Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_isfunction" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isfunction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_istable" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_istable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isnil" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isnil
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isthread" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isthread
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isnone" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isnone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_isnoneornil" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_isnoneornil
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_typename" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_typename
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#string-buffer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        String Buffer Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="String Buffer Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lual_buffinit" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_buffinit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_buffinitsize" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_buffinitsize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_prepbuffsize" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_prepbuffsize
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_addchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_addchar
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_addlstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_addlstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_addstring" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_addstring
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_addvalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_addvalue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_addvalueany" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_addvalueany
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_pushresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_pushresult
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_pushresultsize" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_pushresultsize
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debug-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debug Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Debug Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lua_stackdepth" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_stackdepth
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getinfo" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getinfo
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getargument" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getargument
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getlocal" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getlocal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setlocal" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setlocal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getupvalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getupvalue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_setupvalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_setupvalue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_singlestep" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_singlestep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_breakpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_breakpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_getcoverage" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_getcoverage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lua_debugtrace" class="md-nav__link">
    <span class="md-ellipsis">
      
        lua_debugtrace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lual_where" class="md-nav__link">
    <span class="md-ellipsis">
      
        luaL_where
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/setup.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/stack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/sandboxing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sandboxing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/atoms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Atoms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/tags.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/buffers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Buffers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/userdata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Userdata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/light-userdata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Light Userdata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/tables.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/pinning.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pinning and References
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/threads.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coroutine Threads
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/error-handling.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/native.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Native Code Gen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guides/native-userdata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Native Userdata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="luau-c-api-reference">Luau C API Reference<a class="headerlink" href="#luau-c-api-reference" title="Permanent link">&para;</a></h1>
<h2 id="state-manipulation">State Manipulation<a class="headerlink" href="#state-manipulation" title="Permanent link">&para;</a></h2>
<h3 id="lua_newstate"><span class="subsection"><code>lua_newstate</code></span><a class="headerlink" href="#lua_newstate" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* lua_newstate(lua_Alloc f, void* ud)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>f</code>: Luau allocator function.</li>
<li><code>ud</code>: Opaque userdata pointer that is passed to the allocator function.</li>
</ul>
<p>Creates a new Luau state. If the allocator fails to allocate
memory for the new state, this function will return <code>nullptr</code>.
Use <code>lua_close()</code> to close the state once done.</p>
<p>The allocator function is used for all Luau memory allocations, including the initial construction of the state itself.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="hll"><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newstate</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
</span></span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">lua_close</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span></code></pre></div>
<details class="note">
<summary>Allocator Example</summary>
<p>This is functionally identical to the allocator function used by the <code>luaL_newstate</code> helper function.
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">allocator</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ud</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">old_size</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">new_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">ud</span><span class="p">;</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">old_size</span><span class="p">;</span><span class="w"> </span><span class="c1">// Not using these</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="c1">// new_size of 0 indicates the allocator should free the ptr</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">new_size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">realloc</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">new_size</span><span class="p">);</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="p">}</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newstate</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
</span></code></pre></div></p>
</details>
<hr />
<h3 id="lual_newstate"><span class="subsection"><code>luaL_newstate</code></span><a class="headerlink" href="#lual_newstate" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* luaL_newstate()</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<p>A simplified version of <code>lua_newstate</code> that uses the default allocator, which uses the standard <code>free</code> and <code>realloc</code> memory functions.</p>
<hr />
<h3 id="lua_close"><span class="subsection"><code>lua_close</code></span><a class="headerlink" href="#lua_close" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_close()</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<p>Closes the Luau state. Luau objects are garbage collected and any dynamic memory is freed.</p>
<details class="note">
<summary>Smart Pointer Example</summary>
<p>In modern C++, smart pointers can help with memory management. Here is an example of
using a smart pointer that wraps around a Luau state and automatically calls <code>lua_close()</code>
when dereferenced.
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">lua_State</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="n">lua_State</span><span class="o">*</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">state</span><span class="p">(</span><span class="n">luaL_newState</span><span class="p">(),</span><span class="w"> </span><span class="n">lua_close</span><span class="p">);</span>
</span></code></pre></div></p>
</details>
<hr />
<h3 id="lua_newthread"><span class="subsection"><code>lua_newthread</code></span><a class="headerlink" href="#lua_newthread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* lua_newthread(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Parent thread</li>
</ul>
<p>Creates a new Luau thread.</p>
<hr />
<h3 id="lua_mainthread"><span class="subsection"><code>lua_mainthread</code></span><a class="headerlink" href="#lua_mainthread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* lua_mainthread(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Returns the main Lua state (e.g. the state created from <code>lua_newstate()</code>).</p>
<hr />
<h3 id="lua_resetthread"><span class="subsection"><code>lua_resetthread</code></span><a class="headerlink" href="#lua_resetthread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_resetthread(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Resets the Lua thread.</p>
<hr />
<h3 id="lua_isthreadreset"><span class="subsection"><code>lua_isthreadreset</code></span><a class="headerlink" href="#lua_isthreadreset" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isthreadreset(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Checks if the Lua thread is reset.</p>
<hr />
<h3 id="lual_sandbox"><span class="subsection"><code>luaL_sandbox</code></span><a class="headerlink" href="#lual_sandbox" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* luaL_sandbox(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Parent thread</li>
</ul>
<p>Sandboxes the Luau state. All libraries, built-in metatables, and globals are set to read-only. This also activates "safeenv" (<code>lua_setsafeenv</code>) on the global table.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_newstate</span><span class="p">();</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">luaL_openlibs</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1">// Sandboxing AFTER libraries are open:</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">luaL_sandbox</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lual_sandboxthread"><span class="subsection"><code>luaL_sandboxthread</code></span><a class="headerlink" href="#lual_sandboxthread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* luaL_sandboxthread(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Parent thread</li>
</ul>
<p>Sandboxes the given thread by creating a new global table that proxies the original global table.</p>
<p>This is useful to set per "script" rather than every single thread that is created (i.e. it's best to <em>not</em> call <code>luaL_sandboxthread</code> within the <code>userthread</code> callback, as that can cause long metafield index chains, which will also throw errors at a certain depth).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// Load and run a script:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">run_script</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">bytecode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">load_res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luau_load</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="p">).</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">bytecode</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">bytecode</span><span class="p">.</span><span class="n">length</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">load_res</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="c1">// ...handle error</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">load_res</span><span class="p">;</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">    </span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="n">lua_remove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span><span class="n">lua_xmove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="hll"><span class="w">    </span><span class="n">lua_sandboxthread</span><span class="p">(</span><span class="n">script</span><span class="p">);</span>
</span></span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">script</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">    </span><span class="c1">// ...handle status</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="open-library-functions">Open Library Functions<a class="headerlink" href="#open-library-functions" title="Permanent link">&para;</a></h2>
<h3 id="lual_openlibs"><span class="subsection"><code>luaL_openlibs</code></span><a class="headerlink" href="#lual_openlibs" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_openlibs(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens all built-in Luau libraries.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_newstate</span><span class="p">();</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">luaL_openlibs</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1">// ...</span>
</span></code></pre></div>
<hr />
<h3 id="luaopen_base"><span class="subsection"><code>luaopen_base</code></span><a class="headerlink" href="#luaopen_base" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_base(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the base global library functions, e.g. <code>print</code>, <code>error</code>, <code>tostring</code>, etc.</p>
<p>Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_coroutine"><span class="subsection"><code>luaopen_coroutine</code></span><a class="headerlink" href="#luaopen_coroutine" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_coroutine(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the coroutine library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_table"><span class="subsection"><code>luaopen_table</code></span><a class="headerlink" href="#luaopen_table" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_table(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the table library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_os"><span class="subsection"><code>luaopen_os</code></span><a class="headerlink" href="#luaopen_os" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_os(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the OS library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_string"><span class="subsection"><code>luaopen_string</code></span><a class="headerlink" href="#luaopen_string" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_string(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the string library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_bit32"><span class="subsection"><code>luaopen_bit32</code></span><a class="headerlink" href="#luaopen_bit32" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_bit32(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the bit32 library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_buffer"><span class="subsection"><code>luaopen_buffer</code></span><a class="headerlink" href="#luaopen_buffer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_buffer(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the buffer library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_utf8"><span class="subsection"><code>luaopen_utf8</code></span><a class="headerlink" href="#luaopen_utf8" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_utf8(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the UTF-8 library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_math"><span class="subsection"><code>luaopen_math</code></span><a class="headerlink" href="#luaopen_math" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_math(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the math library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_debug"><span class="subsection"><code>luaopen_debug</code></span><a class="headerlink" href="#luaopen_debug" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_debug(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the debug library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h3 id="luaopen_vector"><span class="subsection"><code>luaopen_vector</code></span><a class="headerlink" href="#luaopen_vector" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaopen_vector(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Opens the vector library. Use <a href="#lual_openlibs"><code>luaL_openlibs</code></a> to open all built-in Luau libraries, including this one.</p>
<hr />
<h2 id="basic-stack-manipulation">Basic Stack Manipulation<a class="headerlink" href="#basic-stack-manipulation" title="Permanent link">&para;</a></h2>
<h3 id="lua_absindex"><span class="subsection"><code>lua_absindex</code></span><a class="headerlink" href="#lua_absindex" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_absindex(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Index</li>
</ul>
<p>Gets the absolute stack index. For example, if <code>idx</code> is <code>-2</code>, and the stack has 5 items, this function will return <code>4</code>.</p>
<hr />
<h3 id="lua_gettop"><span class="subsection"><code>lua_gettop</code></span><a class="headerlink" href="#lua_gettop" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_gettop(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Gets the index representing the top of the stack. This also represents the number of items on the stack, since the stack index starts at 1. A stack size of 0 indicates an empty stack.</p>
<p>A common use of <code>lua_gettop()</code> is to get the number of arguments in a function call.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">custom_fn</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="n">lua_pushfstring</span><span class="p">(</span><span class="s">&quot;there are %d arguments&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_args</span><span class="p">);</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_settop"><span class="subsection"><code>lua_settop</code></span><a class="headerlink" href="#lua_settop" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_settop(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-?, +?, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Top stack index</li>
</ul>
<p>Sets the top of the stack, essentially resizing it to the given index. If the new size is larger than the current size, the new elements in the stack will be filled with <code>nil</code> values. Setting the stack size to 0 will clear the stack entirely.</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">lua_settop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// clear the stack</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pop"><span class="subsection"><code>lua_pop</code></span><a class="headerlink" href="#lua_pop" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pop(lua_State* L, int n)</code></span>
<span class="stack"><code>[-n, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>n</code>: Number of items to pop</li>
</ul>
<p>Pops <code>n</code> values off the top of the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">// Assume lua_gettop(L) == 0 here</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">);</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mf">85.2</span><span class="p">);</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Size: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">L</span><span class="p">));</span><span class="w"> </span><span class="c1">// Size: 3</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="hll"><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span></span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Size: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">L</span><span class="p">));</span><span class="w"> </span><span class="c1">// Size: 1</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Type: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span><span class="w"> </span><span class="c1">// string (top of stack is the &quot;Hello&quot; value now)</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushvalue"><span class="subsection"><code>lua_pushvalue</code></span><a class="headerlink" href="#lua_pushvalue" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushvalue(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Pushes a copy of the value at index <code>idx</code> to the top of the stack.</p>
<hr />
<h3 id="lua_remove"><span class="subsection"><code>lua_remove</code></span><a class="headerlink" href="#lua_remove" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_remove(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Removes the value at the given stack index <code>idx</code>. All other values above the index are shifted down.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="hll"><span class="n">lua_remove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span><span class="w"> </span><span class="c1">// remove the &#39;true&#39; value.</span>
</span></span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">luaL_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">));</span><span class="w"> </span><span class="c1">// &#39;hello&#39;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_insert"><span class="subsection"><code>lua_insert</code></span><a class="headerlink" href="#lua_insert" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_insert(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Moves the top stack element into the given index, shifting other values up first to give space. The element right under the top stack element becomes the new top element.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1">// Current stack order:</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c1">// [-4] true</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1">// [-3] 10</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c1">// [-2] hello</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c1">// [-1] 20</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="c1">// Move the top value (20) to index -3.</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c1">// The values below the top and above -3 are shifted up.</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="c1">// e.g. the &#39;10&#39; and &#39;hello&#39; are shifted up first.</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="hll"><span class="n">lua_insert</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span>
</span></span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c1">// New stack order:</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="c1">// [-4] true</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c1">// [-3] 20</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="c1">// [-2] 10</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="c1">// [-1] hello</span>
</span></code></pre></div>
<hr />
<h3 id="lua_replace"><span class="subsection"><code>lua_replace</code></span><a class="headerlink" href="#lua_replace" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_replace(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Moves the top element over top of the <code>idx</code> stack index. The old value at <code>idx</code> is overwritten. The top element is popped.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1">// Current stack order:</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="c1">// [-4] true</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="c1">// [-3] 10</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="c1">// [-2] hello</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c1">// [-1] 20</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="c1">// Move the top value (20) to index -3.</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="c1">// The values below the top and above -3 are shifted up.</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="c1">// e.g. the &#39;10&#39; and &#39;hello&#39; are shifted up first.</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="hll"><span class="n">lua_replace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span>
</span></span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="c1">// New stack order:</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="c1">// [-3] true</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="c1">// [-2] 20</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="c1">// [-1] hello</span>
</span></code></pre></div>
<hr />
<h3 id="lua_checkstack"><span class="subsection"><code>lua_checkstack</code></span><a class="headerlink" href="#lua_checkstack" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_checkstack(lua_State* L, int size)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>size</code>: Desired stack size</li>
</ul>
<p>Ensures the stack is large enough to hold <code>size</code> <em>more</em> elements. This will only grow the stack, not shrink it. Returns true if successful, or false if it fails (e.g. the max stack size exceeded).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">// Ensure there are at least 2 more slots on the stack:</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="hll"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_checkstack</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkstack"><span class="subsection"><code>luaL_checkstack</code></span><a class="headerlink" href="#lual_checkstack" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_checkstack(lua_State* L, int size, const char* msg)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>size</code>: Desired stack size</li>
<li><code>msg</code>: Error message</li>
</ul>
<p>Ensures the stack is large enough to hold <code>size</code> <em>more</em> elements. This will only grow the stack, not shrink it. Throws an error if the stack cannot be resized to the desired size.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1">// Ensure there are at least 2 more slots on the stack:</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">luaL_checkstack</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;failed to grow stack for the two numbers&quot;</span><span class="p">);</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_rawcheckstack"><span class="subsection"><code>lua_rawcheckstack</code></span><a class="headerlink" href="#lua_rawcheckstack" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_rawcheckstack(lua_State* L, int size)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>size</code>: Desired stack size</li>
</ul>
<p>Similar to <code>lua_checkstack</code>, except it bypasses the max stack limit.</p>
<hr />
<h3 id="lua_xmove"><span class="subsection"><code>lua_xmove</code></span><a class="headerlink" href="#lua_xmove" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_xmove(lua_State* from, lua_State* to, int n)</code></span>
<span class="stack"><code>[-?, +?, -]</code></span></p>
<ul>
<li><code>from</code>: Lua thread</li>
<li><code>to</code>: Lua thread</li>
<li><code>n</code>: Number of items to move</li>
</ul>
<p>Moves the top <code>n</code> elements in the <code>from</code> stack to the top of the <code>to</code> stack. This pops <code>n</code> values from the <code>from</code> stack and pushes <code>n</code> values to the <code>to</code> stack.</p>
<p>Note: Both <code>from</code> and <code>to</code> states must share the same global state (e.g. the main state created with <code>lua_newstate</code>).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">// Assume we have lua_State* A and B, both starting with empty stacks.</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1">// Add some items to &#39;A&#39; stack:</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c1">// Moves the top 2 values from &#39;A&#39; to &#39;B&#39; (e.g. &#39;10&#39; and &#39;hello&#39;)</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="hll"><span class="n">lua_xmove</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span></span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">A</span><span class="p">));</span><span class="w"> </span><span class="c1">// 1 (just the &#39;true&#39; value remains)</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_gettop</span><span class="p">(</span><span class="n">B</span><span class="p">));</span><span class="w"> </span><span class="c1">// 2 (the &#39;10&#39; and &#39;hello&#39; values)</span>
</span></code></pre></div>
<hr />
<h3 id="lua_xpush"><span class="subsection"><code>lua_xpush</code></span><a class="headerlink" href="#lua_xpush" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_xpush(lua_State* from, lua_State* to, int idx)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>from</code>: Lua thread</li>
<li><code>to</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Pushes a value from the <code>from</code> state to the <code>to</code> state. The value at index <code>idx</code> in <code>from</code> is pushed to the top of the <code>to</code> stack. This is similar to <code>lua_pushvalue</code>, except the value is pushed to a different state.</p>
<p>Similar to <code>lua_xmove</code>, both <code>from</code> and <code>to</code> must share the same global state.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">// Push the value at index -2 within &#39;from&#39; to the top of the &#39;to&#39; stack:</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">lua_xpush</span><span class="p">(</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h2 id="access-functions">Access Functions<a class="headerlink" href="#access-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_iscfunction"><span class="subsection"><code>lua_iscfunction</code></span><a class="headerlink" href="#lua_iscfunction" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_iscfunction(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the value at the given stack index is a C function. Otherwise, returns <code>0</code>.</p>
<hr />
<h3 id="lua_islfunction"><span class="subsection"><code>lua_isLfunction</code></span><a class="headerlink" href="#lua_islfunction" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isLfunction(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the value at the given stack index is a Luau function. Otherwise, returns <code>0</code>.</p>
<hr />
<h3 id="lua_type"><span class="subsection"><code>lua_type</code></span><a class="headerlink" href="#lua_type" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_type(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the value type at the given stack index. If the stack index is invalid, this function returns <code>LUA_TNONE</code>.</p>
<p>List of lua types:</p>
<ul>
<li><code>LUA_TNIL</code></li>
<li><code>LUA_TBOOLEAN</code></li>
<li><code>LUA_TLIGHTUSERDATA</code></li>
<li><code>LUA_TNUMBER</code></li>
<li><code>LUA_TVECTOR</code></li>
<li><code>LUA_TSTRING</code></li>
<li><code>LUA_TTABLE</code></li>
<li><code>LUA_TFUNCTION</code></li>
<li><code>LUA_TUSERDATA</code></li>
<li><code>LUA_TTHREAD</code></li>
<li><code>LUA_TBUFFER</code></li>
</ul>
<hr />
<h3 id="lua_typename"><span class="subsection"><code>lua_typename</code></span><a class="headerlink" href="#lua_typename" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_typename(lua_State* L, int tp)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tp</code>: Luau type</li>
</ul>
<p>Returns the name of the given type.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">thread_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_type</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">LUA_TTHREAD</span><span class="p">);</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">thread_name</span><span class="p">);</span><span class="w"> </span><span class="c1">// &gt; &quot;thread&quot;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_equal"><span class="subsection"><code>lua_equal</code></span><a class="headerlink" href="#lua_equal" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_equal(lua_State* L, int idx1, int idx2)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx1</code>: Stack index</li>
<li><code>idx2</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the values at <code>idx1</code> and <code>idx2</code> are equal. If applicable, this will call the <code>__eq</code> metatable function. Use <code>lua_rawequal</code> to avoid the metatable call. Returns <code>0</code> if the values are not equal (including if either of the indices are invalid).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="hll"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_equal</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;equal</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_rawequal"><span class="subsection"><code>lua_rawequal</code></span><a class="headerlink" href="#lua_rawequal" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_rawequal(lua_State* L, int idx1, int idx2)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx1</code>: Stack index</li>
<li><code>idx2</code>: Stack index</li>
</ul>
<p>The same as <code>lua_equal</code>, except it does not call any metatable <code>__eq</code> functions.</p>
<hr />
<h3 id="lua_lessthan"><span class="subsection"><code>lua_lessthan</code></span><a class="headerlink" href="#lua_lessthan" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_lessthan(lua_State* L, int idx1, int idx2)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx1</code>: Stack index</li>
<li><code>idx2</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the value at <code>idx</code> is less than the value at <code>idx2</code>. Otherwise, returns <code>0</code>. This may call the <code>__lt</code> metamethod function. Also returns <code>0</code> if either index is invalid.</p>
<hr />
<h3 id="lua_namecallatom"><span class="subsection"><code>lua_namecallatom</code></span><a class="headerlink" href="#lua_namecallatom" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_namecallatom(lua_State* L, int* atom)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>atom</code>: Atom</li>
</ul>
<p>When called within a <code>__namecall</code> metamethod, this function returns the name of the called method. An optional atom value can be utilized as well.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">static</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">kFoo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">;</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1">// Handle namecalls, e.g. Luau calling &quot;foo:Hello()&quot;</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="hll"><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Foo_namecall</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="hll"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_namecallatom</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
</span></span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="hll"><span class="w">        </span><span class="c1">// User called the &#39;Hello&#39; method. Return &quot;Goodbye&quot;:</span>
</span></span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="hll"><span class="w">        </span><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Goodbye&quot;</span><span class="p">);</span>
</span></span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="hll"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span></span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span></span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="hll"><span class="w">    </span><span class="n">luaL_error</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;unknown method %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="p">);</span>
</span></span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="hll"><span class="p">}</span>
</span></span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="c1">// Construct new Foo userdata:</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="kt">int</span><span class="w"> </span><span class="nf">new_Foo</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">)));</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">luaL_newmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFoo</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">        </span><span class="c1">// Assign __namecall metamethod:</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="w">        </span><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_namecall</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namecall&quot;</span><span class="p">);</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="w">        </span><span class="n">lua_rawsetfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;__namecall&quot;</span><span class="p">);</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="w">    </span><span class="n">lua_setmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a><span class="p">}</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">luaL_Reg</span><span class="p">[]</span><span class="w"> </span><span class="n">Foo_lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a><span class="w">    </span><span class="p">{</span><span class="s">&quot;new&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">new_Foo</span><span class="p">},</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a><span class="w">    </span><span class="p">{</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">},</span>
</span><span id="__span-18-31"><a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a><span class="p">};</span>
</span><span id="__span-18-32"><a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>
</span><span id="__span-18-33"><a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a><span class="c1">// Called from setup code for Luau state:</span>
</span><span id="__span-18-34"><a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a><span class="kt">void</span><span class="w"> </span><span class="nf">open_Foo</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-35"><a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a><span class="w">    </span><span class="n">lua_register</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_lib</span><span class="p">);</span>
</span><span id="__span-18-36"><a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_objlen"><span class="subsection"><code>lua_objlen</code></span><a class="headerlink" href="#lua_objlen" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_objlen(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the length of the value at the given stack index. This works for tables (array length), strings (string length), buffers (buffer size), and userdata (userdata size). For non-applicable types, this function will return <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">lua_newbuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">);</span><span class="w"> </span><span class="c1">// 5 (length of &quot;hello&quot;)</span>
</span></span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 12 (size of buffer)</span>
</span></span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span><span class="w"> </span><span class="c1">// 15 (size of userdata)</span>
</span></span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// 0 (integer type is N/A, thus 0 is returned)</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_tocfunction"><span class="subsection"><code>lua_tocfunction</code></span><a class="headerlink" href="#lua_tocfunction" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_CFunction lua_tocfunction(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the C function at the given stack position. If the value is not a C function, this function returns <code>NULL</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">hello</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;hello</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="p">}</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="hll"><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">hello</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span></span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">lua_CFunction</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tocfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">  </span><span class="n">f</span><span class="p">();</span><span class="w"> </span><span class="c1">// hello</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tothread"><span class="subsection"><code>lua_tothread</code></span><a class="headerlink" href="#lua_tothread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_State* lua_tothread(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the Luau thread at the given stack index, or <code>NULL</code> if the value is not a Luau thread.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="c1">// pushes T onto L&#39;s stack</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="hll"><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="kr">thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tothread</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// retrieve T from L&#39;s stack</span>
</span></span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1">// thread == T</span>
</span></code></pre></div>
<hr />
<h3 id="lua_topointer"><span class="subsection"><code>lua_topointer</code></span><a class="headerlink" href="#lua_topointer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_topointer(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns a pointer to the value at the given stack index. This works for userdata, lightuserdata, strings, tables, buffers, and functions.</p>
<p><strong>Note:</strong> This should only be used for debugging purposes.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newbuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="hll"><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tobuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">len</span><span class="p">);</span>
</span></span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c1">// b == buf</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="c1">// len == 10</span>
</span></code></pre></div>
<hr />
<h2 id="push-functions">Push Functions<a class="headerlink" href="#push-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_pushnil"><span class="subsection"><code>lua_pushnil</code></span><a class="headerlink" href="#lua_pushnil" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushnil(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Pushes <code>nil</code> to the Luau stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushcclosurek"><span class="subsection"><code>lua_pushcclosurek</code></span><a class="headerlink" href="#lua_pushcclosurek" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushcclosurek(lua_State* L, lua_CFunction fn, const char* debugname, int nup, lua_Continuation cont)</code></span>
<span class="stack"><code>[-n, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>fn</code>: C Function</li>
<li><code>debugname</code>: Debug name</li>
<li><code>nup</code>: Number of upvalues to capture</li>
<li><code>cont</code>: Continuation function to invoke</li>
</ul>
<p>Pushes the C function to the stack as a closure, which captures and pops <code>nup</code> upvalues from the top of the stack. The closure's continuation function is also assigned to <code>cont</code>.</p>
<p>The continuation function is invoked when the closure is resumed.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">addition_cont</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lua_upvalueindex</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="w"> </span><span class="c1">// 4</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">add</span><span class="p">;</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">);</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="c1">// Stop generator if sum exceeds 100 (this would obviously be bad if &#39;add&#39; was &lt;= 0)</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sum</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">lua_yield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="p">}</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="kt">int</span><span class="w"> </span><span class="nf">addition</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lua_upvalueindex</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="c1">// 10</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lua_upvalueindex</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="w"> </span><span class="c1">// 4</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">add</span><span class="p">);</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">lua_yield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="p">}</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="kt">int</span><span class="w"> </span><span class="nf">start_addition</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="w">    </span><span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="w">    </span><span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="hll"><span class="w">    </span><span class="n">lua_pushcclosurek</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">addition</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;addition&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">addition_cont</span><span class="p">);</span>
</span></span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="p">}</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="c1">// Expose &quot;start_addition&quot; to Luau:</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="n">set_global</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;start_addition&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">start_addition</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-lua highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">-- Start adder generator from 10 and add by 4:</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="kd">local</span><span class="w"> </span><span class="nv">adder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">coroutine.wrap</span><span class="p">(</span><span class="nf">start_addition</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="kr">do</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">adder</span><span class="p">()</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="nv">sum</span><span class="p">)</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="kr">until</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">sum</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushcclosure"><span class="subsection"><code>lua_pushcclosure</code></span><a class="headerlink" href="#lua_pushcclosure" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushcclosure(lua_State* L, lua_CFunction fn, const char* debugname, int nup)</code></span>
<span class="stack"><code>[-n, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>fn</code>: C Function</li>
<li><code>debugname</code>: Debug name</li>
<li><code>nup</code>: Number of upvalues to capture</li>
</ul>
<p>Equivalent to <code>lua_pushcclosurek</code>, but without any continuation function provided.</p>
<hr />
<h3 id="lua_pushcfunction"><span class="subsection"><code>lua_pushcfunction</code></span><a class="headerlink" href="#lua_pushcfunction" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushcfunction(lua_State* L, lua_CFunction fn, const char* debugname)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>fn</code>: C Function</li>
<li><code>debugname</code>: Debug name</li>
</ul>
<p>Pushes the C function to the stack.</p>
<p>Equivalent to <code>lua_pushcclosurek</code>, but without any upvalues nor any continuation function.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">multiply</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="p">}</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="hll"><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">multiply</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;multiply&quot;</span><span class="p">);</span>
</span></span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="n">lua_setglobal</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;multiply&quot;</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-luau highlight"><span class="filename">Luau Example</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nf">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">2</span><span class="s2"> * 5 = &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nf">multiply</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">))</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushthread"><span class="subsection"><code>lua_pushthread</code></span><a class="headerlink" href="#lua_pushthread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_pushthread(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Pushes the thread (L) to the stack. Returns <code>1</code> if the thread is the main thread, otherwise <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="hll"><span class="n">lua_pushthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span></span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tothread</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1">// T == L</span>
</span></code></pre></div>
<hr />
<h3 id="lua_createtable"><span class="subsection"><code>lua_createtable</code></span><a class="headerlink" href="#lua_createtable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_createtable(lua_State* L, int narr, int nrec)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>narr</code>: Array size</li>
<li><code>nrec</code>: Dictionary size</li>
</ul>
<p>Pushes a new table onto the stack, allocating <code>narr</code> slots on the array portion and <code>nrec</code> slots on the dictionary portion. Use <a href="#lua_newtable"><code>lua_newtable</code></a> to create a table with zero size allocation, equivalent to <code>lua_createtable(0, 0)</code>.</p>
<p>These allocated slots are <em>not</em> filled.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">lua_createtable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// Push a new table onto the stack with 10 array slots allocated</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c1">// 10 slots allocated, but not filled, e.g. lua_objlen(L, -1) == 0</span>
</span></code></pre></div>
<hr />
<h3 id="lua_newtable"><span class="subsection"><code>lua_newtable</code></span><a class="headerlink" href="#lua_newtable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_newtable(lua_State* L)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Pushes a new table onto the stack. This is equivalent to <code>lua_createtable(L, 0, 0)</code>.</p>
<hr />
<h2 id="get-functions">Get Functions<a class="headerlink" href="#get-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_gettable"><span class="subsection"><code>lua_gettable</code></span><a class="headerlink" href="#lua_gettable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_gettable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Pushes a value from a table onto the stack. The table is at index <code>idx</code> on the stack, and the key into the table is on the top of the stack. This function pops the key at the top of the stack. The <code>__index</code> metamethod may be triggered when using this function.  If this is undesirable, use <a href="#lua_rawget"><code>lua_rawget</code></a> instead.</p>
<p>Returns the type of the value.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">// Assume the top of the stack is the Luau table: { &quot;hello&quot; = 40 }</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_gettable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Our key &quot;hello&quot; is at the top of the stack, and -2 is the table.</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c1">// t == LUA_TNUMBER</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="c1">// lua_tonumber(L, -1) == 40</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getfield"><span class="subsection"><code>lua_getfield</code></span><a class="headerlink" href="#lua_getfield" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getfield(lua_State* L, int idx, const char* k)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>k</code>: Field</li>
</ul>
<p>Pushes a value from a table onto the stack. The table is at index <code>idx</code> on the stack, and the key into the table is <code>k</code>. The <code>__index</code> metamethod may be triggered when using this function. If this is undesirable, use <a href="#lua_rawgetfield"><code>lua_rawgetfield</code></a> instead.</p>
<p>Returns the type of the value.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">// Assume the top of the stack is the Luau table: { &quot;hello&quot; = 40 }</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_getfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Our key &quot;hello&quot; is at the top of the stack, and -2 is the table.</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="c1">// t == LUA_TNUMBER</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="c1">// lua_tonumber(L, -1) == 40</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getglobal"><span class="subsection"><code>lua_getglobal</code></span><a class="headerlink" href="#lua_getglobal" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getglobal(lua_State* L, const char* k)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>k</code>: Field</li>
</ul>
<p>Pushes a value from the global table onto the stack. Use <a href="#lua_setglobal"><code>lua_setglobal</code></a> to set a new global value.</p>
<p>Returns the type of the value.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">lua_setglobal</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;message&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// _G.message = &quot;hello&quot;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="hll"><span class="n">lua_getglobal</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;message&quot;</span><span class="p">);</span>
</span></span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// s == &quot;hello&quot;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_rawgetfield"><span class="subsection"><code>lua_rawgetfield</code></span><a class="headerlink" href="#lua_rawgetfield" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_rawgetfield(lua_State* L, int idx, const char* k)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>k</code>: Field</li>
</ul>
<p>This is the same as <a href="#lua_getfield"><code>lua_getfield</code></a>, except no <code>__index</code> metamethod is ever called.</p>
<hr />
<h3 id="lua_rawget"><span class="subsection"><code>lua_rawget</code></span><a class="headerlink" href="#lua_rawget" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_rawget(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>This is the same as <a href="#lua_gettable"><code>lua_gettable</code></a>, except no <code>__index</code> metamethod is ever called.</p>
<hr />
<h3 id="lua_rawgeti"><span class="subsection"><code>lua_rawgeti</code></span><a class="headerlink" href="#lua_rawgeti" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_rawgeti(lua_State* L, int idx, int n)</code></span>
<span class="stack"><code>[-1, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>n</code>: Table index</li>
</ul>
<p>Pushes the table value at index <code>n</code> onto the stack. The table is located on the stack at <code>idx</code>. Similar to <code>lua_rawget</code>, no metamethods are called. Note that Luau tables start at index <code>1</code>, not <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1">// Assume the top of the stack is the Luau table: { 5, 15, 30 }</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="hll"><span class="n">lua_rawgeti</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// t[2]</span>
</span></span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="kt">double</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// 15</span>
</span></code></pre></div>
<hr />
<h3 id="lua_setreadonly"><span class="subsection"><code>lua_setreadonly</code></span><a class="headerlink" href="#lua_setreadonly" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setreadonly(lua_State* L, int idx, int enabled)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>enabled</code>: Readonly enabled</li>
</ul>
<p>Sets the read-only state of a table. Read-only tables ensure that table values cannot be modified, added, or removed. This is only a shallow application, i.e. a nested table may still be writable.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="n">lua_rawsetfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;message&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// t.message = &quot;hello&quot;</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="hll"><span class="n">lua_setreadonly</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_getreadonly"><span class="subsection"><code>lua_getreadonly</code></span><a class="headerlink" href="#lua_getreadonly" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getreadonly(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the table is marked as read-only, otherwise <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// Assume a table is at the top of the stack</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">lua_getreadonly</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="c1">// Safe to modify table</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="hll"><span class="p">}</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_setsafeenv"><span class="subsection"><code>lua_setsafeenv</code></span><a class="headerlink" href="#lua_setsafeenv" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setsafeenv(lua_State* L, int idx, int enabled)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>enabled</code>: Safe environment enabled</li>
</ul>
<p>Sets the safe-env state of a thread. TODO.</p>
<hr />
<h3 id="lua_getsafeenv"><span class="subsection"><code>lua_getsafeenv</code></span><a class="headerlink" href="#lua_getsafeenv" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getsafeenv(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Gets the safe-env state of a thread. TODO.</p>
<hr />
<h2 id="set-functions">Set Functions<a class="headerlink" href="#set-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_settable"><span class="subsection"><code>lua_settable</code></span><a class="headerlink" href="#lua_settable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_settable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-2, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Sets the value of a table index, e.g. <code>t[k] = v</code>, where <code>t</code> is located on the stack at <code>idx</code>, and the key and value are on the top of the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="hll"><span class="n">lua_settable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span><span class="w"> </span><span class="c1">// t.hello = 50</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_setfield"><span class="subsection"><code>lua_setfield</code></span><a class="headerlink" href="#lua_setfield" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setfield(lua_State* L, int idx, const char* k)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>k</code>: Field</li>
</ul>
<p>Sets the value of a table index, e.g. <code>t[k] = v</code>, where <code>t</code> is located on the stack at <code>idx</code>, and the value is on the top of the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">);</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="hll"><span class="n">lua_setfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// t.hello = 50</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_setglobal"><span class="subsection"><code>lua_setglobal</code></span><a class="headerlink" href="#lua_setglobal" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setglobal(lua_State* L, const char* k)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>k</code>: Field</li>
</ul>
<p>Places the value at the top of the stack into the global table at key <code>k</code>. The value is popped from the stack. Use <a href="#lua_getglobal"><code>lua_getglobal</code></a> to retrieve the value.</p>
<p>As implied by the name, globals are globally-accessible to Luau.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">lua_setglobal</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;message&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// _G.message = &quot;hello&quot;</span>
</span></code></pre></div>
<div class="language-luau highlight"><span class="filename">Luau Example</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="nf">print</span><span class="p">(</span><span class="nv">message</span><span class="p">)</span><span class="w"> </span><span class="c1">-- &quot;hello&quot;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_rawsetfield"><span class="subsection"><code>lua_rawsetfield</code></span><a class="headerlink" href="#lua_rawsetfield" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_rawsetfield(lua_State* L, int idx, const char* k)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>k</code>: Field</li>
</ul>
<p>The same as <a href="#lua_setfield"><code>lua_setfield</code></a>, except no metamethods are invoked.</p>
<hr />
<h3 id="lua_rawset"><span class="subsection"><code>lua_rawset</code></span><a class="headerlink" href="#lua_rawset" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_rawset(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-2, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>The same as <a href="#lua_settable"><code>lua_settable</code></a>, except no metamethods are invoked.</p>
<hr />
<h3 id="lua_rawseti"><span class="subsection"><code>lua_rawseti</code></span><a class="headerlink" href="#lua_rawseti" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_rawseti(lua_State* L, int idx, int n)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>n</code>: Table index</li>
</ul>
<p>Performs <code>t[n] = v</code>, where <code>t</code> is the table on the stack at <code>idx</code>, and <code>v</code> is the value on the top of the stack. The top value is also popped.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="hll"><span class="w">    </span><span class="n">lua_rawseti</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"> </span><span class="c1">// t[i] = i * 10</span>
</span></span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_setfenv"><span class="subsection"><code>lua_setfenv</code></span><a class="headerlink" href="#lua_setfenv" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setfenv(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Sets the environment of the value at <code>idx</code> to the table on the top of the stack, and pops this top value. Returns <code>0</code> if the value at the given index is not an applicable type for setting an environment (e.g. a number), otherwise returns <code>1</code>.</p>
<hr />
<h2 id="string-functions">String Functions<a class="headerlink" href="#string-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_pushliteral"><span class="subsection"><code>lua_pushliteral</code></span><a class="headerlink" href="#lua_pushliteral" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushliteral(lua_State* L, const char* str)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>str</code>: C-style string</li>
</ul>
<p>Pushes the string literal <code>str</code> to the stack with a length of <code>len</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushlstring"><span class="subsection"><code>lua_pushlstring</code></span><a class="headerlink" href="#lua_pushlstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushlstring(lua_State* L, const char* str, size_t len)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>str</code>: C-style string</li>
<li><code>len</code>: String length</li>
</ul>
<p>Pushes string <code>str</code> to the stack with a length of <code>len</code>.</p>
<p>Internally, strings in Luau are copied and interned. Thus, modifications made to the inputted string will not be reflected in the Luau string value.</p>
<p>This function is preferred over <a href="#lua_pushstring"><code>lua_pushstring</code></a> if the string length is known, or if the string contains <code>\0</code> characters as part of the string itself.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">;</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="n">lua_pushlstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushstring"><span class="subsection"><code>lua_pushstring</code></span><a class="headerlink" href="#lua_pushstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushstring(lua_State* L, const char* str)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>str</code>: C-style string</li>
</ul>
<p>Pushes string <code>str</code> to the stack. The length of the string is determined internally using the C <code>strlen</code> function.</p>
<p>If the length of the string is known, it is more efficient to use <a href="#lua_pushlstring"><code>lua_pushlstring</code></a>.</p>
<p>Internally, strings in Luau are copied and interned. Thus, modifications made to the inputted string will not be reflected in the Luau string value.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">;</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="n">lua_pushstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushvfstring"><span class="subsection"><code>lua_pushvfstring</code></span><a class="headerlink" href="#lua_pushvfstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_pushvfstring(lua_State* L, const char* fmt, va_list argp)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>fmt</code>: C-style string for formatting</li>
<li><code>argp</code>: Format arguments</li>
</ul>
<p>Pushes a string to the stack, where the string is <code>fmt</code> formatted against the arguments in <code>argp</code>. The formatted string is also returned.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">format_something</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">);</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">    </span><span class="n">lua_pushvfstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="p">}</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="n">format_something</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;number: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushfstring"><span class="subsection"><code>lua_pushfstring</code></span><a class="headerlink" href="#lua_pushfstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_pushfstring(lua_State* L, const char* fmt,  ...)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>fmt</code>: C-style string for formatting</li>
<li><code>...</code>: Format arguments</li>
</ul>
<p>Pushes a string to the stack, where the string is <code>fmt</code> formatted against the arguments. The formatted string is also returned.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;number: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tolstring"><span class="subsection"><code>lua_tolstring</code></span><a class="headerlink" href="#lua_tolstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_tolstring(lua_State* L, int idx, size_t len)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>len</code>: String length</li>
</ul>
<p>Returns the value at the given stack index converted to a string. The length of the string is written to <code>len</code>. Like C strings, Luau strings are terminated with <code>\0</code>; however, Luau strings may contain <code>\0</code> within the string before the end, thus using the <code>len</code> argument is imperative for proper consumption. In other words, functions like <code>strlen</code> that scan for <code>\0</code> may return lengths that are too short.</p>
<p><strong>Note:</strong> This will <em>modify</em> the value at the given stack index if it is a number, turning it into a Luau string. If the value at the given stack index is neither a string nor a number, this function will return <code>NULL</code>, and the <code>len</code> argument will be set to <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example 1</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span><span class="p">);</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="hll"><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>
</span></span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="hll"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tolstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">len</span><span class="p">);</span>
</span></span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;message (len: %zu): </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span><span class="w"> </span><span class="c1">// message (len: 11) &quot;hello world&quot;</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="p">}</span>
</span></code></pre></div>
<p>As noted above, <code>lua_tolstring</code> will convert numbers into strings at their given stack index. If this effect is undesirable, either use <code>lua_isstring()</code> first, or use the auxilery <code>luaL_tolstring</code> function instead.
<div class="language-cpp highlight"><span class="filename">Example 2</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="c1">// The value at index -1 will be converted from a number to a string:</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tolstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">len</span><span class="p">);</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Type: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span><span class="w"> </span><span class="c1">// Type: string</span>
</span></code></pre></div></p>
<hr />
<h3 id="lua_tostring"><span class="subsection"><code>lua_tostring</code></span><a class="headerlink" href="#lua_tostring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_tostring(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Equivalent to <a href="#lua_tolstring"><code>lua_tolstring</code></a>, without the length argument.</p>
<hr />
<h3 id="lua_tostringatom"><span class="subsection"><code>lua_tostringatom</code></span><a class="headerlink" href="#lua_tostringatom" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_tostringatom(lua_State* L, int idx, int* atom)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>atom</code>: Atom</li>
</ul>
<p>Identical to <a href="#lua_tostring"><code>lua_tostring</code></a>, except the string atom is written to the <code>atom</code> argument. See the <a href="guides/atoms.html">Atoms</a> page for more information on string atoms.</p>
<hr />
<h3 id="lua_tolstringatom"><span class="subsection"><code>lua_tolstringatom</code></span><a class="headerlink" href="#lua_tolstringatom" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_tolstringatom(lua_State* L, int idx, size_t len, int* atom)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>len</code>: String length</li>
<li><code>atom</code>: Atom</li>
</ul>
<p>Identical to <a href="#lua_tolstring"><code>lua_tolstring</code></a>, except the string atom is written to the <code>atom</code> argument. See the <a href="guides/atoms.html">Atoms</a> page for more information on string atoms.</p>
<hr />
<h3 id="lua_strlen"><span class="subsection"><code>lua_strlen</code></span><a class="headerlink" href="#lua_strlen" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_strlen(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Alias for <a href="#lua_objlen"><code>lua_objlen</code></a>.</p>
<hr />
<h3 id="lua_isstring"><span class="subsection"><code>lua_isstring</code></span><a class="headerlink" href="#lua_isstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isstring(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the value at the given stack index is a string <em>or</em> a number (all numbers can be converted to a string). Otherwise, returns <code>0</code>.</p>
<hr />
<h3 id="lual_tolstring"><span class="subsection"><code>luaL_tolstring</code></span><a class="headerlink" href="#lual_tolstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_tolstring(lua_State* L, int idx, size_t len)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>len</code>: String length</li>
</ul>
<p>Converts the value at the given index into a string. This string is both pushed onto the stack and returned. Unlike <code>lua_tolstring</code> and <code>lua_tostring</code>, this function does <em>not</em> modify the value at the given stack index.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="n">lua_pushvector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">);</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="hll"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">vstr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tolstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
</span></span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// pop vstr from the stack</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;vector: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">vstr</span><span class="p">);</span><span class="w"> </span><span class="c1">// &quot;vector: 10, 20, 30&quot;</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checklstring"><span class="subsection"><code>luaL_checklstring</code></span><a class="headerlink" href="#lual_checklstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_checklstring(lua_State* L, int idx, size_t len)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>len</code>: String length</li>
</ul>
<p>Similar to <a href="#lua_tolstring"><code>lua_tolstring</code></a>, except the type will be asserted. If the value is not a string, an error will be thrown.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">send_message</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">message_len</span><span class="p">;</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checklstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">message_len</span><span class="p">);</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkstring"><span class="subsection"><code>luaL_checkstring</code></span><a class="headerlink" href="#lual_checkstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_checkstring(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Equivalent to <a href="#lual_checklstring"><code>luaL_checklstring(L, idx, nullptr)</code></a>.</p>
<hr />
<h3 id="lual_optlstring"><span class="subsection"><code>luaL_optlstring</code></span><a class="headerlink" href="#lual_optlstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_optlstring(lua_State* L, int idx, const char* def, size_t len)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default string</li>
<li><code>len</code>: String length</li>
</ul>
<p>Gets the string at the given stack index. If the value at the given index is nil or none, then <code>def</code> is returned instead. Otherwise, an error is thrown.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">send_message</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">message_len</span><span class="p">;</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_optlstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Default message&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">message_len</span><span class="p">);</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_optstring"><span class="subsection"><code>luaL_optstring</code></span><a class="headerlink" href="#lual_optstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_optstring(lua_State* L, int idx, const char* def)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default string</li>
</ul>
<p>Equivalent to <a href="#lual_optlstring"><code>luaL_optlstring(L, idx, def, nullptr)</code></a>.</p>
<hr />
<h2 id="number-functions">Number Functions<a class="headerlink" href="#number-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_pushnumber"><span class="subsection"><code>lua_pushnumber</code></span><a class="headerlink" href="#lua_pushnumber" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushnumber(lua_State* L, double n)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>n</code>: Number</li>
</ul>
<p>Pushes <code>n</code> to the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mf">15.2</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushinteger"><span class="subsection"><code>lua_pushinteger</code></span><a class="headerlink" href="#lua_pushinteger" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushinteger(lua_State* L, int n)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>n</code>: Number</li>
</ul>
<p>Pushes <code>n</code> to the stack. Note that all Luau numbers are doubles, so the value of <code>n</code> will be cast to a <code>double</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pushunsigned"><span class="subsection"><code>lua_pushunsigned</code></span><a class="headerlink" href="#lua_pushunsigned" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushunsigned(lua_State* L, unsigned int n)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>n</code>: Number</li>
</ul>
<p>Pushes <code>n</code> to the stack. Note that all Luau numbers are doubles, so the value of <code>n</code> will be cast to a <code>double</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">lua_pushunsigned</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tonumberx"><span class="subsection"><code>lua_tonumberx</code></span><a class="headerlink" href="#lua_tonumberx" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>double lua_tonumberx(lua_State* L, int idx, int* isnum)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>isnum</code>: Is number</li>
</ul>
<p>Returns the number at the given stack index. If the value on the stack is a string, Luau will attempt to convert the string to a number.</p>
<p>If the value is a number, or successfully converted to a number, the <code>isnum</code> argument will be set to <code>1</code>, otherwise <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;12.5&quot;</span><span class="p">);</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="kt">double</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="kt">int</span><span class="w"> </span><span class="n">isnum</span><span class="p">;</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="c1">// isnum will be false, since &quot;hello&quot; cannot be converted to a number:</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumberx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="p">}</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a><span class="c1">// isnum is true, and &quot;12.5&quot; is converted to 12.5:</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumberx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a><span class="p">}</span>
</span><span id="__span-54-19"><a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a>
</span><span id="__span-54-20"><a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a><span class="c1">// isnum is true, and the value is 15:</span>
</span><span id="__span-54-21"><a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumberx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-54-22"><a id="__codelineno-54-22" name="__codelineno-54-22" href="#__codelineno-54-22"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-23"><a id="__codelineno-54-23" name="__codelineno-54-23" href="#__codelineno-54-23"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-54-24"><a id="__codelineno-54-24" name="__codelineno-54-24" href="#__codelineno-54-24"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tonumber"><span class="subsection"><code>lua_tonumber</code></span><a class="headerlink" href="#lua_tonumber" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>double lua_tonumber(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the number at the given stack index. If the value on the stack is a string, Luau will attempt to convert the string to a number. Identical to <a href="#lua_tonumberx"><code>lua_tonumberx</code></a>, without the last <code>isnum</code> argument.</p>
<hr />
<h3 id="lua_tointegerx"><span class="subsection"><code>lua_tointegerx</code></span><a class="headerlink" href="#lua_tointegerx" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_tointegerx(lua_State* L, int idx, int* isnum)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>isnum</code>: Is number</li>
</ul>
<p>Returns the number at the given stack index as an integer. If the value on the stack is a string, Luau will attempt to convert the string to an integer. Numbers in Luau are all doubles, so the returned value is cast to an int.</p>
<p>If the value is a number, or successfully converted to a number, the <code>isnum</code> argument will be set to <code>1</code>, otherwise <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;12.5&quot;</span><span class="p">);</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="kt">int</span><span class="w"> </span><span class="n">isnum</span><span class="p">;</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="c1">// isnum will be false, since &quot;hello&quot; cannot be converted to a number:</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tointegerx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a><span class="p">}</span>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a>
</span><span id="__span-55-14"><a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a><span class="c1">// isnum is true, and &quot;12.5&quot; is converted to 12:</span>
</span><span id="__span-55-15"><a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tointegerx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-55-16"><a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-17"><a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-55-18"><a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a><span class="p">}</span>
</span><span id="__span-55-19"><a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a>
</span><span id="__span-55-20"><a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a><span class="c1">// isnum is true, and the value is 15:</span>
</span><span id="__span-55-21"><a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tointegerx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-55-22"><a id="__codelineno-55-22" name="__codelineno-55-22" href="#__codelineno-55-22"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-23"><a id="__codelineno-55-23" name="__codelineno-55-23" href="#__codelineno-55-23"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-55-24"><a id="__codelineno-55-24" name="__codelineno-55-24" href="#__codelineno-55-24"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tointeger"><span class="subsection"><code>lua_tointeger</code></span><a class="headerlink" href="#lua_tointeger" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_tointeger(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the number at the given stack index as an integer. If the value on the stack is a string, Luau will attempt to convert the string to an integer. Numbers in Luau are all doubles, so the returned value is cast to an int. Identical to <a href="#lua_tointegerx"><code>lua_tointegerx</code></a>, without the last <code>isnum</code> argument.</p>
<hr />
<h3 id="lua_tounsignedx"><span class="subsection"><code>lua_tounsignedx</code></span><a class="headerlink" href="#lua_tounsignedx" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>unsigned lua_tounsignedx(lua_State* L, int idx, int* isnum)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>isnum</code>: Is number</li>
</ul>
<p>Returns the number at the given stack index as an unsigned integer. If the value on the stack is a string, Luau will attempt to convert the string to an integer. Numbers in Luau are all doubles, so the returned value is cast to an unsigned int.</p>
<p>If the value is a number, or successfully converted to a number, the <code>isnum</code> argument will be set to <code>1</code>, otherwise <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;12.5&quot;</span><span class="p">);</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="n">lua_pushunsigned</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="kt">unsigned</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="kt">int</span><span class="w"> </span><span class="n">isnum</span><span class="p">;</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="c1">// isnum will be false, since &quot;hello&quot; cannot be converted to a number:</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tounsignedx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="p">}</span>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="c1">// isnum is true, and &quot;12.5&quot; is converted to 12:</span>
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tounsignedx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-56-16"><a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-17"><a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-56-18"><a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a><span class="p">}</span>
</span><span id="__span-56-19"><a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>
</span><span id="__span-56-20"><a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a><span class="c1">// isnum is true, and the value is 15:</span>
</span><span id="__span-56-21"><a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a><span class="hll"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tounsignedx</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">isnum</span><span class="p">);</span>
</span></span><span id="__span-56-22"><a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnum</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-23"><a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-56-24"><a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tounsigned"><span class="subsection"><code>lua_tounsigned</code></span><a class="headerlink" href="#lua_tounsigned" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>unsigned lua_tounsigned(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the number at the given stack index as an unsigned integer. If the value on the stack is a string, Luau will attempt to convert the string to an integer. Numbers in Luau are all doubles, so the returned value is cast to an unsigned int. Identical to <a href="#lua_tounsignedx"><code>lua_tounsignedx</code></a>, without the last <code>isnum</code> argument.</p>
<hr />
<h3 id="lua_isnumber"><span class="subsection"><code>lua_isnumber</code></span><a class="headerlink" href="#lua_isnumber" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isnumber(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the value at stack index <code>idx</code> is a number <em>or</em> the value is a string that can be coerced to a number. Otherwise, returns <code>0</code>.</p>
<hr />
<h3 id="lual_checknumber"><span class="subsection"><code>luaL_checknumber</code></span><a class="headerlink" href="#lual_checknumber" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>double luaL_checknumber(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the number at the given stack index. If the value is not a number, an error is thrown.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">rhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rhs</span><span class="p">);</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkinteger"><span class="subsection"><code>luaL_checkinteger</code></span><a class="headerlink" href="#lual_checkinteger" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_checkinteger(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the number (cast to <code>int</code>) at the given stack index. If the value is not a number, an error is thrown.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">add_int</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rhs</span><span class="p">);</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkunsigned"><span class="subsection"><code>luaL_checkunsigned</code></span><a class="headerlink" href="#lual_checkunsigned" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>unsigned luaL_checkunsigned(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the number (cast to <code>unsigned</code>) at the given stack index. If the value is not a number, an error is thrown.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">add_int</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkunsigned</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">rhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkunsigned</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="w">    </span><span class="n">lua_pushunsigned</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rhs</span><span class="p">);</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_optnumber"><span class="subsection"><code>luaL_optnumber</code></span><a class="headerlink" href="#lual_optnumber" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>double luaL_optnumber(lua_State* L, int idx, double def)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default</li>
</ul>
<p>Returns the number at the given stack index, or the default number if the value at the stack index is nil or none. Otherwise, an error is thrown.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">approx_equal</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a><span class="hll"><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">epsilon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_optnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00001</span><span class="p">);</span>
</span></span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a><span class="w">    </span><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">epsilon</span><span class="p">);</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_optinteger"><span class="subsection"><code>luaL_optinteger</code></span><a class="headerlink" href="#lual_optinteger" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_optinteger(lua_State* L, int idx, int def)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default</li>
</ul>
<p>Returns the number (cast to <code>int</code>) at the given stack index, or the default number if the value at the stack index is nil or none. Otherwise, an error is thrown.</p>
<hr />
<h3 id="lual_optunsigned"><span class="subsection"><code>luaL_optunsigned</code></span><a class="headerlink" href="#lual_optunsigned" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>unsigned luaL_optunsigned(lua_State* L, int idx, unsigned def)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default</li>
</ul>
<p>Returns the number (cast to <code>unsigned</code>) at the given stack index, or the default number if the value at the stack index is nil or none. Otherwise, an error is thrown.</p>
<hr />
<h2 id="boolean-functions">Boolean Functions<a class="headerlink" href="#boolean-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_pushboolean"><span class="subsection"><code>lua_pushboolean</code></span><a class="headerlink" href="#lua_pushboolean" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushboolean(lua_State* L, int b)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>b</code>: Boolean</li>
</ul>
<p>Pushes boolean <code>b</code> to the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_toboolean"><span class="subsection"><code>lua_toboolean</code></span><a class="headerlink" href="#lua_toboolean" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_toboolean(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the Luau value at the given stack index is truthy, otherwise returns <code>0</code>.</p>
<p>A "falsey" value in Luau is any value that is either <code>nil</code> or <code>false</code>. All other values are evaluated as <code>true</code>. In other languages, values like <code>0</code> or empty strings might be evaluated as <code>false</code>. This is <em>not</em> the case in Luau. <em>Only</em> <code>nil</code> and <code>false</code> are evaluated as <code>false</code>; all other values are evaluated as <code>true</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="n">lua_pushboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_toboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">))</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// true</span>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_toboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">))</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// false</span>
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_toboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">))</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// false (nil is evaluated as false)</span>
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_toboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// true (0 is neither nil or false, so it is evaluated as true in Luau)</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isboolean"><span class="subsection"><code>lua_isboolean</code></span><a class="headerlink" href="#lua_isboolean" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isboolean(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a boolean.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isboolean</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkboolean"><span class="subsection"><code>luaL_checkboolean</code></span><a class="headerlink" href="#lual_checkboolean" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_checkboolean(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the Luau value at the given stack index is true, otherwise returns <code>0</code>. Throws an error if the value at the given index is not a boolean.</p>
<p><strong>Note:</strong> Unlike <code>lua_toboolean</code>, this is not a <em>truthy/falsey</em> check. The value at the given index must be a boolean.</p>
<hr />
<h3 id="lual_optboolean"><span class="subsection"><code>luaL_optboolean</code></span><a class="headerlink" href="#lual_optboolean" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_optboolean(lua_State* L, int idx, int def)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default</li>
</ul>
<p>Returns <code>1</code> or <code>0</code> for the given boolean value. Returns <code>def</code> if the value at the given index is nil or none. Otherwise, an error is thrown.</p>
<p><strong>Note:</strong> Unlike <code>lua_toboolean</code>, this is not a <em>truthy/falsey</em> check. The value at the given index must be a boolean.</p>
<hr />
<h2 id="vector-functions">Vector Functions<a class="headerlink" href="#vector-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_pushvector"><span class="subsection"><code>lua_pushvector</code></span><a class="headerlink" href="#lua_pushvector" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushvector(lua_State* L, float x, float y, float z)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>x</code>: X</li>
<li><code>y</code>: Y</li>
<li><code>z</code>: Z</li>
</ul>
<p>Pushes a vector to the Luau stack. Luau comes with a <a href="https://luau.org/library#vector-library">vector library</a> for operating against vector values.</p>
<p><strong>Note:</strong> Unlike Luau numbers being double-precision floating point numbers, Luau vector values are single-precision floats.</p>
<div class="language-cpp highlight"><span class="filename">Example 3-wide</span><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="hll"><span class="c1">// By default, Luau vectors are 3-wide</span>
</span></span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="n">lua_pushvector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tovector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// 10</span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="c1">// 15</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="kt">float</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="c1">// 20</span>
</span></code></pre></div>
<p>If Luau is built with the <code>LUA_VECTOR_SIZE</code> preprocessor set to <code>4</code>, then this will be a 4-wide vector, and the function will have an additional <code>w</code> parameter.
<div class="language-cpp highlight"><span class="filename">Example 4-wide</span><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="hll"><span class="c1">// If Luau is built with LUA_VECTOR_SIZE=4</span>
</span></span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="n">lua_pushvector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">);</span>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tovector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c1">// 10</span>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="c1">// 15</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="kt">float</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="c1">// 20</span>
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="kt">float</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="c1">// 25</span>
</span></code></pre></div></p>
<hr />
<h3 id="lua_tovector"><span class="subsection"><code>lua_tovector</code></span><a class="headerlink" href="#lua_tovector" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const float* lua_tovector(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the vector at the given Luau index, or <code>NULL</code> if not a vector.</p>
<p>By default, vectors in Luau are 3-wide. Luau can be built with the <code>LUA_VECTOR_SIZE</code> preprocessor set to <code>4</code> for 4-wide vectors.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="n">lua_pushvector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// x, y, z</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="hll"><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="o">*</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tovector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span></span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="kt">float</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="kt">float</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="kt">float</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%f, %f, %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isvector"><span class="subsection"><code>lua_isvector</code></span><a class="headerlink" href="#lua_isvector" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isvector(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a vector.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isvector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkvector"><span class="subsection"><code>luaL_checkvector</code></span><a class="headerlink" href="#lual_checkvector" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const float* luaL_checkvector(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the vector at the given Luau index. If the value at the given index is not a vector, an error is thrown.</p>
<hr />
<h3 id="lual_optvector"><span class="subsection"><code>luaL_optvector</code></span><a class="headerlink" href="#lual_optvector" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const float* luaL_optvector(lua_State* L, int idx, const float* def)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default</li>
</ul>
<p>Returns the vector at the given Luau index. If the value at the given index is nil or none, then <code>def</code> is returned. Otherwise, an error is thrown.</p>
<hr />
<h2 id="buffer-functions">Buffer Functions<a class="headerlink" href="#buffer-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_newbuffer"><span class="subsection"><code>lua_newbuffer</code></span><a class="headerlink" href="#lua_newbuffer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_newbuffer(lua_State* L, size_t sz)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>sz</code>: Size</li>
</ul>
<p>Pushes a new buffer to the stack and returns a pointer to the buffer. Buffers are just arbitrary data. Luau can create and interact with buffers through the <a href="https://luau.org/library#buffer-library"><code>buffer</code> library</a>. Use the <a href="#lua_tobuffer"><code>lua_tobuffer</code></a> function to retrieve a buffer from the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="p">}</span>
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="c1">// As an example, write &#39;Foo&#39; to a buffer:</span>
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="p">{};</span>
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a><span class="n">foo</span><span class="p">.</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="hll"><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newbuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">));</span>
</span></span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a><span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">));</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tobuffer"><span class="subsection"><code>lua_tobuffer</code></span><a class="headerlink" href="#lua_tobuffer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_tobuffer(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the buffer at the given stack index, or <code>NULL</code> if the value is not a buffer.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newbuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="hll"><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tobuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">len</span><span class="p">);</span>
</span></span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="c1">// b == buf</span>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="c1">// len == 10</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isbuffer"><span class="subsection"><code>lua_isbuffer</code></span><a class="headerlink" href="#lua_isbuffer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isbuffer(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a buffer.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isbuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkbuffer"><span class="subsection"><code>luaL_checkbuffer</code></span><a class="headerlink" href="#lual_checkbuffer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* luaL_checkbuffer(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the buffer at the given stack index. If the value retrieved is not a buffer, an error is thrown.</p>
<hr />
<h2 id="metatable-functions">Metatable Functions<a class="headerlink" href="#metatable-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_setmetatable"><span class="subsection"><code>lua_setmetatable</code></span><a class="headerlink" href="#lua_setmetatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setmetatable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Takes the table at the top of the stack and assigns it as the metatable of the table on the stack at <code>idx</code>.</p>
<p>The return value can be ignored; this function always returns <code>1</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="c1">// Create table:</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="c1">// t</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="c1">// Create metatable:</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="c1">// mt</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="s">&quot;v&quot;</span><span class="p">);</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a><span class="hll"><span class="n">lua_rawsetfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;__mode&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// mt.__mode = &quot;v&quot;</span>
</span></span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a><span class="n">lua_setmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span><span class="w"> </span><span class="c1">// setmetatable(t, mt)</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getmetatable"><span class="subsection"><code>lua_getmetatable</code></span><a class="headerlink" href="#lua_getmetatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getmetatable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Gets the metatable for the object at the given stack index. If the metatable is found, it is pushed to the top of the stack and the function returns <code>1</code>. Otherwise, the function returns <code>0</code> and the stack remains the same.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_getmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="w">    </span><span class="c1">// Metatable is now at the top of the stack</span>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_setuserdatametatable"><span class="subsection"><code>lua_setuserdatametatable</code></span><a class="headerlink" href="#lua_setuserdatametatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setuserdatametatable(lua_State* L, int tag)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Pops the value (expecting a table) at the top of the stack and sets the userdata metatable for the given userdata tag. This is used in conjunction with <a href="#lua_newuserdatataggedwithmetatable"><code>lua_newuserdatataggedwithmetatable</code></a>. See the example there.</p>
<p>This function can only be called once per tag. Calling this function again for the same tag will throw an error.</p>
<hr />
<h3 id="lua_getuserdatametatable"><span class="subsection"><code>lua_getuserdatametatable</code></span><a class="headerlink" href="#lua_getuserdatametatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_getuserdatametatable(lua_State* L, int tag)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Pushes the metatable associated with the userdata tag onto the stack (or <code>nil</code> if there is no associated metatable).</p>
<hr />
<h3 id="lua_getmetafield"><span class="subsection"><code>lua_getmetafield</code></span><a class="headerlink" href="#lua_getmetafield" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getmetafield(lua_State* L, int idx, const char* field)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>field</code>: Metatable field</li>
</ul>
<p>Attempts to get the given metatable field for the table at <code>idx</code>. If the table doesn't have a metatable, or the metatable doesn't have <code>field</code>, then this function returns <code>0</code> and nothing is pushed onto the stack. Otherwise, the function returns <code>1</code> and the field is pushed onto the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="c1">// Assume the top of the stack is a table</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_getmetafield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;__index&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="w">    </span><span class="c1">// ...</span>
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_callmeta"><span class="subsection"><code>lua_callmeta</code></span><a class="headerlink" href="#lua_callmeta" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_callmeta(lua_State* L, int idx, const char* field)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>field</code>: Metatable field</li>
</ul>
<p>Attempts to call the given metatable function for the table at <code>idx</code>. If the table doesn't have a metatable, or the metatable doesn't have <code>field</code>, then this function returns <code>0</code> and nothing is pushed onto the stack. Otherwise, the function returns <code>1</code> and the result of the called metatable function is pushed onto the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="c1">// Assume the top of the stack is a table</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_callmeta</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;__tostring&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a><span class="w">    </span><span class="c1">// ...</span>
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_newmetatable"><span class="subsection"><code>luaL_newmetatable</code></span><a class="headerlink" href="#lual_newmetatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_newmetatable(lua_State* L, const char* name)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>name</code>: Name</li>
</ul>
<p>Creates (or fetches existing) metatable with a given name and pushes the metatable onto the stack. Returns <code>1</code> if the metatable was created, or <code>0</code> if the metatable aleady exists. This is useful for creating metatables linked to specific userdata types.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">)));</span>
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a><span class="hll"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">luaL_newmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a><span class="w">    </span><span class="c1">// Build metatable:</span>
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a><span class="w">    </span><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">);</span>
</span><span id="__span-75-8"><a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a><span class="w">    </span><span class="n">lua_rawsetfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;__type&quot;</span><span class="p">);</span>
</span><span id="__span-75-9"><a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a><span class="p">}</span>
</span><span id="__span-75-10"><a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a><span class="n">lua_setmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lual_getmetatable"><span class="subsection"><code>luaL_getmetatable</code></span><a class="headerlink" href="#lual_getmetatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_getmetatable(lua_State* L, const char* name)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>name</code>: Name</li>
</ul>
<p>Attempts to get a metatable from the registry with the given name and pushes it to the stack. If no metatable is found, <code>nil</code> will be pushed to the stack. See <a href="#lual_newmetatable"><code>luaL_newmetatable</code></a>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="nf">new_Foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">)));</span>
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">luaL_newmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="w">        </span><span class="c1">// Build metatable:</span>
</span><span id="__span-76-7"><a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a><span class="w">        </span><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">);</span>
</span><span id="__span-76-8"><a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a><span class="w">        </span><span class="n">lua_rawsetfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;__type&quot;</span><span class="p">);</span>
</span><span id="__span-76-9"><a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-76-10"><a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a><span class="w">    </span><span class="n">lua_setmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span><span id="__span-76-11"><a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span>
</span><span id="__span-76-12"><a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a><span class="p">}</span>
</span><span id="__span-76-13"><a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a>
</span><span id="__span-76-14"><a id="__codelineno-76-14" name="__codelineno-76-14" href="#__codelineno-76-14"></a><span class="c1">// ...</span>
</span><span id="__span-76-15"><a id="__codelineno-76-15" name="__codelineno-76-15" href="#__codelineno-76-15"></a>
</span><span id="__span-76-16"><a id="__codelineno-76-16" name="__codelineno-76-16" href="#__codelineno-76-16"></a><span class="hll"><span class="c1">// Get the metatable created with `luaL_newmetatable`:</span>
</span></span><span id="__span-76-17"><a id="__codelineno-76-17" name="__codelineno-76-17" href="#__codelineno-76-17"></a><span class="hll"><span class="n">luaL_getmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">);</span>
</span></span></code></pre></div>
<hr />
<h2 id="userdata-functions">Userdata Functions<a class="headerlink" href="#userdata-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_newuserdata"><span class="subsection"><code>lua_newuserdata</code></span><a class="headerlink" href="#lua_newuserdata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_newuserdata(lua_State* L, size_t sz)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>sz</code>: Size of the data</li>
</ul>
<p>Creates a userdata and pushes it to the stack. A pointer to the newly-constructed data is returned. This is equivalent to <code>lua_newuserdatatagged</code> with a tag of <code>0</code>.</p>
<p><strong>Note:</strong> Luau-constructed userdata are not zero-initialized. After construction, assign all fields of the object.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a><span class="p">};</span>
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">)));</span>
</span></span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a><span class="c1">// Before explicit assignment, `n` is garbage, so we should initialize it ourselves:</span>
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_newuserdatadtor"><span class="subsection"><code>lua_newuserdatadtor</code></span><a class="headerlink" href="#lua_newuserdatadtor" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_newuserdatadtor(lua_State* L, size_t sz, void (*dtor)(void*))</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>sz</code>: Size of the data</li>
<li><code>dtor</code>: Destructor</li>
</ul>
<p>Creates a new userdata with an assigned destructor. Destructors are called when Luau is freeing up the userdata memory.</p>
<p>To assign a destructor for all userdata of a given tag, use <a href="#lua_setuserdatadtor"><code>lua_setuserdatadtor</code></a>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="p">};</span>
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdatadtor</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">),</span><span class="w"> </span><span class="p">[](</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a><span class="hll"><span class="w">    </span><span class="c1">// This function is called when Foo is being GC&#39;d. Free up any user-managed resources now.</span>
</span></span><span id="__span-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a><span class="hll"><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span>
</span></span><span id="__span-78-8"><a id="__codelineno-78-8" name="__codelineno-78-8" href="#__codelineno-78-8"></a><span class="hll"><span class="w">    </span><span class="k">delete</span><span class="p">[]</span><span class="w"> </span><span class="n">f</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
</span></span><span id="__span-78-9"><a id="__codelineno-78-9" name="__codelineno-78-9" href="#__codelineno-78-9"></a><span class="hll"><span class="p">}));</span>
</span></span><span id="__span-78-10"><a id="__codelineno-78-10" name="__codelineno-78-10" href="#__codelineno-78-10"></a>
</span><span id="__span-78-11"><a id="__codelineno-78-11" name="__codelineno-78-11" href="#__codelineno-78-11"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">char</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
</span></code></pre></div>
<hr />
<h3 id="lua_newuserdatatagged"><span class="subsection"><code>lua_newuserdatatagged</code></span><a class="headerlink" href="#lua_newuserdatatagged" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_newuserdatatagged(lua_State* L, size_t sz, int tag)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>sz</code>: Size of the data</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Creates the tagged userdata and pushes it to the stack. A pointer to the newly-constructed data is returned. Use <a href="#lua_touserdatatagged"><code>lua_touserdatatagged</code></a> to retrieve the value. For more info on tags, see the <a href="guides/tags.html">Tags</a> page.</p>
<p><strong>Note:</strong> Luau-constructed userdata are not zero-initialized. After construction, assign all fields of the object.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a><span class="p">};</span>
</span><span id="__span-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a>
</span><span id="__span-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">),</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span></span><span id="__span-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>
</span><span id="__span-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a><span class="c1">// Before explicit assignment, `n` is garbage, so we should initialize it ourselves:</span>
</span><span id="__span-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_newuserdatataggedwithmetatable"><span class="subsection"><code>lua_newuserdatataggedwithmetatable</code></span><a class="headerlink" href="#lua_newuserdatataggedwithmetatable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_newuserdatataggedwithmetatable(lua_State* L, size_t sz, int tag)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>sz</code>: Size of the data</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Creates the tagged userdata with a pre-defined metatable and pushes it to the stack. A pointer to the newly-constructed data is returned. Use <a href="#lua_touserdatatagged"><code>lua_touserdatatagged</code></a> to retrieve the value. For more info on tags, see the <a href="guides/tags.html">Tags</a> page.</p>
<p>Using this method is faster than attempting to assign a metatable to new userdata every construction, e.g. using <code>luaL_newmetatable</code>. Instead, the metatable is created ahead of time using <code>lua_setuserdatametatable</code>, linked to the userdata's tag.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a><span class="p">};</span>
</span><span id="__span-80-6"><a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a>
</span><span id="__span-80-7"><a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a><span class="kt">int</span><span class="w"> </span><span class="nf">Foo_index</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-8"><a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">luaL_touserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span><span id="__span-80-9"><a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-80-10"><a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">property</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">strcmp</span><span class="p">(</span><span class="n">property</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-11"><a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a><span class="w">        </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-80-12"><a id="__codelineno-80-12" name="__codelineno-80-12" href="#__codelineno-80-12"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-80-13"><a id="__codelineno-80-13" name="__codelineno-80-13" href="#__codelineno-80-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-80-14"><a id="__codelineno-80-14" name="__codelineno-80-14" href="#__codelineno-80-14"></a><span class="w">    </span><span class="n">luaL_error</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;unknown property&quot;</span><span class="p">);</span>
</span><span id="__span-80-15"><a id="__codelineno-80-15" name="__codelineno-80-15" href="#__codelineno-80-15"></a><span class="p">}</span>
</span><span id="__span-80-16"><a id="__codelineno-80-16" name="__codelineno-80-16" href="#__codelineno-80-16"></a>
</span><span id="__span-80-17"><a id="__codelineno-80-17" name="__codelineno-80-17" href="#__codelineno-80-17"></a><span class="kt">int</span><span class="w"> </span><span class="nf">Foo_newindex</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-18"><a id="__codelineno-80-18" name="__codelineno-80-18" href="#__codelineno-80-18"></a><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">luaL_touserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span><span id="__span-80-19"><a id="__codelineno-80-19" name="__codelineno-80-19" href="#__codelineno-80-19"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">property</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-80-20"><a id="__codelineno-80-20" name="__codelineno-80-20" href="#__codelineno-80-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">property</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">strcmp</span><span class="p">(</span><span class="n">property</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-21"><a id="__codelineno-80-21" name="__codelineno-80-21" href="#__codelineno-80-21"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">new_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
</span><span id="__span-80-22"><a id="__codelineno-80-22" name="__codelineno-80-22" href="#__codelineno-80-22"></a><span class="w">        </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_n</span><span class="p">;</span>
</span><span id="__span-80-23"><a id="__codelineno-80-23" name="__codelineno-80-23" href="#__codelineno-80-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-80-24"><a id="__codelineno-80-24" name="__codelineno-80-24" href="#__codelineno-80-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-80-25"><a id="__codelineno-80-25" name="__codelineno-80-25" href="#__codelineno-80-25"></a><span class="w">    </span><span class="n">luaL_error</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;unknown property&quot;</span><span class="p">);</span>
</span><span id="__span-80-26"><a id="__codelineno-80-26" name="__codelineno-80-26" href="#__codelineno-80-26"></a><span class="p">}</span>
</span><span id="__span-80-27"><a id="__codelineno-80-27" name="__codelineno-80-27" href="#__codelineno-80-27"></a>
</span><span id="__span-80-28"><a id="__codelineno-80-28" name="__codelineno-80-28" href="#__codelineno-80-28"></a><span class="k">const</span><span class="w"> </span><span class="n">luaL_Reg</span><span class="w"> </span><span class="n">Foo_metatable</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-29"><a id="__codelineno-80-29" name="__codelineno-80-29" href="#__codelineno-80-29"></a><span class="w">    </span><span class="p">{</span><span class="s">&quot;__index&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_index</span><span class="p">},</span>
</span><span id="__span-80-30"><a id="__codelineno-80-30" name="__codelineno-80-30" href="#__codelineno-80-30"></a><span class="w">    </span><span class="p">{</span><span class="s">&quot;__newindex&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_newindex</span><span class="p">},</span>
</span><span id="__span-80-31"><a id="__codelineno-80-31" name="__codelineno-80-31" href="#__codelineno-80-31"></a><span class="w">    </span><span class="p">{</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">},</span>
</span><span id="__span-80-32"><a id="__codelineno-80-32" name="__codelineno-80-32" href="#__codelineno-80-32"></a><span class="p">};</span>
</span><span id="__span-80-33"><a id="__codelineno-80-33" name="__codelineno-80-33" href="#__codelineno-80-33"></a>
</span><span id="__span-80-34"><a id="__codelineno-80-34" name="__codelineno-80-34" href="#__codelineno-80-34"></a><span class="kt">int</span><span class="w"> </span><span class="nf">push_Foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-35"><a id="__codelineno-80-35" name="__codelineno-80-35" href="#__codelineno-80-35"></a><span class="hll"><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdatataggedwithmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">),</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span></span><span id="__span-80-36"><a id="__codelineno-80-36" name="__codelineno-80-36" href="#__codelineno-80-36"></a><span class="w">    </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-80-37"><a id="__codelineno-80-37" name="__codelineno-80-37" href="#__codelineno-80-37"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-80-38"><a id="__codelineno-80-38" name="__codelineno-80-38" href="#__codelineno-80-38"></a><span class="p">}</span>
</span><span id="__span-80-39"><a id="__codelineno-80-39" name="__codelineno-80-39" href="#__codelineno-80-39"></a>
</span><span id="__span-80-40"><a id="__codelineno-80-40" name="__codelineno-80-40" href="#__codelineno-80-40"></a><span class="c1">// Called during some initialization period</span>
</span><span id="__span-80-41"><a id="__codelineno-80-41" name="__codelineno-80-41" href="#__codelineno-80-41"></a><span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-80-42"><a id="__codelineno-80-42" name="__codelineno-80-42" href="#__codelineno-80-42"></a><span class="w">    </span><span class="n">luaL_newmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">);</span>
</span><span id="__span-80-43"><a id="__codelineno-80-43" name="__codelineno-80-43" href="#__codelineno-80-43"></a><span class="w">    </span><span class="n">luaL_register</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_metatable</span><span class="p">);</span>
</span><span id="__span-80-44"><a id="__codelineno-80-44" name="__codelineno-80-44" href="#__codelineno-80-44"></a><span class="w">    </span><span class="n">lua_setuserdatametatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span><span id="__span-80-45"><a id="__codelineno-80-45" name="__codelineno-80-45" href="#__codelineno-80-45"></a>
</span><span id="__span-80-46"><a id="__codelineno-80-46" name="__codelineno-80-46" href="#__codelineno-80-46"></a><span class="w">    </span><span class="n">lua_setglobal</span><span class="p">(</span><span class="s">&quot;new_foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">push_Foo</span><span class="p">);</span>
</span><span id="__span-80-47"><a id="__codelineno-80-47" name="__codelineno-80-47" href="#__codelineno-80-47"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-lua highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">new_foo</span><span class="p">()</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="nv">foo</span><span class="p">.</span><span class="py">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">55</span>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a><span class="nb">print</span><span class="p">(</span><span class="nv">foo</span><span class="p">.</span><span class="py">n</span><span class="p">)</span><span class="w"> </span><span class="c1">-- 55</span>
</span></code></pre></div>
<hr />
<h3 id="lua_touserdata"><span class="subsection"><code>lua_touserdata</code></span><a class="headerlink" href="#lua_touserdata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_touserdata(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns a pointer to a userdata on the stack. Returns <code>NULL</code> if the value is not a userdata.</p>
<p>If it is preferred to throw an error if the value is not a userdata, use the <code>luaL_checkuserdata</code> function instead.</p>
<p><strong>Note:</strong> It may be unsafe to hang onto a pointer to a userdata value. The Luau GC owns the userdata memory, and may free it. See the page on <a href="guides/pinning.html">pinning</a> for tips on keeping a value from being GC'd, or consider using <a href="guides/light-userdata.html">light userdata</a> instead.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="p">};</span>
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a>
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">)));</span>
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a>
</span><span id="__span-82-8"><a id="__codelineno-82-8" name="__codelineno-82-8" href="#__codelineno-82-8"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_touserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span>
</span></span><span id="__span-82-9"><a id="__codelineno-82-9" name="__codelineno-82-9" href="#__codelineno-82-9"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;foo-&gt;n = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// foo-&gt;n = 32</span>
</span></code></pre></div>
<hr />
<h3 id="lua_touserdatatagged"><span class="subsection"><code>lua_touserdatatagged</code></span><a class="headerlink" href="#lua_touserdatatagged" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_touserdatatagged(lua_State* L, int idx, int tag)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Returns a pointer to a tagged userdata on the stack. Returns <code>NULL</code> if the value is not a userdata <em>or</em> the userdata's tag does not match the provided <code>tag</code> argument. For more info on tags, see the <a href="guides/tags.html">Tags</a> page.</p>
<p><strong>Note:</strong> It may be unsafe to hang onto a pointer to a userdata value. The Luau GC owns the userdata memory, and may free it. See the page on <a href="guides/pinning.html">pinning</a> for tips on keeping a value from being GC'd, or consider using <a href="guides/light-userdata.html">light userdata</a> instead.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a><span class="p">};</span>
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_newuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">),</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_touserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span></span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;foo-&gt;n = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// foo-&gt;n = 32</span>
</span></code></pre></div>
<hr />
<h3 id="lua_setuserdatatag"><span class="subsection"><code>lua_setuserdatatag</code></span><a class="headerlink" href="#lua_setuserdatatag" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setuserdatatag(lua_State* L, int idx, int tag)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Sets the tag for userdata at stack index <code>idx</code>. Alternatively, the <a href="#lua_newuserdatatagged"><code>lua_newuserdatatagged</code></a> and <a href="#lua_newuserdatataggedwithmetatable"><code>lua_newuserdatataggedwithmetatable</code></a> functions can be used to assign the tag on userdata creation.</p>
<hr />
<h3 id="lua_userdatatag"><span class="subsection"><code>lua_userdatatag</code></span><a class="headerlink" href="#lua_userdatatag" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_userdatatag(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the tag for the userdata at the given stack position. For non-userdata values, this function returns <code>-1</code>. If the userdata value was not assigned a tag, the tag will be set to the default of <code>0</code>, and thus this function will return <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kBarTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Bar</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Baz</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a>
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a><span class="n">lua_pushuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Foo</span><span class="p">),</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a><span class="n">lua_pushuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Bar</span><span class="p">),</span><span class="w"> </span><span class="n">kBarTag</span><span class="p">);</span>
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a><span class="n">lua_pushuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Baz</span><span class="p">));</span>
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a>
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12" href="#__codelineno-84-12"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">foo_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_userdatatag</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 10</span>
</span></span><span id="__span-84-13"><a id="__codelineno-84-13" name="__codelineno-84-13" href="#__codelineno-84-13"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">bar_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_userdatatag</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span><span class="w"> </span><span class="c1">// 20</span>
</span></span><span id="__span-84-14"><a id="__codelineno-84-14" name="__codelineno-84-14" href="#__codelineno-84-14"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">baz_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_userdatatag</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// 0</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_setuserdatadtor"><span class="subsection"><code>lua_setuserdatadtor</code></span><a class="headerlink" href="#lua_setuserdatadtor" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setuserdatadtor(lua_State* L, int tag, lua_Destructor dtor)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tag</code>: Tag</li>
<li><code>dtor</code>: Tag</li>
</ul>
<p>Assigns the destructor function for a given userdata tag. All userdata with the given tag will utilize this destructor during GC.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a><span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">some_allocated_data</span><span class="p">;</span>
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a><span class="p">};</span>
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a>
</span><span id="__span-85-7"><a id="__codelineno-85-7" name="__codelineno-85-7" href="#__codelineno-85-7"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Foo_destructor</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-85-8"><a id="__codelineno-85-8" name="__codelineno-85-8" href="#__codelineno-85-8"></a><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</span><span id="__span-85-9"><a id="__codelineno-85-9" name="__codelineno-85-9" href="#__codelineno-85-9"></a><span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">some_allocated_data</span><span class="p">;</span>
</span><span id="__span-85-10"><a id="__codelineno-85-10" name="__codelineno-85-10" href="#__codelineno-85-10"></a><span class="p">}</span>
</span><span id="__span-85-11"><a id="__codelineno-85-11" name="__codelineno-85-11" href="#__codelineno-85-11"></a>
</span><span id="__span-85-12"><a id="__codelineno-85-12" name="__codelineno-85-12" href="#__codelineno-85-12"></a><span class="kt">void</span><span class="w"> </span><span class="nf">setup_Foo</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-85-13"><a id="__codelineno-85-13" name="__codelineno-85-13" href="#__codelineno-85-13"></a><span class="w">    </span><span class="n">luaL_newmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">);</span>
</span><span id="__span-85-14"><a id="__codelineno-85-14" name="__codelineno-85-14" href="#__codelineno-85-14"></a><span class="w">    </span><span class="c1">// ...build metatable</span>
</span><span id="__span-85-15"><a id="__codelineno-85-15" name="__codelineno-85-15" href="#__codelineno-85-15"></a><span class="w">    </span><span class="n">lua_setuserdatametatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span><span id="__span-85-16"><a id="__codelineno-85-16" name="__codelineno-85-16" href="#__codelineno-85-16"></a>
</span><span id="__span-85-17"><a id="__codelineno-85-17" name="__codelineno-85-17" href="#__codelineno-85-17"></a><span class="hll"><span class="w">    </span><span class="n">lua_setuserdatadtor</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_destructor</span><span class="p">);</span>
</span></span><span id="__span-85-18"><a id="__codelineno-85-18" name="__codelineno-85-18" href="#__codelineno-85-18"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getuserdatadtor"><span class="subsection"><code>lua_getuserdatadtor</code></span><a class="headerlink" href="#lua_getuserdatadtor" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_Destructor lua_getuserdatadtor(lua_State* L, int tag)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Returns the destructor function assigned to the userdata tag.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">Foo_destructor</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-86-4"><a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a>
</span><span id="__span-86-5"><a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a><span class="kt">void</span><span class="w"> </span><span class="nf">setup_Foo</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-86-6"><a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a><span class="w">    </span><span class="c1">// ...</span>
</span><span id="__span-86-7"><a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a><span class="hll"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">dtor_before</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_getuserdatadtor</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span><span class="w"> </span><span class="c1">// dtor_before == nullptr</span>
</span></span><span id="__span-86-8"><a id="__codelineno-86-8" name="__codelineno-86-8" href="#__codelineno-86-8"></a>
</span><span id="__span-86-9"><a id="__codelineno-86-9" name="__codelineno-86-9" href="#__codelineno-86-9"></a><span class="w">    </span><span class="n">lua_setuserdatadtor</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_destructor</span><span class="p">);</span>
</span><span id="__span-86-10"><a id="__codelineno-86-10" name="__codelineno-86-10" href="#__codelineno-86-10"></a>
</span><span id="__span-86-11"><a id="__codelineno-86-11" name="__codelineno-86-11" href="#__codelineno-86-11"></a><span class="hll"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">dtor_after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_getuserdatadtor</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span><span class="w"> </span><span class="c1">// dtor_after == Foo_destructor</span>
</span></span><span id="__span-86-12"><a id="__codelineno-86-12" name="__codelineno-86-12" href="#__codelineno-86-12"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isuserdata"><span class="subsection"><code>lua_isuserdata</code></span><a class="headerlink" href="#lua_isuserdata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isuserdata(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns <code>1</code> if the value at the given stack index is a userdata object. Otherwise, returns <code>0</code>.</p>
<hr />
<h3 id="lual_checkudata"><span class="subsection"><code>luaL_checkudata</code></span><a class="headerlink" href="#lual_checkudata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* luaL_checkudata(lua_State* L, int ud, const char* name)</code></span>
<span class="stack"><code>[0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>ud</code>: Userdata index</li>
<li><code>name</code>: Name</li>
</ul>
<p>Asserts that a value on the stack is a userdata with a matching metatable to <code>name</code> (created with <a href="#lual_newmetatable"><code>luaL_newmetatable</code></a>).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">kFoo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">;</span>
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">};</span>
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="nf">check_Foo</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">luaL_checkudata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFoo</span><span class="p">));</span>
</span></span><span id="__span-87-7"><a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="light-userdata-functions">Light Userdata Functions<a class="headerlink" href="#light-userdata-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_pushlightuserdata"><span class="subsection"><code>lua_pushlightuserdata</code></span><a class="headerlink" href="#lua_pushlightuserdata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushlightuserdata(lua_State* L, void* p)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>p</code>: Pointer to arbitrary user-owned data</li>
</ul>
<p>Pushes the tagged lightuserdata to the stack. Identical to <code>lua_pushlightuserdatatagged</code> with a tag of <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">();</span>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a><span class="hll"><span class="n">lua_pushlightuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">);</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_pushlightuserdatatagged"><span class="subsection"><code>lua_pushlightuserdatatagged</code></span><a class="headerlink" href="#lua_pushlightuserdatatagged" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pushlightuserdatatagged(lua_State* L, void* p, int tag)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>p</code>: Pointer to arbitrary user-owned data</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Pushes the tagged lightuserdata to the stack. Use <a href="#lua_tolightuserdatatagged"><code>lua_tolightuserdatatagged</code></a> to retrieve the value. For more info on tags, see the <a href="guides/tags.html">Tags</a> page.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">();</span>
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a>
</span><span id="__span-89-6"><a id="__codelineno-89-6" name="__codelineno-89-6" href="#__codelineno-89-6"></a><span class="hll"><span class="n">lua_pushlightuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_tolightuserdata"><span class="subsection"><code>lua_tolightuserdata</code></span><a class="headerlink" href="#lua_tolightuserdata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_tolightuserdata(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns a pointer to a lightuserdata on the stack. Returns <code>NULL</code> if the value is not a lightuserdata.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="p">};</span>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a>
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">();</span>
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
</span><span id="__span-90-7"><a id="__codelineno-90-7" name="__codelineno-90-7" href="#__codelineno-90-7"></a>
</span><span id="__span-90-8"><a id="__codelineno-90-8" name="__codelineno-90-8" href="#__codelineno-90-8"></a><span class="n">lua_pushlightuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">);</span>
</span><span id="__span-90-9"><a id="__codelineno-90-9" name="__codelineno-90-9" href="#__codelineno-90-9"></a>
</span><span id="__span-90-10"><a id="__codelineno-90-10" name="__codelineno-90-10" href="#__codelineno-90-10"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_tolightuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span>
</span></span><span id="__span-90-11"><a id="__codelineno-90-11" name="__codelineno-90-11" href="#__codelineno-90-11"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;foo-&gt;n = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// foo-&gt;n = 32</span>
</span><span id="__span-90-12"><a id="__codelineno-90-12" name="__codelineno-90-12" href="#__codelineno-90-12"></a>
</span><span id="__span-90-13"><a id="__codelineno-90-13" name="__codelineno-90-13" href="#__codelineno-90-13"></a><span class="c1">// ...pop lightuserdata and delete allocation</span>
</span></code></pre></div>
<hr />
<h3 id="lua_tolightuserdatatagged"><span class="subsection"><code>lua_tolightuserdatatagged</code></span><a class="headerlink" href="#lua_tolightuserdatatagged" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_tolightuserdatatagged(lua_State* L, int idx, int tag)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Returns a pointer to a lightuserdata on the stack. Returns <code>NULL</code> if the value is not a lightuserdata <em>or</em> if the attached tag does not equal the provided <code>tag</code> argument. For more info on tags, see the <a href="guides/tags.html">Tags</a> page.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a><span class="p">};</span>
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a>
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">();</span>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a>
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a><span class="n">lua_pushlightuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a>
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a><span class="hll"><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_tolightuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">));</span>
</span></span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;foo-&gt;n = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// foo-&gt;n = 32</span>
</span><span id="__span-91-14"><a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a>
</span><span id="__span-91-15"><a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a><span class="c1">// ...pop lightuserdata and delete allocation</span>
</span></code></pre></div>
<hr />
<h3 id="lua_islightuserdata"><span class="subsection"><code>lua_islightuserdata</code></span><a class="headerlink" href="#lua_islightuserdata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_islightuserdata(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a lightuserdata.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_islightuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_lightuserdatatag"><span class="subsection"><code>lua_lightuserdatatag</code></span><a class="headerlink" href="#lua_lightuserdatatag" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_lightuserdatatag(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the tag for the lightuserdata at the given stack position. For non-lightuserdata values, this function returns <code>-1</code>. If the lightuserdata value was not assigned a tag, the tag will be set to the default of <code>0</code>, and thus this function will return <code>0</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kBarTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Bar</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Baz</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-93-7"><a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a>
</span><span id="__span-93-8"><a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">();</span>
</span><span id="__span-93-9"><a id="__codelineno-93-9" name="__codelineno-93-9" href="#__codelineno-93-9"></a><span class="n">lua_pushlightuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span><span id="__span-93-10"><a id="__codelineno-93-10" name="__codelineno-93-10" href="#__codelineno-93-10"></a>
</span><span id="__span-93-11"><a id="__codelineno-93-11" name="__codelineno-93-11" href="#__codelineno-93-11"></a><span class="n">Bar</span><span class="o">*</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Bar</span><span class="p">();</span>
</span><span id="__span-93-12"><a id="__codelineno-93-12" name="__codelineno-93-12" href="#__codelineno-93-12"></a><span class="n">lua_pushlightuserdatatagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="n">kBarTag</span><span class="p">);</span>
</span><span id="__span-93-13"><a id="__codelineno-93-13" name="__codelineno-93-13" href="#__codelineno-93-13"></a>
</span><span id="__span-93-14"><a id="__codelineno-93-14" name="__codelineno-93-14" href="#__codelineno-93-14"></a><span class="n">Baz</span><span class="o">*</span><span class="w"> </span><span class="n">baz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Baz</span><span class="p">();</span>
</span><span id="__span-93-15"><a id="__codelineno-93-15" name="__codelineno-93-15" href="#__codelineno-93-15"></a><span class="n">lua_pushlightuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">baz</span><span class="p">);</span>
</span><span id="__span-93-16"><a id="__codelineno-93-16" name="__codelineno-93-16" href="#__codelineno-93-16"></a>
</span><span id="__span-93-17"><a id="__codelineno-93-17" name="__codelineno-93-17" href="#__codelineno-93-17"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">foo_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_lightuserdatatag</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span><span class="w"> </span><span class="c1">// 10</span>
</span></span><span id="__span-93-18"><a id="__codelineno-93-18" name="__codelineno-93-18" href="#__codelineno-93-18"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">bar_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_lightuserdatatag</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span><span class="w"> </span><span class="c1">// 20</span>
</span></span><span id="__span-93-19"><a id="__codelineno-93-19" name="__codelineno-93-19" href="#__codelineno-93-19"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">baz_tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_lightuserdatatag</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// 0</span>
</span></span><span id="__span-93-20"><a id="__codelineno-93-20" name="__codelineno-93-20" href="#__codelineno-93-20"></a>
</span><span id="__span-93-21"><a id="__codelineno-93-21" name="__codelineno-93-21" href="#__codelineno-93-21"></a><span class="c1">// ...pop lightuserdata and delete allocations</span>
</span></code></pre></div>
<hr />
<h3 id="lua_setlightuserdataname"><span class="subsection"><code>lua_setlightuserdataname</code></span><a class="headerlink" href="#lua_setlightuserdataname" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setlightuserdataname(lua_State* L, int tag, const char* name)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tag</code>: Tag</li>
<li><code>name</code>: Name</li>
</ul>
<p>Sets the name for the tagged lightuserdata. The string is copied, so the provided name argument is safe to dispose.</p>
<p>Calling this function more than once for the same tag will throw an error.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kMyDataTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="n">lua_setlightuserdataname</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kMyDataTag</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MyData&quot;</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getlightuserdataname"><span class="subsection"><code>lua_getlightuserdataname</code></span><a class="headerlink" href="#lua_getlightuserdataname" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_getlightuserdataname(lua_State* L, int tag)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Returns the name for the tagged lightuserdata (or <code>nullptr</code> if no name is assigned).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kMyDataTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a><span class="n">lua_setlightuserdataname</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kMyDataTag</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MyData&quot;</span><span class="p">);</span>
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a><span class="hll"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_getlightuserdataname</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kMyDataTag</span><span class="p">);</span><span class="w"> </span><span class="c1">// name == &quot;MyData&quot;</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_rawsetptagged"><span class="subsection"><code>lua_rawsetptagged</code></span><a class="headerlink" href="#lua_rawsetptagged" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_rawsetptagged(lua_State* L, int idx, void* p, int tag)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>p</code>: Arbitrary pointer to be represented as lightuserdata</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Assuming table <code>t</code> on the stack at <code>idx</code> and <code>v</code> at the top of the stack,
this pops <code>v</code> from the stack and adds it to the table: <code>t[p] = v</code>, where <code>p</code>
is an arbitrary pointer to some data. Luau will turn this into a lightuserdata
value with the given tag.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">SomeData</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a><span class="n">SomeData</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SomeData</span><span class="p">();</span>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="hll"><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span></span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a><span class="hll"><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span></span><span id="__span-96-6"><a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a><span class="hll"><span class="n">lua_rawsetptagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span><span class="w"> </span><span class="c1">// t[data] = &quot;hello&quot;</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_rawgetptagged"><span class="subsection"><code>lua_rawgetptagged</code></span><a class="headerlink" href="#lua_rawgetptagged" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_rawgetptagged(lua_State* L, int idx, void* p, int tag)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>p</code>: Arbitrary pointer to be represented as lightuserdata</li>
<li><code>tag</code>: Tag</li>
</ul>
<p>Assuming table <code>t</code> on the stack at <code>idx</code>, this pushes to the stack <code>t[p]</code> where <code>t[p]</code> is a lightuserdata with the given tag.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">SomeData</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a><span class="n">SomeData</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SomeData</span><span class="p">();</span>
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a>
</span><span id="__span-97-4"><a id="__codelineno-97-4" name="__codelineno-97-4" href="#__codelineno-97-4"></a><span class="kt">int</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-97-5"><a id="__codelineno-97-5" name="__codelineno-97-5" href="#__codelineno-97-5"></a>
</span><span id="__span-97-6"><a id="__codelineno-97-6" name="__codelineno-97-6" href="#__codelineno-97-6"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-97-7"><a id="__codelineno-97-7" name="__codelineno-97-7" href="#__codelineno-97-7"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-97-8"><a id="__codelineno-97-8" name="__codelineno-97-8" href="#__codelineno-97-8"></a><span class="hll"><span class="n">lua_rawsetptagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">);</span><span class="w"> </span><span class="c1">// t[data] = &quot;hello&quot;</span>
</span></span><span id="__span-97-9"><a id="__codelineno-97-9" name="__codelineno-97-9" href="#__codelineno-97-9"></a><span class="hll">
</span></span><span id="__span-97-10"><a id="__codelineno-97-10" name="__codelineno-97-10" href="#__codelineno-97-10"></a><span class="n">lua_rawgetptagged</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">);</span><span class="w"> </span><span class="c1">// v = t[data]</span>
</span><span id="__span-97-11"><a id="__codelineno-97-11" name="__codelineno-97-11" href="#__codelineno-97-11"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// &quot;hello&quot;</span>
</span></code></pre></div>
<hr />
<h2 id="load-and-call-functions">Load and Call Functions<a class="headerlink" href="#load-and-call-functions" title="Permanent link">&para;</a></h2>
<h3 id="luau_load"><span class="subsection"><code>luau_load</code></span><a class="headerlink" href="#luau_load" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luau_load(lua_State* L, const char* chunkname, const char* data, size_t size, int env)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>chunkname</code>: Chunk name</li>
<li><code>data</code>: Bytecode data</li>
<li><code>size</code>: Bytecode data size</li>
<li><code>env</code>: Environment</li>
</ul>
<p>Loads bytecode onto the given thread as a callable function on the top of the stack. If loading fails, the error message is pushed to the stack instead.</p>
<p>The <code>chunkname</code> argument helps with debugging.</p>
<p>Set <code>env</code> to <code>0</code> to use the default environment. Otherwise, this indicates the stack index for the given environment to use.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;print(&#39;hello&#39;)&quot;</span><span class="p">;</span>
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a>
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a><span class="kt">size_t</span><span class="w"> </span><span class="n">bytecode_size</span><span class="p">;</span>
</span><span id="__span-98-4"><a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">bytecode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luau_compile</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bytecode_size</span><span class="p">);</span>
</span><span id="__span-98-5"><a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a>
</span><span id="__span-98-6"><a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luau_load</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;=test&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bytecode</span><span class="p">,</span><span class="w"> </span><span class="n">bytecode_size</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span></span><span id="__span-98-7"><a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a><span class="n">free</span><span class="p">(</span><span class="n">bytecode</span><span class="p">);</span>
</span><span id="__span-98-8"><a id="__codelineno-98-8" name="__codelineno-98-8" href="#__codelineno-98-8"></a>
</span><span id="__span-98-9"><a id="__codelineno-98-9" name="__codelineno-98-9" href="#__codelineno-98-9"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-98-10"><a id="__codelineno-98-10" name="__codelineno-98-10" href="#__codelineno-98-10"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">;</span>
</span><span id="__span-98-11"><a id="__codelineno-98-11" name="__codelineno-98-11" href="#__codelineno-98-11"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tolstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">len</span><span class="p">);</span>
</span><span id="__span-98-12"><a id="__codelineno-98-12" name="__codelineno-98-12" href="#__codelineno-98-12"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-98-13"><a id="__codelineno-98-13" name="__codelineno-98-13" href="#__codelineno-98-13"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;failed to compile: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
</span><span id="__span-98-14"><a id="__codelineno-98-14" name="__codelineno-98-14" href="#__codelineno-98-14"></a><span class="w">    </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-98-15"><a id="__codelineno-98-15" name="__codelineno-98-15" href="#__codelineno-98-15"></a><span class="p">}</span>
</span><span id="__span-98-16"><a id="__codelineno-98-16" name="__codelineno-98-16" href="#__codelineno-98-16"></a>
</span><span id="__span-98-17"><a id="__codelineno-98-17" name="__codelineno-98-17" href="#__codelineno-98-17"></a><span class="c1">// Move loaded chunk to its own thread and run it:</span>
</span><span id="__span-98-18"><a id="__codelineno-98-18" name="__codelineno-98-18" href="#__codelineno-98-18"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-98-19"><a id="__codelineno-98-19" name="__codelineno-98-19" href="#__codelineno-98-19"></a><span class="n">lua_pushvalue</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span><span id="__span-98-20"><a id="__codelineno-98-20" name="__codelineno-98-20" href="#__codelineno-98-20"></a><span class="n">lua_remove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">);</span>
</span><span id="__span-98-21"><a id="__codelineno-98-21" name="__codelineno-98-21" href="#__codelineno-98-21"></a><span class="n">lua_xmove</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-98-22"><a id="__codelineno-98-22" name="__codelineno-98-22" href="#__codelineno-98-22"></a><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-98-23"><a id="__codelineno-98-23" name="__codelineno-98-23" href="#__codelineno-98-23"></a><span class="c1">// ...handle status</span>
</span></code></pre></div>
<hr />
<h3 id="lua_call"><span class="subsection"><code>lua_call</code></span><a class="headerlink" href="#lua_call" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_call(lua_State* L, int nargs, int nresults)</code></span>
<span class="stack"><code>[-(nargs + 1), +nresults, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>nargs</code>: Number of arguments</li>
<li><code>nresults</code>: Number of returned values</li>
</ul>
<p>Calls the function at the top of the stack with <code>nargs</code> arguments, and expecting <code>nresults</code> return values. To use <code>lua_call</code>, push the desired function to the stack, and then push the desired arguments to the stack next.</p>
<p>If the function errors, the program will need to handle the error. This differs based on how Luau was built. See <a href="guides/error-handling.html">Error Handling</a> for more information. Also consider using <a href="#lua_pcall"><code>lua_pcall</code></a> instead.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sub</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-99-4"><a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
</span><span id="__span-99-5"><a id="__codelineno-99-5" name="__codelineno-99-5" href="#__codelineno-99-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-99-6"><a id="__codelineno-99-6" name="__codelineno-99-6" href="#__codelineno-99-6"></a><span class="p">}</span>
</span><span id="__span-99-7"><a id="__codelineno-99-7" name="__codelineno-99-7" href="#__codelineno-99-7"></a>
</span><span id="__span-99-8"><a id="__codelineno-99-8" name="__codelineno-99-8" href="#__codelineno-99-8"></a><span class="c1">// First, push the function:</span>
</span><span id="__span-99-9"><a id="__codelineno-99-9" name="__codelineno-99-9" href="#__codelineno-99-9"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sub&quot;</span><span class="p">);</span>
</span><span id="__span-99-10"><a id="__codelineno-99-10" name="__codelineno-99-10" href="#__codelineno-99-10"></a>
</span><span id="__span-99-11"><a id="__codelineno-99-11" name="__codelineno-99-11" href="#__codelineno-99-11"></a><span class="c1">// Next, push function arguments in order:</span>
</span><span id="__span-99-12"><a id="__codelineno-99-12" name="__codelineno-99-12" href="#__codelineno-99-12"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-99-13"><a id="__codelineno-99-13" name="__codelineno-99-13" href="#__codelineno-99-13"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-99-14"><a id="__codelineno-99-14" name="__codelineno-99-14" href="#__codelineno-99-14"></a>
</span><span id="__span-99-15"><a id="__codelineno-99-15" name="__codelineno-99-15" href="#__codelineno-99-15"></a><span class="c1">// Finally, call `lua_call`, which will pop the arguments and function from the stack:</span>
</span><span id="__span-99-16"><a id="__codelineno-99-16" name="__codelineno-99-16" href="#__codelineno-99-16"></a><span class="hll"><span class="n">lua_call</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// 2 args, 1 result</span>
</span></span><span id="__span-99-17"><a id="__codelineno-99-17" name="__codelineno-99-17" href="#__codelineno-99-17"></a>
</span><span id="__span-99-18"><a id="__codelineno-99-18" name="__codelineno-99-18" href="#__codelineno-99-18"></a><span class="kt">double</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// result is at the top of the stack</span>
</span><span id="__span-99-19"><a id="__codelineno-99-19" name="__codelineno-99-19" href="#__codelineno-99-19"></a><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// clean up stack</span>
</span><span id="__span-99-20"><a id="__codelineno-99-20" name="__codelineno-99-20" href="#__codelineno-99-20"></a>
</span><span id="__span-99-21"><a id="__codelineno-99-21" name="__codelineno-99-21" href="#__codelineno-99-21"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;15 - 10 = %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">difference</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_pcall"><span class="subsection"><code>lua_pcall</code></span><a class="headerlink" href="#lua_pcall" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_pcall(lua_State* L, int nargs, int nresults, int errfunc)</code></span>
<span class="stack"><code>[-(nargs + 1), +nresults, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>nargs</code>: Number of arguments</li>
<li><code>nresults</code>: Number of returned values</li>
<li><code>errfunc</code>: Error function index (or 0 for none)</li>
</ul>
<p>Similar to <a href="#lua_call"><code>lua_call</code></a>, except the function is run in protected mode. The status of the call is returned, which can be checked to see if the call succeeded or not. When successful, results are pushed to the stack in the same way as <code>lua_call</code>.</p>
<p>If <code>errfunc</code> is set to <code>0</code>, then the error message will be put onto the stack. Otherwise, <code>errfunc</code> must point to a function on the stack. The function will be called with the given error message. Whatever this error function returns will then be placed onto the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">sub</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-100-4"><a id="__codelineno-100-4" name="__codelineno-100-4" href="#__codelineno-100-4"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
</span><span id="__span-100-5"><a id="__codelineno-100-5" name="__codelineno-100-5" href="#__codelineno-100-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-100-6"><a id="__codelineno-100-6" name="__codelineno-100-6" href="#__codelineno-100-6"></a><span class="p">}</span>
</span><span id="__span-100-7"><a id="__codelineno-100-7" name="__codelineno-100-7" href="#__codelineno-100-7"></a>
</span><span id="__span-100-8"><a id="__codelineno-100-8" name="__codelineno-100-8" href="#__codelineno-100-8"></a><span class="c1">// First, push the function:</span>
</span><span id="__span-100-9"><a id="__codelineno-100-9" name="__codelineno-100-9" href="#__codelineno-100-9"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">sub</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sub&quot;</span><span class="p">);</span>
</span><span id="__span-100-10"><a id="__codelineno-100-10" name="__codelineno-100-10" href="#__codelineno-100-10"></a>
</span><span id="__span-100-11"><a id="__codelineno-100-11" name="__codelineno-100-11" href="#__codelineno-100-11"></a><span class="c1">// Next, push function arguments in order:</span>
</span><span id="__span-100-12"><a id="__codelineno-100-12" name="__codelineno-100-12" href="#__codelineno-100-12"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-100-13"><a id="__codelineno-100-13" name="__codelineno-100-13" href="#__codelineno-100-13"></a><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-100-14"><a id="__codelineno-100-14" name="__codelineno-100-14" href="#__codelineno-100-14"></a>
</span><span id="__span-100-15"><a id="__codelineno-100-15" name="__codelineno-100-15" href="#__codelineno-100-15"></a><span class="c1">// Finally, call `lua_call`, which will pop the arguments and function from the stack:</span>
</span><span id="__span-100-16"><a id="__codelineno-100-16" name="__codelineno-100-16" href="#__codelineno-100-16"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_pcall</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// 2 args, 1 result, and no error handler function</span>
</span></span><span id="__span-100-17"><a id="__codelineno-100-17" name="__codelineno-100-17" href="#__codelineno-100-17"></a>
</span><span id="__span-100-18"><a id="__codelineno-100-18" name="__codelineno-100-18" href="#__codelineno-100-18"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LUA_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-100-19"><a id="__codelineno-100-19" name="__codelineno-100-19" href="#__codelineno-100-19"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// result is at the top of the stack</span>
</span><span id="__span-100-20"><a id="__codelineno-100-20" name="__codelineno-100-20" href="#__codelineno-100-20"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// clean up stack</span>
</span><span id="__span-100-21"><a id="__codelineno-100-21" name="__codelineno-100-21" href="#__codelineno-100-21"></a>
</span><span id="__span-100-22"><a id="__codelineno-100-22" name="__codelineno-100-22" href="#__codelineno-100-22"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;15 - 10 = %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">difference</span><span class="p">);</span>
</span><span id="__span-100-23"><a id="__codelineno-100-23" name="__codelineno-100-23" href="#__codelineno-100-23"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-100-24"><a id="__codelineno-100-24" name="__codelineno-100-24" href="#__codelineno-100-24"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-100-25"><a id="__codelineno-100-25" name="__codelineno-100-25" href="#__codelineno-100-25"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-100-26"><a id="__codelineno-100-26" name="__codelineno-100-26" href="#__codelineno-100-26"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;error: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
</span><span id="__span-100-27"><a id="__codelineno-100-27" name="__codelineno-100-27" href="#__codelineno-100-27"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_cpcall"><span class="subsection"><code>lua_cpcall</code></span><a class="headerlink" href="#lua_cpcall" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_cpcall(lua_State* L, lua_CFunction func, void* ud)</code></span>
<span class="stack"><code>[-(nargs + 1), +nresults, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>func</code>: C function</li>
<li><code>ud</code>: Light userdata</li>
</ul>
<p>Calls the C function in protected mode, passing <code>ud</code> as the single item on the stack for the function. Returns the status, just like <code>lua_pcall</code>. Functions returned by <code>func</code> are automatically discarded.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a><span class="p">};</span>
</span><span id="__span-101-4"><a id="__codelineno-101-4" name="__codelineno-101-4" href="#__codelineno-101-4"></a>
</span><span id="__span-101-5"><a id="__codelineno-101-5" name="__codelineno-101-5" href="#__codelineno-101-5"></a><span class="kt">int</span><span class="w"> </span><span class="nf">fn</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-101-6"><a id="__codelineno-101-6" name="__codelineno-101-6" href="#__codelineno-101-6"></a><span class="w">    </span><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_tolightuserdata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
</span><span id="__span-101-7"><a id="__codelineno-101-7" name="__codelineno-101-7" href="#__codelineno-101-7"></a><span class="w">    </span><span class="n">foo</span><span class="o">-&gt;</span><span class="n">n</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-101-8"><a id="__codelineno-101-8" name="__codelineno-101-8" href="#__codelineno-101-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-101-9"><a id="__codelineno-101-9" name="__codelineno-101-9" href="#__codelineno-101-9"></a><span class="p">}</span>
</span><span id="__span-101-10"><a id="__codelineno-101-10" name="__codelineno-101-10" href="#__codelineno-101-10"></a>
</span><span id="__span-101-11"><a id="__codelineno-101-11" name="__codelineno-101-11" href="#__codelineno-101-11"></a><span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="p">{};</span>
</span><span id="__span-101-12"><a id="__codelineno-101-12" name="__codelineno-101-12" href="#__codelineno-101-12"></a><span class="n">foo</span><span class="p">.</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-101-13"><a id="__codelineno-101-13" name="__codelineno-101-13" href="#__codelineno-101-13"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_cpcall</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo</span><span class="p">);</span>
</span></span><span id="__span-101-14"><a id="__codelineno-101-14" name="__codelineno-101-14" href="#__codelineno-101-14"></a>
</span><span id="__span-101-15"><a id="__codelineno-101-15" name="__codelineno-101-15" href="#__codelineno-101-15"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LUA_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-101-16"><a id="__codelineno-101-16" name="__codelineno-101-16" href="#__codelineno-101-16"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;n: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">n</span><span class="p">);</span><span class="w"> </span><span class="c1">// n: 20</span>
</span><span id="__span-101-17"><a id="__codelineno-101-17" name="__codelineno-101-17" href="#__codelineno-101-17"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-101-18"><a id="__codelineno-101-18" name="__codelineno-101-18" href="#__codelineno-101-18"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-101-19"><a id="__codelineno-101-19" name="__codelineno-101-19" href="#__codelineno-101-19"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-101-20"><a id="__codelineno-101-20" name="__codelineno-101-20" href="#__codelineno-101-20"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;error: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="p">);</span>
</span><span id="__span-101-21"><a id="__codelineno-101-21" name="__codelineno-101-21" href="#__codelineno-101-21"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_callyieldable"><span class="subsection"><code>luaL_callyieldable</code></span><a class="headerlink" href="#lual_callyieldable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_callyieldable(lua_State* L, int nargs, int nresults)</code></span>
<span class="stack"><code>[-(nargs + 1), +nresults, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>nargs</code>: Number of arguments</li>
<li><code>nresults</code>: Number of returned values</li>
</ul>
<p>Similar to <code>lua_call</code>, except this function can call yieldable C functions.</p>
<p>Returns the status of the call. If the call was a C function and the C function yielded, this will be <code>-1</code>.</p>
<hr />
<h2 id="load-and-call-functions_1">Load and Call Functions<a class="headerlink" href="#load-and-call-functions_1" title="Permanent link">&para;</a></h2>
<h3 id="lua_yield"><span class="subsection"><code>lua_yield</code></span><a class="headerlink" href="#lua_yield" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_yield(lua_State* L, int nresults)</code></span>
<span class="stack"><code>[-?, +?, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>nresults</code>: Number of returned values</li>
</ul>
<p>Yields a coroutine thread. This should only be called as the return value of a C function.</p>
<p>The <code>nresults</code> argument indicates how many stack values remain on the thread's stack, allowing the caller of <code>lua_resume</code> to grab those values.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">do_something</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="w">    </span><span class="c1">// Yield back &#39;15&#39; to the lua_resume call:</span>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
</span><span id="__span-102-4"><a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">lua_yield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-102-5"><a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a><span class="p">}</span>
</span><span id="__span-102-6"><a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a>
</span><span id="__span-102-7"><a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-102-8"><a id="__codelineno-102-8" name="__codelineno-102-8" href="#__codelineno-102-8"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">do_something</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;do_something&quot;</span><span class="p">);</span>
</span><span id="__span-102-9"><a id="__codelineno-102-9" name="__codelineno-102-9" href="#__codelineno-102-9"></a><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-102-10"><a id="__codelineno-102-10" name="__codelineno-102-10" href="#__codelineno-102-10"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LUA_YIELD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-102-11"><a id="__codelineno-102-11" name="__codelineno-102-11" href="#__codelineno-102-11"></a><span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tointeger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// 15</span>
</span><span id="__span-102-12"><a id="__codelineno-102-12" name="__codelineno-102-12" href="#__codelineno-102-12"></a><span class="w">  </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-102-13"><a id="__codelineno-102-13" name="__codelineno-102-13" href="#__codelineno-102-13"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_break"><span class="subsection"><code>lua_break</code></span><a class="headerlink" href="#lua_break" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_break(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Trigger a break (i.e. breakpoint). This is different than <code>lua_breakpoint</code>, which installs a breakpoint.</p>
<hr />
<h3 id="lua_resume"><span class="subsection"><code>lua_resume</code></span><a class="headerlink" href="#lua_resume" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_resume(lua_State* L, lua_State* from, int narg)</code></span>
<span class="stack"><code>[-?, +?, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>from</code>: From Lua thread</li>
<li><code>narg</code>: Number of arguments</li>
</ul>
<p>Resumes a coroutine. The status of the resumption is returned.</p>
<p>To start a new coroutine, do the following:
1. Create a new thread, e.g. <a href="#lua_newthread"><code>lua_newthread</code></a>
1. Place a function onto the new thread's stack
1. Place arguments in-order onto the new thread's stack (same amount as indicated with <code>narg</code> argument)
1. Call <code>lua_resume</code>
1. Handle the result</p>
<p>To resume an existing coroutine:
1. Place arguments onto the thread's stack (These will be the returned result from Luau's <code>coroutine.yield</code> call)
1. Call <code>lua_resume</code>
1. Handle the result</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a><span class="w">    </span><span class="c1">// Get args:</span>
</span><span id="__span-103-3"><a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-103-4"><a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-103-5"><a id="__codelineno-103-5" name="__codelineno-103-5" href="#__codelineno-103-5"></a>
</span><span id="__span-103-6"><a id="__codelineno-103-6" name="__codelineno-103-6" href="#__codelineno-103-6"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
</span><span id="__span-103-7"><a id="__codelineno-103-7" name="__codelineno-103-7" href="#__codelineno-103-7"></a>
</span><span id="__span-103-8"><a id="__codelineno-103-8" name="__codelineno-103-8" href="#__codelineno-103-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-103-9"><a id="__codelineno-103-9" name="__codelineno-103-9" href="#__codelineno-103-9"></a><span class="p">}</span>
</span><span id="__span-103-10"><a id="__codelineno-103-10" name="__codelineno-103-10" href="#__codelineno-103-10"></a>
</span><span id="__span-103-11"><a id="__codelineno-103-11" name="__codelineno-103-11" href="#__codelineno-103-11"></a><span class="c1">// Create thread:</span>
</span><span id="__span-103-12"><a id="__codelineno-103-12" name="__codelineno-103-12" href="#__codelineno-103-12"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-103-13"><a id="__codelineno-103-13" name="__codelineno-103-13" href="#__codelineno-103-13"></a>
</span><span id="__span-103-14"><a id="__codelineno-103-14" name="__codelineno-103-14" href="#__codelineno-103-14"></a><span class="c1">// Push function to thread:</span>
</span><span id="__span-103-15"><a id="__codelineno-103-15" name="__codelineno-103-15" href="#__codelineno-103-15"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">add</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;add&quot;</span><span class="p">);</span>
</span><span id="__span-103-16"><a id="__codelineno-103-16" name="__codelineno-103-16" href="#__codelineno-103-16"></a>
</span><span id="__span-103-17"><a id="__codelineno-103-17" name="__codelineno-103-17" href="#__codelineno-103-17"></a><span class="c1">// Push arguments:</span>
</span><span id="__span-103-18"><a id="__codelineno-103-18" name="__codelineno-103-18" href="#__codelineno-103-18"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span><span id="__span-103-19"><a id="__codelineno-103-19" name="__codelineno-103-19" href="#__codelineno-103-19"></a><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
</span><span id="__span-103-20"><a id="__codelineno-103-20" name="__codelineno-103-20" href="#__codelineno-103-20"></a>
</span><span id="__span-103-21"><a id="__codelineno-103-21" name="__codelineno-103-21" href="#__codelineno-103-21"></a><span class="c1">// Resume:</span>
</span><span id="__span-103-22"><a id="__codelineno-103-22" name="__codelineno-103-22" href="#__codelineno-103-22"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span></span><span id="__span-103-23"><a id="__codelineno-103-23" name="__codelineno-103-23" href="#__codelineno-103-23"></a>
</span><span id="__span-103-24"><a id="__codelineno-103-24" name="__codelineno-103-24" href="#__codelineno-103-24"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LUA_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-103-25"><a id="__codelineno-103-25" name="__codelineno-103-25" href="#__codelineno-103-25"></a><span class="w">    </span><span class="c1">// Coroutine is done</span>
</span><span id="__span-103-26"><a id="__codelineno-103-26" name="__codelineno-103-26" href="#__codelineno-103-26"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;ok&quot;</span><span class="p">);</span>
</span><span id="__span-103-27"><a id="__codelineno-103-27" name="__codelineno-103-27" href="#__codelineno-103-27"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LUA_YIELD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-103-28"><a id="__codelineno-103-28" name="__codelineno-103-28" href="#__codelineno-103-28"></a><span class="w">    </span><span class="c1">// Handle yielded thread</span>
</span><span id="__span-103-29"><a id="__codelineno-103-29" name="__codelineno-103-29" href="#__codelineno-103-29"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;yielded&quot;</span><span class="p">);</span>
</span><span id="__span-103-30"><a id="__codelineno-103-30" name="__codelineno-103-30" href="#__codelineno-103-30"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-103-31"><a id="__codelineno-103-31" name="__codelineno-103-31" href="#__codelineno-103-31"></a><span class="w">    </span><span class="c1">// Handle error (call lua_getinfo and lua_debugtrace for better debugging and stacktrace information)</span>
</span><span id="__span-103-32"><a id="__codelineno-103-32" name="__codelineno-103-32" href="#__codelineno-103-32"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-103-33"><a id="__codelineno-103-33" name="__codelineno-103-33" href="#__codelineno-103-33"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;error: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
</span><span id="__span-103-34"><a id="__codelineno-103-34" name="__codelineno-103-34" href="#__codelineno-103-34"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-103-35"><a id="__codelineno-103-35" name="__codelineno-103-35" href="#__codelineno-103-35"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;unknown error: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
</span><span id="__span-103-36"><a id="__codelineno-103-36" name="__codelineno-103-36" href="#__codelineno-103-36"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-103-37"><a id="__codelineno-103-37" name="__codelineno-103-37" href="#__codelineno-103-37"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_resumeerror"><span class="subsection"><code>lua_resumeerror</code></span><a class="headerlink" href="#lua_resumeerror" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_resumeerror(lua_State* L, lua_State* from)</code></span>
<span class="stack"><code>[-?, +?, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>from</code>: From Lua thread</li>
</ul>
<p>Resumes a coroutine, but in an error state. This is useful when reporting an error to a yielded thread.</p>
<p>For example, a coroutine might yield to wait for some sort of web request. The yielded thread needs to be resumed, but also needs to report that an error occurred. Thus, <code>lua_resume</code> would not be adequate.</p>
<p>The status of the resumption is returned.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="c1">// Some sort of error occurs for our thread, e.g. a web request fails</span>
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a><span class="c1">// We&#39;ll push a string onto the stack to indicate what went wrong</span>
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;oh no, the request failed!&quot;</span><span class="p">);</span>
</span><span id="__span-104-4"><a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a>
</span><span id="__span-104-5"><a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a><span class="c1">// Elsewhere, in some hypothetical task scheduler, we resume the yielded thread:</span>
</span><span id="__span-104-6"><a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
</span><span id="__span-104-7"><a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">there_was_an_error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-104-8"><a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a><span class="hll"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resumeerror</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">);</span>
</span></span><span id="__span-104-9"><a id="__codelineno-104-9" name="__codelineno-104-9" href="#__codelineno-104-9"></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-104-10"><a id="__codelineno-104-10" name="__codelineno-104-10" href="#__codelineno-104-10"></a><span class="w">    </span><span class="c1">// ...normal resumption</span>
</span><span id="__span-104-11"><a id="__codelineno-104-11" name="__codelineno-104-11" href="#__codelineno-104-11"></a><span class="p">}</span>
</span><span id="__span-104-12"><a id="__codelineno-104-12" name="__codelineno-104-12" href="#__codelineno-104-12"></a>
</span><span id="__span-104-13"><a id="__codelineno-104-13" name="__codelineno-104-13" href="#__codelineno-104-13"></a><span class="c1">// ...handle status</span>
</span><span id="__span-104-14"><a id="__codelineno-104-14" name="__codelineno-104-14" href="#__codelineno-104-14"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">LUA_OK</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">LUA_YIELD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-104-15"><a id="__codelineno-104-15" name="__codelineno-104-15" href="#__codelineno-104-15"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"> </span><span class="c1">// Might be our &quot;oh no, the request failed!&quot; error message</span>
</span><span id="__span-104-16"><a id="__codelineno-104-16" name="__codelineno-104-16" href="#__codelineno-104-16"></a><span class="w">    </span><span class="c1">// ...other more complete error handling</span>
</span><span id="__span-104-17"><a id="__codelineno-104-17" name="__codelineno-104-17" href="#__codelineno-104-17"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_status"><span class="subsection"><code>lua_status</code></span><a class="headerlink" href="#lua_status" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_status(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Returns any <code>lua_Status</code> value:
<div class="language-cpp highlight"><span class="filename">lua_Status</span><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="c1">// Copied from luau/VM/include/lua.h</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="k">enum</span><span class="w"> </span><span class="nc">lua_Status</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="w">      </span><span class="n">LUA_OK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="w">    </span><span class="n">LUA_YIELD</span><span class="p">,</span>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="w">    </span><span class="n">LUA_ERRRUN</span><span class="p">,</span>
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="w">    </span><span class="n">LUA_ERRSYNTAX</span><span class="p">,</span><span class="w"> </span><span class="c1">// legacy error code, preserved for compatibility</span>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a><span class="w">    </span><span class="n">LUA_ERRMEM</span><span class="p">,</span>
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a><span class="w">    </span><span class="n">LUA_ERRERR</span><span class="p">,</span>
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a><span class="w">    </span><span class="n">LUA_BREAK</span><span class="p">,</span><span class="w"> </span><span class="c1">// yielded for a debug breakpoint</span>
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a><span class="p">};</span>
</span></code></pre></div></p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">all_good</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a><span class="p">}</span>
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a>
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a><span class="kt">int</span><span class="w"> </span><span class="nf">oh_no</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-106-6"><a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a><span class="w">    </span><span class="n">luaL_error</span><span class="p">(</span><span class="s">&quot;oh no!&quot;</span><span class="p">);</span>
</span><span id="__span-106-7"><a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a><span class="p">}</span>
</span><span id="__span-106-8"><a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a>
</span><span id="__span-106-9"><a id="__codelineno-106-9" name="__codelineno-106-9" href="#__codelineno-106-9"></a><span class="kt">int</span><span class="w"> </span><span class="nf">yield_something</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-106-10"><a id="__codelineno-106-10" name="__codelineno-106-10" href="#__codelineno-106-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">lua_yield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-106-11"><a id="__codelineno-106-11" name="__codelineno-106-11" href="#__codelineno-106-11"></a><span class="p">}</span>
</span><span id="__span-106-12"><a id="__codelineno-106-12" name="__codelineno-106-12" href="#__codelineno-106-12"></a>
</span><span id="__span-106-13"><a id="__codelineno-106-13" name="__codelineno-106-13" href="#__codelineno-106-13"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-106-14"><a id="__codelineno-106-14" name="__codelineno-106-14" href="#__codelineno-106-14"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">all_good</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;all_good&quot;</span><span class="p">);</span>
</span><span id="__span-106-15"><a id="__codelineno-106-15" name="__codelineno-106-15" href="#__codelineno-106-15"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// LUA_OK (0)</span>
</span></span><span id="__span-106-16"><a id="__codelineno-106-16" name="__codelineno-106-16" href="#__codelineno-106-16"></a>
</span><span id="__span-106-17"><a id="__codelineno-106-17" name="__codelineno-106-17" href="#__codelineno-106-17"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-106-18"><a id="__codelineno-106-18" name="__codelineno-106-18" href="#__codelineno-106-18"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">oh_no</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;oh_no&quot;</span><span class="p">);</span>
</span><span id="__span-106-19"><a id="__codelineno-106-19" name="__codelineno-106-19" href="#__codelineno-106-19"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// LUA_ERRRUN (2)</span>
</span></span><span id="__span-106-20"><a id="__codelineno-106-20" name="__codelineno-106-20" href="#__codelineno-106-20"></a>
</span><span id="__span-106-21"><a id="__codelineno-106-21" name="__codelineno-106-21" href="#__codelineno-106-21"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-106-22"><a id="__codelineno-106-22" name="__codelineno-106-22" href="#__codelineno-106-22"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">yield_something</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;yield_something&quot;</span><span class="p">);</span>
</span><span id="__span-106-23"><a id="__codelineno-106-23" name="__codelineno-106-23" href="#__codelineno-106-23"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// LUA_YIELD (1)</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_isyieldable"><span class="subsection"><code>lua_isyieldable</code></span><a class="headerlink" href="#lua_isyieldable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isyieldable(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Returns <code>1</code> if the coroutine is yieldable, otherwise <code>0</code>.</p>
<hr />
<h3 id="lua_getthreaddata"><span class="subsection"><code>lua_getthreaddata</code></span><a class="headerlink" href="#lua_getthreaddata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void* lua_getthreaddata(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Gets data attached to the given thread. This is arbitrary data that is assigned with <a href="#lua_setthreaddata"><code>lua_setthreaddata</code></a>.</p>
<hr />
<h3 id="lua_setthreaddata"><span class="subsection"><code>lua_setthreaddata</code></span><a class="headerlink" href="#lua_setthreaddata" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_setthreaddata(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Sets arbitrary data for a given thread. This is often useful when using lua interrupt or thread callbacks (see <a href="#lua_callbacks"><code>lua_callbacks</code></a>).</p>
<p>This value ought not be a Luau-owned object (e.g. data created with <code>lua_newuserdata</code>), since the lifetime of that memory may be shorter than the lifetime of the given thread.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a>
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a><span class="n">lua_setthreaddata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">());</span>
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="c1">// ...</span>
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a><span class="n">Foo</span><span class="o">*</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">lua_getthreaddata</span><span class="p">(</span><span class="n">L</span><span class="p">));</span>
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a><span class="c1">// ...</span>
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a><span class="n">lua_setthreaddata</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a><span class="k">delete</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span>
</span></code></pre></div>
<hr />
<h3 id="lua_costatus"><span class="subsection"><code>lua_costatus</code></span><a class="headerlink" href="#lua_costatus" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_costatus(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Gets the coroutine status (<code>lua_CoStatus</code>) of a given thread.</p>
<div class="language-cpp highlight"><span class="filename">lua_CoStatus</span><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="c1">// Copied from luau/VM/include/lua.h</span>
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a><span class="k">enum</span><span class="w"> </span><span class="nc">lua_CoStatus</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a><span class="w">    </span><span class="n">LUA_CORUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="c1">// running</span>
</span><span id="__span-108-4"><a id="__codelineno-108-4" name="__codelineno-108-4" href="#__codelineno-108-4"></a><span class="w">    </span><span class="n">LUA_COSUS</span><span class="p">,</span><span class="w">     </span><span class="c1">// suspended</span>
</span><span id="__span-108-5"><a id="__codelineno-108-5" name="__codelineno-108-5" href="#__codelineno-108-5"></a><span class="w">    </span><span class="n">LUA_CONOR</span><span class="p">,</span><span class="w">     </span><span class="c1">// &#39;normal&#39; (it resumed another coroutine)</span>
</span><span id="__span-108-6"><a id="__codelineno-108-6" name="__codelineno-108-6" href="#__codelineno-108-6"></a><span class="w">    </span><span class="n">LUA_COFIN</span><span class="p">,</span><span class="w">     </span><span class="c1">// finished</span>
</span><span id="__span-108-7"><a id="__codelineno-108-7" name="__codelineno-108-7" href="#__codelineno-108-7"></a><span class="w">    </span><span class="n">LUA_COERR</span><span class="p">,</span><span class="w">     </span><span class="c1">// finished with error</span>
</span><span id="__span-108-8"><a id="__codelineno-108-8" name="__codelineno-108-8" href="#__codelineno-108-8"></a><span class="p">};</span>
</span></code></pre></div>
<hr />
<h2 id="memory-functions">Memory Functions<a class="headerlink" href="#memory-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_gc"><span class="subsection"><code>lua_gc</code></span><a class="headerlink" href="#lua_gc" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_gc(lua_State* L, int what, int data)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>what</code>: What</li>
<li><code>data</code>: Data</li>
</ul>
<p>Various garbage collection operations, determined by the <code>what</code> argument.</p>
<p>Starting and stopping the GC:</p>
<ul>
<li>To stop the GC: <code>lua_gc(L, LUA_GCSTOP, 0);</code></li>
<li>To restart the GC: <code>lua_gc(L, LUA_GCRESTART, 0);</code></li>
<li>To run a full GC cycle: <code>lua_gc(L, LUA_GCCOLLECT, 0);</code></li>
<li>To run a GC step: <code>lua_gc(L, LUA_GCSTEP, 0);</code></li>
</ul>
<p>Querying the GC:</p>
<ul>
<li>To check if the GC is running: <code>if (lua_gc(L, LUA_GCISRUNNING, 0)) {}</code></li>
<li>To count GC usage in kilobytes: <code>int kb = lua_gc(L, LUA_GCCOUNT, 0);</code></li>
<li>To count the remaining GC in bytes: <code>int b = lua_gc(L, LUA_GCCOUNTB, 0);</code></li>
</ul>
<p>Tuning the GC:</p>
<ul>
<li>To set the GC goal (percentage): <code>lua_gc(L, LUA_GCSETGOAL, 200);</code></li>
<li>To set the GC step multiplier (percentage): <code>lua_gc(L, LUA_GCSETSTEPMUL, 200);</code></li>
<li>To set the GC step size (KB): <code>lua_gc(L, LUA_GCSETSTEPSIZE, 1);</code></li>
</ul>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="c1">// Example of querying bytes used:</span>
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">kb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_gc</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">LUA_GCCOUNT</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">bytes_remaining</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_gc</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">LUA_GCCOUNTB</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a><span class="kt">int</span><span class="w"> </span><span class="n">bytes_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">byte_remaining</span><span class="p">;</span>
</span><span id="__span-109-5"><a id="__codelineno-109-5" name="__codelineno-109-5" href="#__codelineno-109-5"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;gc size: %d bytes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bytes_total</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_setmemcat"><span class="subsection"><code>lua_setmemcat</code></span><a class="headerlink" href="#lua_setmemcat" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setmemcat(lua_State* L, int category)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>category</code>: Memory category</li>
</ul>
<p>Set the memory category for a given thread (the default is <code>0</code>). There is no associated function to retrieve a thread's current memory category.</p>
<p>Call <a href="#lua_totalbytes"><code>lua_totalbytes</code></a> to query the amount of memory utilized by a given memory category.</p>
<p><strong>Note:</strong> While the <code>category</code> parameter is an <code>int</code>, the actual memory category attached to the thread is a <code>uint8_t</code>, and thus the category parameter is cast to <code>uint8_t</code>. Therefore, memory categories are limited to the range <code>[0, 255]</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="c1">// Set the memory category of `L` to 10:</span>
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a><span class="n">lua_setmemcat</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_totalbytes"><span class="subsection"><code>lua_totalbytes</code></span><a class="headerlink" href="#lua_totalbytes" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>size_t lua_totalbytes(lua_State* L, int category)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>category</code>: Memory category</li>
</ul>
<p>Retrieves the total bytes allocated by a given memory category (<code>0</code> is the default memory category). Call <a href="#lua_setmemcat"><code>lua_setmemcat</code></a> to assign a memory category for a given thread.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">kExampleMemCat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a>
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-111-4"><a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="n">lua_setmemcat</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">kExampleMemCat</span><span class="p">);</span>
</span><span id="__span-111-5"><a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a><span class="n">lua_newbuffer</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// 10KB buffer</span>
</span><span id="__span-111-6"><a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a>
</span><span id="__span-111-7"><a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a><span class="hll"><span class="kt">size_t</span><span class="w"> </span><span class="n">total_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_totalbytes</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">kExampleMemCat</span><span class="p">);</span>
</span></span><span id="__span-111-8"><a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;total: %zu bytes</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">total_bytes</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h2 id="error-functions">Error Functions<a class="headerlink" href="#error-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_error"><span class="subsection"><code>lua_error</code></span><a class="headerlink" href="#lua_error" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>l_noret lua_error(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Throws a Luau error. Expects the error message to be on the top of the stack. Depending on how Luau is built, this will either perform a <code>longjmp</code> or throw a C++ <code>luau_exception</code>. See <a href="guides/error-handling.html">Error Handling</a> for more information.</p>
<p>Using <a href="#lual_error"><code>luaL_error</code></a> is typically a more ergonomic way to throw errors, since an error message can be provided.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">multiply_by_two</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a><span class="w">    </span><span class="c1">// This is just for example (could use luaL_checknumber instead)</span>
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_type</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">LUA_TNUMBER</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-112-4"><a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a><span class="w">        </span><span class="c1">// 1. Push error message to the stack:</span>
</span><span id="__span-112-5"><a id="__codelineno-112-5" name="__codelineno-112-5" href="#__codelineno-112-5"></a><span class="w">        </span><span class="n">lua_pushfstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;expected number; got %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
</span><span id="__span-112-6"><a id="__codelineno-112-6" name="__codelineno-112-6" href="#__codelineno-112-6"></a><span class="w">        </span><span class="c1">// 2. Throw error</span>
</span><span id="__span-112-7"><a id="__codelineno-112-7" name="__codelineno-112-7" href="#__codelineno-112-7"></a><span class="w">        </span><span class="n">lua_error</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-112-8"><a id="__codelineno-112-8" name="__codelineno-112-8" href="#__codelineno-112-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-112-9"><a id="__codelineno-112-9" name="__codelineno-112-9" href="#__codelineno-112-9"></a>
</span><span id="__span-112-10"><a id="__codelineno-112-10" name="__codelineno-112-10" href="#__codelineno-112-10"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tonumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-112-11"><a id="__codelineno-112-11" name="__codelineno-112-11" href="#__codelineno-112-11"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0</span><span class="p">);</span>
</span><span id="__span-112-12"><a id="__codelineno-112-12" name="__codelineno-112-12" href="#__codelineno-112-12"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-112-13"><a id="__codelineno-112-13" name="__codelineno-112-13" href="#__codelineno-112-13"></a><span class="p">}</span>
</span><span id="__span-112-14"><a id="__codelineno-112-14" name="__codelineno-112-14" href="#__codelineno-112-14"></a><span class="c1">// ...</span>
</span><span id="__span-112-15"><a id="__codelineno-112-15" name="__codelineno-112-15" href="#__codelineno-112-15"></a><span class="n">lua_pushcfunction</span><span class="p">(</span><span class="n">multiply_by_two</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;multiply_by_two&quot;</span><span class="p">);</span>
</span><span id="__span-112-16"><a id="__codelineno-112-16" name="__codelineno-112-16" href="#__codelineno-112-16"></a><span class="n">lua_setglobal</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;multiply_by_two&quot;</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-luau highlight"><span class="filename">Luau Example</span><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a><span class="c1">-- throws error: &quot;expected number; got string&quot;</span>
</span><span id="__span-113-2"><a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a><span class="nf">multiply_by_two</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
</span></code></pre></div>
<hr />
<h3 id="lual_error"><span class="subsection"><code>luaL_error</code></span><a class="headerlink" href="#lual_error" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>l_noret luaL_error(lua_State* L, const char* fmt,  ...)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>fmt</code>: Format string</li>
<li><code>...</code>: Args</li>
</ul>
<p>Throws a Luau error with the given error message.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="n">luaL_error</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;something went wrong&quot;</span><span class="p">);</span>
</span><span id="__span-114-2"><a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a>
</span><span id="__span-114-3"><a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a><span class="c1">// Error message can be formatted:</span>
</span><span id="__span-114-4"><a id="__codelineno-114-4" name="__codelineno-114-4" href="#__codelineno-114-4"></a><span class="kt">int</span><span class="w"> </span><span class="n">some_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-114-5"><a id="__codelineno-114-5" name="__codelineno-114-5" href="#__codelineno-114-5"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;it zigged but it should have zagged&quot;</span><span class="p">;</span>
</span><span id="__span-114-6"><a id="__codelineno-114-6" name="__codelineno-114-6" href="#__codelineno-114-6"></a><span class="n">luaL_error</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%d - %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">some_code</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lual_typeerror"><span class="subsection"><code>luaL_typeerror</code></span><a class="headerlink" href="#lual_typeerror" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>l_noret luaL_typeerror(lua_State* L, int narg, const char* tname)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>narg</code>: Argument number</li>
<li><code>tname</code>: Type name</li>
</ul>
<p>Throws a Luau error with a templated error message for an incorrect type.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">send_table</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-115-2"><a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a><span class="w">    </span><span class="c1">// expects a table as the first argument</span>
</span><span id="__span-115-3"><a id="__codelineno-115-3" name="__codelineno-115-3" href="#__codelineno-115-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-115-4"><a id="__codelineno-115-4" name="__codelineno-115-4" href="#__codelineno-115-4"></a><span class="w">        </span><span class="n">luaL_typeerror</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;table&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// &quot;invalid argument #1 to &#39;send_table&#39; (table expected, got &lt;TYPENAME&gt;)&quot;</span>
</span><span id="__span-115-5"><a id="__codelineno-115-5" name="__codelineno-115-5" href="#__codelineno-115-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-115-6"><a id="__codelineno-115-6" name="__codelineno-115-6" href="#__codelineno-115-6"></a>
</span><span id="__span-115-7"><a id="__codelineno-115-7" name="__codelineno-115-7" href="#__codelineno-115-7"></a><span class="w">    </span><span class="c1">// ...</span>
</span><span id="__span-115-8"><a id="__codelineno-115-8" name="__codelineno-115-8" href="#__codelineno-115-8"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_argexpected"><span class="subsection"><code>luaL_argexpected</code></span><a class="headerlink" href="#lual_argexpected" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>l_noret luaL_argexpected(lua_State* L, int cond, int narg, const char* tname)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>cond</code>: Condition</li>
<li><code>narg</code>: Argument number</li>
<li><code>tname</code>: Type name</li>
</ul>
<p>Throws a Luau error with a templated error message for an incorrect type. This is similar to <code>luaL_typeerror</code>, except it encapsulates a condition, similar to an assertion.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">send_table</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-116-2"><a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a><span class="w">    </span><span class="c1">// expects a table as the first argument</span>
</span><span id="__span-116-3"><a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a><span class="w">    </span><span class="n">luaL_argexpected</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lua_istable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;table&quot;</span><span class="p">);</span>
</span><span id="__span-116-4"><a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a>
</span><span id="__span-116-5"><a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a><span class="w">    </span><span class="c1">// ...</span>
</span><span id="__span-116-6"><a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_argerror"><span class="subsection"><code>luaL_argerror</code></span><a class="headerlink" href="#lual_argerror" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>l_noret luaL_argerror(lua_State* L, int narg, const char* extramsg)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>narg</code>: Argument number</li>
<li><code>extramsg</code>: Extra message</li>
</ul>
<p>Throws a Luau error with a templated error message for an incorrect argument.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">divide</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-117-2"><a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">numerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-117-3"><a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">denominator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-117-4"><a id="__codelineno-117-4" name="__codelineno-117-4" href="#__codelineno-117-4"></a>
</span><span id="__span-117-5"><a id="__codelineno-117-5" name="__codelineno-117-5" href="#__codelineno-117-5"></a><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">denominator</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-117-6"><a id="__codelineno-117-6" name="__codelineno-117-6" href="#__codelineno-117-6"></a><span class="hll"><span class="w">        </span><span class="n">luaL_argerror</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cannot divide by zero&quot;</span><span class="p">);</span>
</span></span><span id="__span-117-7"><a id="__codelineno-117-7" name="__codelineno-117-7" href="#__codelineno-117-7"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span></span><span id="__span-117-8"><a id="__codelineno-117-8" name="__codelineno-117-8" href="#__codelineno-117-8"></a>
</span><span id="__span-117-9"><a id="__codelineno-117-9" name="__codelineno-117-9" href="#__codelineno-117-9"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">numerator</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">denominator</span><span class="p">);</span>
</span><span id="__span-117-10"><a id="__codelineno-117-10" name="__codelineno-117-10" href="#__codelineno-117-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-117-11"><a id="__codelineno-117-11" name="__codelineno-117-11" href="#__codelineno-117-11"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_argcheck"><span class="subsection"><code>luaL_argcheck</code></span><a class="headerlink" href="#lual_argcheck" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>l_noret luaL_argcheck(lua_State* L, int cond, int narg, const char* extramsg)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>cond</code>: Condition</li>
<li><code>narg</code>: Argument number</li>
<li><code>extramsg</code>: Extra message</li>
</ul>
<p>Throws a Luau error with a templated error message for an incorrect argument. This is similar to <code>luaL_argerror</code>, except it encapsulates a condition, similar to an assertion.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">divide</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-118-2"><a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">numerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-118-3"><a id="__codelineno-118-3" name="__codelineno-118-3" href="#__codelineno-118-3"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">denominator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checknumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</span><span id="__span-118-4"><a id="__codelineno-118-4" name="__codelineno-118-4" href="#__codelineno-118-4"></a>
</span><span id="__span-118-5"><a id="__codelineno-118-5" name="__codelineno-118-5" href="#__codelineno-118-5"></a><span class="hll"><span class="w">    </span><span class="n">luaL_argcheck</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">denominator</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cannot divide by zero&quot;</span><span class="p">);</span>
</span></span><span id="__span-118-6"><a id="__codelineno-118-6" name="__codelineno-118-6" href="#__codelineno-118-6"></a>
</span><span id="__span-118-7"><a id="__codelineno-118-7" name="__codelineno-118-7" href="#__codelineno-118-7"></a><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">numerator</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">denominator</span><span class="p">);</span>
</span><span id="__span-118-8"><a id="__codelineno-118-8" name="__codelineno-118-8" href="#__codelineno-118-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-118-9"><a id="__codelineno-118-9" name="__codelineno-118-9" href="#__codelineno-118-9"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="miscellaneous-functions">Miscellaneous Functions<a class="headerlink" href="#miscellaneous-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_next"><span class="subsection"><code>lua_next</code></span><a class="headerlink" href="#lua_next" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_next(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-1, +(2|0), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>The <code>lua_next</code> function is used to get the next key/pair value in a table, and thus is typically used to iterate a table. Note that <a href="#lua_rawiter"><code>lua_rawiter</code></a> is a faster and preferable way of iterating a table.</p>
<p>This function pops a key from the top of the stack and pushes two values: the next key and value in the table. The table is located at the provided <code>idx</code> position on the stack. If there are no more items next within the table, then nothing is pushed to the stack and the function returns <code>0</code>.</p>
<p>To get the first key/value pair in a table, use <code>nil</code> as the first key.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a><span class="c1">// Assume a table is at the top of the stack</span>
</span><span id="__span-119-2"><a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a>
</span><span id="__span-119-3"><a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">L</span><span class="p">);</span><span class="w"> </span><span class="c1">// First key is nil to indicate we want the first key/value pair from the table</span>
</span><span id="__span-119-4"><a id="__codelineno-119-4" name="__codelineno-119-4" href="#__codelineno-119-4"></a><span class="hll"><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// -2 is the stack index for the table</span>
</span></span><span id="__span-119-5"><a id="__codelineno-119-5" name="__codelineno-119-5" href="#__codelineno-119-5"></a><span class="w">    </span><span class="c1">// Key is now at index -2</span>
</span><span id="__span-119-6"><a id="__codelineno-119-6" name="__codelineno-119-6" href="#__codelineno-119-6"></a><span class="w">    </span><span class="c1">// Value is now at index -1</span>
</span><span id="__span-119-7"><a id="__codelineno-119-7" name="__codelineno-119-7" href="#__codelineno-119-7"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">),</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span>
</span><span id="__span-119-8"><a id="__codelineno-119-8" name="__codelineno-119-8" href="#__codelineno-119-8"></a>
</span><span id="__span-119-9"><a id="__codelineno-119-9" name="__codelineno-119-9" href="#__codelineno-119-9"></a><span class="w">    </span><span class="c1">// Remove &#39;Value&#39; from the stack, leaving only the Key, which is used</span>
</span><span id="__span-119-10"><a id="__codelineno-119-10" name="__codelineno-119-10" href="#__codelineno-119-10"></a><span class="w">    </span><span class="c1">// within the next iteration of the loop, and thus is fed back into</span>
</span><span id="__span-119-11"><a id="__codelineno-119-11" name="__codelineno-119-11" href="#__codelineno-119-11"></a><span class="w">    </span><span class="c1">// the lua_next function.</span>
</span><span id="__span-119-12"><a id="__codelineno-119-12" name="__codelineno-119-12" href="#__codelineno-119-12"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-119-13"><a id="__codelineno-119-13" name="__codelineno-119-13" href="#__codelineno-119-13"></a><span class="p">}</span>
</span><span id="__span-119-14"><a id="__codelineno-119-14" name="__codelineno-119-14" href="#__codelineno-119-14"></a>
</span><span id="__span-119-15"><a id="__codelineno-119-15" name="__codelineno-119-15" href="#__codelineno-119-15"></a><span class="c1">// Nothing to clean up here, as lua_next consumed the keys given. If we happened</span>
</span><span id="__span-119-16"><a id="__codelineno-119-16" name="__codelineno-119-16" href="#__codelineno-119-16"></a><span class="c1">// to break out of the loop early, we would need to pop the key/value items.</span>
</span><span id="__span-119-17"><a id="__codelineno-119-17" name="__codelineno-119-17" href="#__codelineno-119-17"></a>
</span><span id="__span-119-18"><a id="__codelineno-119-18" name="__codelineno-119-18" href="#__codelineno-119-18"></a><span class="c1">// In this example, the table is once again at the top of the stack here.</span>
</span></code></pre></div>
<p>The <code>lua_next</code> function can also be used to check if a Luau table is empty. Luau tables can be both arrays and dictionaries, but the <code>lua_objlen</code> function will only count the size of the array portion of the table. Thus, <code>lua_objlen</code> might return <code>0</code> even if the dictionary portion of the array has items. If given a <code>nil</code> key, <code>lua_next</code> will only return <code>0</code> if both the array and dictionary portion of the table are empty.</p>
<div class="language-cpp highlight"><span class="filename">Empty Example</span><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="kt">bool</span><span class="w"> </span><span class="nf">is_table_empty</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-120-2"><a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a><span class="w">    </span><span class="c1">// User may provide a negative index to the desired table, but we need</span>
</span><span id="__span-120-3"><a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a><span class="w">    </span><span class="c1">// to manipulate the stack, so we can use lua_absindex to get the absolute</span>
</span><span id="__span-120-4"><a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a><span class="w">    </span><span class="c1">// index of the table, which will remain stable as we change the stack:</span>
</span><span id="__span-120-5"><a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">abs_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_absindex</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
</span><span id="__span-120-6"><a id="__codelineno-120-6" name="__codelineno-120-6" href="#__codelineno-120-6"></a>
</span><span id="__span-120-7"><a id="__codelineno-120-7" name="__codelineno-120-7" href="#__codelineno-120-7"></a><span class="w">    </span><span class="n">lua_pushnil</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-120-8"><a id="__codelineno-120-8" name="__codelineno-120-8" href="#__codelineno-120-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_next</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">abs_idx</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-120-9"><a id="__codelineno-120-9" name="__codelineno-120-9" href="#__codelineno-120-9"></a><span class="w">        </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Pop the key/value pair produced by lua_next</span>
</span><span id="__span-120-10"><a id="__codelineno-120-10" name="__codelineno-120-10" href="#__codelineno-120-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-120-11"><a id="__codelineno-120-11" name="__codelineno-120-11" href="#__codelineno-120-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-120-12"><a id="__codelineno-120-12" name="__codelineno-120-12" href="#__codelineno-120-12"></a>
</span><span id="__span-120-13"><a id="__codelineno-120-13" name="__codelineno-120-13" href="#__codelineno-120-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-120-14"><a id="__codelineno-120-14" name="__codelineno-120-14" href="#__codelineno-120-14"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_rawiter"><span class="subsection"><code>lua_rawiter</code></span><a class="headerlink" href="#lua_rawiter" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_rawiter(lua_State* L, int idx, int iter)</code></span>
<span class="stack"><code>[-0, +(0|2), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>iter</code>: Iterator</li>
</ul>
<p>Allows for iterating over a Luau table. This iterates over both the array and dictionary portions of the table. The <code>idx</code> argument is the stack index of the table. The <code>iter</code> argument is the previous index provided by <code>lua_rawiter</code> (or <code>0</code> for the initial call). See the example below to see how to use this function within a standard for-loop.</p>
<p>The current implementation will iterate over the array portion first, followed by the dictionary portion. However, implementation details are not reliable, and any code should not assume this order will always be the same.</p>
<p><strong>Note:</strong> The returned value of <code>lua_rawiter</code> cannot be used to index directly into the table itself (e.g. <code>lua_rawgeti</code>). Instead, the <code>lua_rawiter</code> function will push the key/value pair onto the stack. These values should both be popped before iterating again.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="c1">// Assume a table is at the top of the stack</span>
</span><span id="__span-121-2"><a id="__codelineno-121-2" name="__codelineno-121-2" href="#__codelineno-121-2"></a>
</span><span id="__span-121-3"><a id="__codelineno-121-3" name="__codelineno-121-3" href="#__codelineno-121-3"></a><span class="c1">// Note the somewhat different for-loop setup, assigning and checking the index</span>
</span><span id="__span-121-4"><a id="__codelineno-121-4" name="__codelineno-121-4" href="#__codelineno-121-4"></a><span class="c1">// within the condition check of the loop, and no update expression is used:</span>
</span><span id="__span-121-5"><a id="__codelineno-121-5" name="__codelineno-121-5" href="#__codelineno-121-5"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_rawiter</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">),</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-121-6"><a id="__codelineno-121-6" name="__codelineno-121-6" href="#__codelineno-121-6"></a><span class="w">    </span><span class="c1">// Key is at stack index -2</span>
</span><span id="__span-121-7"><a id="__codelineno-121-7" name="__codelineno-121-7" href="#__codelineno-121-7"></a><span class="w">    </span><span class="c1">// Value is at stack index -1</span>
</span><span id="__span-121-8"><a id="__codelineno-121-8" name="__codelineno-121-8" href="#__codelineno-121-8"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s:%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">),</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span>
</span><span id="__span-121-9"><a id="__codelineno-121-9" name="__codelineno-121-9" href="#__codelineno-121-9"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Pop the key and value</span>
</span><span id="__span-121-10"><a id="__codelineno-121-10" name="__codelineno-121-10" href="#__codelineno-121-10"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_concat"><span class="subsection"><code>lua_concat</code></span><a class="headerlink" href="#lua_concat" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_concat(lua_State* L, int n)</code></span>
<span class="stack"><code>[-n, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>n</code>: Number of values</li>
</ul>
<p>Performs string concatenation on the <code>n</code> values on the top of the stack. All <code>n</code> values are popped, and the resultant string is pushed to the stack. If <code>n</code> is <code>1</code>, this function does nothing. If <code>n</code> is <code>0</code>, an empty string is pushed to the stack. For all other values of <code>n</code> (assuming &gt;= 2), all values are popped and concatenated into a string.</p>
<hr />
<h3 id="lua_encodepointer"><span class="subsection"><code>lua_encodepointer</code></span><a class="headerlink" href="#lua_encodepointer" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>uintptr_t lua_encodepointer(lua_State* L, uintptr_t p)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>p</code>: Pointer</li>
</ul>
<p>Encodes a pointer.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_topointer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-122-3"><a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a><span class="hll"><span class="kt">uintptr_t</span><span class="w"> </span><span class="n">encoded_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_encodepointer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="kt">uintptr_t</span><span class="p">(</span><span class="n">ptr</span><span class="p">));</span>
</span></span><span id="__span-122-4"><a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Pointer: 0x%016llx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">encoded_ptr</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_clock"><span class="subsection"><code>lua_clock</code></span><a class="headerlink" href="#lua_clock" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>double lua_clock()</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<p>Returns high-precision timestamp in seconds from the OS. This is exactly what the Luau library function <code>os.clock</code> uses. Here is the OS Clock function implementation:</p>
<div class="language-cpp highlight"><span class="filename">example</span><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="c1">// Copied from luau/VM/src/loslib.cpp</span>
</span><span id="__span-123-2"><a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">os_clock</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-123-3"><a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a><span class="hll"><span class="w">    </span><span class="n">lua_pushnumber</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">lua_clock</span><span class="p">());</span>
</span></span><span id="__span-123-4"><a id="__codelineno-123-4" name="__codelineno-123-4" href="#__codelineno-123-4"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-123-5"><a id="__codelineno-123-5" name="__codelineno-123-5" href="#__codelineno-123-5"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_clonefunction"><span class="subsection"><code>lua_clonefunction</code></span><a class="headerlink" href="#lua_clonefunction" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_clonefunction(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Clones a Luau function at the given index and pushes the cloned function to the top of the stack.</p>
<hr />
<h3 id="lua_cleartable"><span class="subsection"><code>lua_cleartable</code></span><a class="headerlink" href="#lua_cleartable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_cleartable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Clears the table at the given index. The internal table capacity does not shrink by default (tables can be configured to shrink by setting <code>__mode = "s"</code> on a table's metatable, but only do this if necessary).</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a><span class="c1">// Create a table with 10 numbers:</span>
</span><span id="__span-124-2"><a id="__codelineno-124-2" name="__codelineno-124-2" href="#__codelineno-124-2"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-124-3"><a id="__codelineno-124-3" name="__codelineno-124-3" href="#__codelineno-124-3"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-124-4"><a id="__codelineno-124-4" name="__codelineno-124-4" href="#__codelineno-124-4"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-124-5"><a id="__codelineno-124-5" name="__codelineno-124-5" href="#__codelineno-124-5"></a><span class="w">    </span><span class="n">lua_rawseti</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"> </span><span class="c1">// t[i] = i</span>
</span><span id="__span-124-6"><a id="__codelineno-124-6" name="__codelineno-124-6" href="#__codelineno-124-6"></a><span class="p">}</span>
</span><span id="__span-124-7"><a id="__codelineno-124-7" name="__codelineno-124-7" href="#__codelineno-124-7"></a>
</span><span id="__span-124-8"><a id="__codelineno-124-8" name="__codelineno-124-8" href="#__codelineno-124-8"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Length: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span><span class="w"> </span><span class="c1">// Length: 10</span>
</span><span id="__span-124-9"><a id="__codelineno-124-9" name="__codelineno-124-9" href="#__codelineno-124-9"></a>
</span><span id="__span-124-10"><a id="__codelineno-124-10" name="__codelineno-124-10" href="#__codelineno-124-10"></a><span class="hll"><span class="n">lua_cleartable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span></span><span id="__span-124-11"><a id="__codelineno-124-11" name="__codelineno-124-11" href="#__codelineno-124-11"></a>
</span><span id="__span-124-12"><a id="__codelineno-124-12" name="__codelineno-124-12" href="#__codelineno-124-12"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Length: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span><span class="w"> </span><span class="c1">// Length: 0</span>
</span></code></pre></div>
<hr />
<h3 id="lua_clonetable"><span class="subsection"><code>lua_clonetable</code></span><a class="headerlink" href="#lua_clonetable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_clonetable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Creates a shallow copy of the table at <code>idx</code> on the stack. The copied table is pushed to the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="c1">// Create a table with 10 numbers:</span>
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-125-3"><a id="__codelineno-125-3" name="__codelineno-125-3" href="#__codelineno-125-3"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-125-4"><a id="__codelineno-125-4" name="__codelineno-125-4" href="#__codelineno-125-4"></a><span class="w">    </span><span class="n">lua_pushinteger</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-125-5"><a id="__codelineno-125-5" name="__codelineno-125-5" href="#__codelineno-125-5"></a><span class="w">    </span><span class="n">lua_rawseti</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"> </span><span class="c1">// t[i] = i</span>
</span><span id="__span-125-6"><a id="__codelineno-125-6" name="__codelineno-125-6" href="#__codelineno-125-6"></a><span class="p">}</span>
</span><span id="__span-125-7"><a id="__codelineno-125-7" name="__codelineno-125-7" href="#__codelineno-125-7"></a>
</span><span id="__span-125-8"><a id="__codelineno-125-8" name="__codelineno-125-8" href="#__codelineno-125-8"></a><span class="c1">// Clone the table:</span>
</span><span id="__span-125-9"><a id="__codelineno-125-9" name="__codelineno-125-9" href="#__codelineno-125-9"></a><span class="hll"><span class="n">lua_clonetable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span></span><span id="__span-125-10"><a id="__codelineno-125-10" name="__codelineno-125-10" href="#__codelineno-125-10"></a>
</span><span id="__span-125-11"><a id="__codelineno-125-11" name="__codelineno-125-11" href="#__codelineno-125-11"></a><span class="c1">// Clear the original table:</span>
</span><span id="__span-125-12"><a id="__codelineno-125-12" name="__codelineno-125-12" href="#__codelineno-125-12"></a><span class="n">lua_cleartable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">);</span>
</span><span id="__span-125-13"><a id="__codelineno-125-13" name="__codelineno-125-13" href="#__codelineno-125-13"></a>
</span><span id="__span-125-14"><a id="__codelineno-125-14" name="__codelineno-125-14" href="#__codelineno-125-14"></a><span class="c1">// Show that they have different lengths:</span>
</span><span id="__span-125-15"><a id="__codelineno-125-15" name="__codelineno-125-15" href="#__codelineno-125-15"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Length Original: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">));</span><span class="w"> </span><span class="c1">// Length Original: 0</span>
</span><span id="__span-125-16"><a id="__codelineno-125-16" name="__codelineno-125-16" href="#__codelineno-125-16"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Length Clone: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lua_objlen</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">));</span><span class="w"> </span><span class="c1">// Length Clone: 10</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getallocf"><span class="subsection"><code>lua_getallocf</code></span><a class="headerlink" href="#lua_getallocf" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_Alloc lua_getallocf(lua_State* L, void** ud)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>ud</code>: Userdata</li>
</ul>
<p>Returns the memory allocator function, and writes the the opaque userdata pointer. These are the values that were originally passed to <code>lua_newstate</code>.</p>
<p><strong>Note:</strong> <code>ud</code> is only written if the value was provided as non-null to <code>lua_newstate</code>. Beware of garbage values.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ud</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="c1">// Note: explicitly initalized as nullptr</span>
</span><span id="__span-126-2"><a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a><span class="n">lua_Alloc</span><span class="w"> </span><span class="n">alloc_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_getallocf</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ud</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lua_callbacks"><span class="subsection"><code>lua_callbacks</code></span><a class="headerlink" href="#lua_callbacks" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>lua_Callbacks* lua_callbacks(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Allows users to install callback functions for various purposes.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-127-1"><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a><span class="c1">// Handle Luau panics (only when Luau is built with longjmp, not C++ exceptions)</span>
</span><span id="__span-127-2"><a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handle_panic</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">errcode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-127-3"><a id="__codelineno-127-3" name="__codelineno-127-3" href="#__codelineno-127-3"></a><span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;luau panic: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errcode</span><span class="p">);</span>
</span><span id="__span-127-4"><a id="__codelineno-127-4" name="__codelineno-127-4" href="#__codelineno-127-4"></a><span class="p">}</span>
</span><span id="__span-127-5"><a id="__codelineno-127-5" name="__codelineno-127-5" href="#__codelineno-127-5"></a>
</span><span id="__span-127-6"><a id="__codelineno-127-6" name="__codelineno-127-6" href="#__codelineno-127-6"></a><span class="c1">// Called when thread &#39;L&#39; is created or destroyed, denoted if LP (L parent) exists or is null</span>
</span><span id="__span-127-7"><a id="__codelineno-127-7" name="__codelineno-127-7" href="#__codelineno-127-7"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handle_user_thread</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">LP</span><span class="p">,</span><span class="w"> </span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-127-8"><a id="__codelineno-127-8" name="__codelineno-127-8" href="#__codelineno-127-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">LP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-127-9"><a id="__codelineno-127-9" name="__codelineno-127-9" href="#__codelineno-127-9"></a><span class="w">        </span><span class="c1">// L was destroyed</span>
</span><span id="__span-127-10"><a id="__codelineno-127-10" name="__codelineno-127-10" href="#__codelineno-127-10"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-127-11"><a id="__codelineno-127-11" name="__codelineno-127-11" href="#__codelineno-127-11"></a><span class="w">        </span><span class="c1">// L was created</span>
</span><span id="__span-127-12"><a id="__codelineno-127-12" name="__codelineno-127-12" href="#__codelineno-127-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-127-13"><a id="__codelineno-127-13" name="__codelineno-127-13" href="#__codelineno-127-13"></a><span class="p">}</span>
</span><span id="__span-127-14"><a id="__codelineno-127-14" name="__codelineno-127-14" href="#__codelineno-127-14"></a>
</span><span id="__span-127-15"><a id="__codelineno-127-15" name="__codelineno-127-15" href="#__codelineno-127-15"></a><span class="n">lua_callbacks</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">panic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handle_panic</span><span class="p">;</span>
</span><span id="__span-127-16"><a id="__codelineno-127-16" name="__codelineno-127-16" href="#__codelineno-127-16"></a><span class="n">lua_callbacks</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">userthread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handle_user_thread</span><span class="p">;</span>
</span><span id="__span-127-17"><a id="__codelineno-127-17" name="__codelineno-127-17" href="#__codelineno-127-17"></a><span class="c1">// ...</span>
</span></code></pre></div>
<hr />
<h3 id="lual_findtable"><span class="subsection"><code>luaL_findtable</code></span><a class="headerlink" href="#lual_findtable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_findtable(lua_State* L, int idx, const char* fname, int szhint)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>fname</code>: Name</li>
<li><code>szhint</code>: Size hint</li>
</ul>
<p>Attempts to find or create a table within the table at <code>idx</code>. Using dot-notation within <code>fname</code>, this can be a nested table. The <code>szhint</code> argument indicates how many slots should be allocated in the dictionary portion of the table (if a new table is created).</p>
<p>If there is a name conflict (i.e. a value exists with the provided name, but it isn't a table), then said name is returned. Otherwise, <code>NULL</code> is returned.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-128-1"><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a><span class="c1">// Pushes the table &quot;my_data&quot; under the Luau registry to the stack.</span>
</span><span id="__span-128-2"><a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a><span class="c1">// If the table doesn&#39;t exist yet, it is created.</span>
</span><span id="__span-128-3"><a id="__codelineno-128-3" name="__codelineno-128-3" href="#__codelineno-128-3"></a><span class="n">luaL_findtable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">LUA_REGISTRYINDEX</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-128-4"><a id="__codelineno-128-4" name="__codelineno-128-4" href="#__codelineno-128-4"></a>
</span><span id="__span-128-5"><a id="__codelineno-128-5" name="__codelineno-128-5" href="#__codelineno-128-5"></a><span class="c1">// Finds table &quot;another&quot; within the hierarchy (and creates each parent table as needed)</span>
</span><span id="__span-128-6"><a id="__codelineno-128-6" name="__codelineno-128-6" href="#__codelineno-128-6"></a><span class="n">luaL_findtable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">LUA_REGISTRYINDEX</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mydata.subtable.another&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-128-7"><a id="__codelineno-128-7" name="__codelineno-128-7" href="#__codelineno-128-7"></a>
</span><span id="__span-128-8"><a id="__codelineno-128-8" name="__codelineno-128-8" href="#__codelineno-128-8"></a><span class="c1">// Same as above, except &quot;my_data&quot; is sourced from the new table provided.</span>
</span><span id="__span-128-9"><a id="__codelineno-128-9" name="__codelineno-128-9" href="#__codelineno-128-9"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-128-10"><a id="__codelineno-128-10" name="__codelineno-128-10" href="#__codelineno-128-10"></a><span class="n">luaL_findtable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my_data&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-128-11"><a id="__codelineno-128-11" name="__codelineno-128-11" href="#__codelineno-128-11"></a><span class="n">lua_pushliteral</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p">);</span>
</span><span id="__span-128-12"><a id="__codelineno-128-12" name="__codelineno-128-12" href="#__codelineno-128-12"></a><span class="n">lua_rawsetfield</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;message&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// mydata.message = &quot;hello&quot;</span>
</span><span id="__span-128-13"><a id="__codelineno-128-13" name="__codelineno-128-13" href="#__codelineno-128-13"></a>
</span><span id="__span-128-14"><a id="__codelineno-128-14" name="__codelineno-128-14" href="#__codelineno-128-14"></a><span class="c1">// Conflicts are returned (&quot;hello&quot; exists within &quot;my_data&quot; but isn&#39;t a table):</span>
</span><span id="__span-128-15"><a id="__codelineno-128-15" name="__codelineno-128-15" href="#__codelineno-128-15"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">conflict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_findtable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my_data.hello.nested&quot;</span><span class="p">);</span>
</span><span id="__span-128-16"><a id="__codelineno-128-16" name="__codelineno-128-16" href="#__codelineno-128-16"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">conflict</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-128-17"><a id="__codelineno-128-17" name="__codelineno-128-17" href="#__codelineno-128-17"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;name conflict: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">conflict</span><span class="p">)</span><span class="w"> </span><span class="c1">// &quot;name conflict: hello&quot;</span>
</span><span id="__span-128-18"><a id="__codelineno-128-18" name="__codelineno-128-18" href="#__codelineno-128-18"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checktype"><span class="subsection"><code>luaL_checktype</code></span><a class="headerlink" href="#lual_checktype" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_checktype(lua_State* L, int narg, int t)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>narg</code>: Argument number</li>
<li><code>t</code>: Luau type</li>
</ul>
<p>Asserts the type at the given index.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-129-1"><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">do_something</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-129-2"><a id="__codelineno-129-2" name="__codelineno-129-2" href="#__codelineno-129-2"></a><span class="w">    </span><span class="c1">// Assert that the first argument is a table:</span>
</span><span id="__span-129-3"><a id="__codelineno-129-3" name="__codelineno-129-3" href="#__codelineno-129-3"></a><span class="w">    </span><span class="n">luaL_checktype</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">LUA_TTABLE</span><span class="p">);</span>
</span><span id="__span-129-4"><a id="__codelineno-129-4" name="__codelineno-129-4" href="#__codelineno-129-4"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkoption"><span class="subsection"><code>luaL_checkoption</code></span><a class="headerlink" href="#lual_checkoption" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_checkoption(lua_State* L, int idx, const char* def, const char* const lst[])</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
<li><code>def</code>: Default option</li>
<li><code>lst[]</code>: Options list</li>
</ul>
<p>Asserts the value at the given index is a string within the given options list <code>lst</code>. If <code>def</code> is provided (non-null), then <code>def</code> will be used as the default option if the value at the given stack index is nil or none. If the assertion passes, the index to the item in the list is returned.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-130-1"><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">set_mode</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-130-2"><a id="__codelineno-130-2" name="__codelineno-130-2" href="#__codelineno-130-2"></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">options</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;follow&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;defend&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;attack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;flee&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">};</span>
</span><span id="__span-130-3"><a id="__codelineno-130-3" name="__codelineno-130-3" href="#__codelineno-130-3"></a>
</span><span id="__span-130-4"><a id="__codelineno-130-4" name="__codelineno-130-4" href="#__codelineno-130-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checkoption</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">options</span><span class="p">);</span>
</span><span id="__span-130-5"><a id="__codelineno-130-5" name="__codelineno-130-5" href="#__codelineno-130-5"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">options</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span id="__span-130-6"><a id="__codelineno-130-6" name="__codelineno-130-6" href="#__codelineno-130-6"></a><span class="w">    </span><span class="c1">// ...</span>
</span><span id="__span-130-7"><a id="__codelineno-130-7" name="__codelineno-130-7" href="#__codelineno-130-7"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_checkany"><span class="subsection"><code>luaL_checkany</code></span><a class="headerlink" href="#lual_checkany" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_checkany(lua_State* L, int narg)</code></span>
<span class="stack"><code>[-0, +0, m]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>narg</code>: Argument number</li>
</ul>
<p>Asserts the value at the given index is any value (including <code>nil</code>). In other words, this asserts that the value is not none.</p>
<hr />
<h3 id="lual_register"><span class="subsection"><code>luaL_register</code></span><a class="headerlink" href="#lual_register" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int luaL_register(lua_State* L, const char* libname, const luaL_Reg* l)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>libname</code>: Library name</li>
<li><code>l</code>: Functions</li>
</ul>
<p>Registers a library (i.e. a collection of functions within their own namespace). Internally, this is just a table of functions mapped by their associated key from <code>l</code>.</p>
<p>If <code>libname</code> is not null, the library is placed in the Luau registry and the new library table is pushed to the stack. Any Luau code will be able to access the library by name.</p>
<p>If <code>libname</code> is null, the function assumes a table is at the top of the stack, and will register all functions into that table.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-131-1"><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a><span class="c1">// Library functions:</span>
</span><span id="__span-131-2"><a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">do_this</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-131-3"><a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">do_that</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-131-4"><a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a>
</span><span id="__span-131-5"><a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a><span class="c1">// Define library key/pairs:</span>
</span><span id="__span-131-6"><a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a><span class="hll"><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">luaL_Reg</span><span class="w"> </span><span class="n">foo_lib</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-131-7"><a id="__codelineno-131-7" name="__codelineno-131-7" href="#__codelineno-131-7"></a><span class="hll"><span class="w">    </span><span class="c1">// {Name, C Function}</span>
</span></span><span id="__span-131-8"><a id="__codelineno-131-8" name="__codelineno-131-8" href="#__codelineno-131-8"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="s">&quot;dothis&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">do_this</span><span class="p">},</span>
</span></span><span id="__span-131-9"><a id="__codelineno-131-9" name="__codelineno-131-9" href="#__codelineno-131-9"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="s">&quot;dothat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">do_that</span><span class="p">},</span>
</span></span><span id="__span-131-10"><a id="__codelineno-131-10" name="__codelineno-131-10" href="#__codelineno-131-10"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">},</span><span class="w"> </span><span class="c1">// End of list is denoted by null pair</span>
</span></span><span id="__span-131-11"><a id="__codelineno-131-11" name="__codelineno-131-11" href="#__codelineno-131-11"></a><span class="hll"><span class="p">};</span>
</span></span><span id="__span-131-12"><a id="__codelineno-131-12" name="__codelineno-131-12" href="#__codelineno-131-12"></a>
</span><span id="__span-131-13"><a id="__codelineno-131-13" name="__codelineno-131-13" href="#__codelineno-131-13"></a><span class="kt">void</span><span class="w"> </span><span class="nf">open_foo</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-131-14"><a id="__codelineno-131-14" name="__codelineno-131-14" href="#__codelineno-131-14"></a><span class="hll"><span class="w">    </span><span class="n">luaL_register</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo_lib</span><span class="p">);</span>
</span></span><span id="__span-131-15"><a id="__codelineno-131-15" name="__codelineno-131-15" href="#__codelineno-131-15"></a><span class="w">    </span><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c1">// luaL_register had left our library on the stack</span>
</span><span id="__span-131-16"><a id="__codelineno-131-16" name="__codelineno-131-16" href="#__codelineno-131-16"></a><span class="p">}</span>
</span></code></pre></div>
<div class="language-luau highlight"><span class="filename">Luau Example</span><pre><span></span><code><span id="__span-132-1"><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a><span class="c1">-- Luau can now access &quot;foo&quot;:</span>
</span><span id="__span-132-2"><a id="__codelineno-132-2" name="__codelineno-132-2" href="#__codelineno-132-2"></a><span class="nv">foo</span><span class="p">.</span><span class="nf">dothis</span><span class="p">()</span>
</span><span id="__span-132-3"><a id="__codelineno-132-3" name="__codelineno-132-3" href="#__codelineno-132-3"></a><span class="nv">foo</span><span class="p">.</span><span class="nf">dothat</span><span class="p">()</span>
</span></code></pre></div>
<p>Alternatively, <code>luaL_register</code> can be used to write the functions to an already-existing table. For instance, a metatable:
<div class="language-cpp highlight"><span class="filename">Example Metatable</span><pre><span></span><code><span id="__span-133-1"><a id="__codelineno-133-1" name="__codelineno-133-1" href="#__codelineno-133-1"></a><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">kFooTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-133-2"><a id="__codelineno-133-2" name="__codelineno-133-2" href="#__codelineno-133-2"></a>
</span><span id="__span-133-3"><a id="__codelineno-133-3" name="__codelineno-133-3" href="#__codelineno-133-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">Foo</span><span class="w"> </span><span class="p">{};</span>
</span><span id="__span-133-4"><a id="__codelineno-133-4" name="__codelineno-133-4" href="#__codelineno-133-4"></a>
</span><span id="__span-133-5"><a id="__codelineno-133-5" name="__codelineno-133-5" href="#__codelineno-133-5"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Foo_index</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-133-6"><a id="__codelineno-133-6" name="__codelineno-133-6" href="#__codelineno-133-6"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Foo_newindex</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-133-7"><a id="__codelineno-133-7" name="__codelineno-133-7" href="#__codelineno-133-7"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">Foo_tostring</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-133-8"><a id="__codelineno-133-8" name="__codelineno-133-8" href="#__codelineno-133-8"></a>
</span><span id="__span-133-9"><a id="__codelineno-133-9" name="__codelineno-133-9" href="#__codelineno-133-9"></a><span class="hll"><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">luaL_Reg</span><span class="w"> </span><span class="n">foo_mt</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-133-10"><a id="__codelineno-133-10" name="__codelineno-133-10" href="#__codelineno-133-10"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="s">&quot;__index&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_index</span><span class="p">},</span>
</span></span><span id="__span-133-11"><a id="__codelineno-133-11" name="__codelineno-133-11" href="#__codelineno-133-11"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="s">&quot;__newindex&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_newindex</span><span class="p">},</span>
</span></span><span id="__span-133-12"><a id="__codelineno-133-12" name="__codelineno-133-12" href="#__codelineno-133-12"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="s">&quot;__tostring&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Foo_tostring</span><span class="p">},</span>
</span></span><span id="__span-133-13"><a id="__codelineno-133-13" name="__codelineno-133-13" href="#__codelineno-133-13"></a><span class="hll"><span class="w">    </span><span class="p">{</span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">},</span>
</span></span><span id="__span-133-14"><a id="__codelineno-133-14" name="__codelineno-133-14" href="#__codelineno-133-14"></a><span class="hll"><span class="p">};</span>
</span></span><span id="__span-133-15"><a id="__codelineno-133-15" name="__codelineno-133-15" href="#__codelineno-133-15"></a>
</span><span id="__span-133-16"><a id="__codelineno-133-16" name="__codelineno-133-16" href="#__codelineno-133-16"></a><span class="kt">void</span><span class="w"> </span><span class="nf">Foo_setup_metatable</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-133-17"><a id="__codelineno-133-17" name="__codelineno-133-17" href="#__codelineno-133-17"></a><span class="w">    </span><span class="n">luaL_newmetatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Foo&quot;</span><span class="p">);</span>
</span><span id="__span-133-18"><a id="__codelineno-133-18" name="__codelineno-133-18" href="#__codelineno-133-18"></a><span class="hll"><span class="w">    </span><span class="n">luaL_register</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">foo_mt</span><span class="p">);</span>
</span></span><span id="__span-133-19"><a id="__codelineno-133-19" name="__codelineno-133-19" href="#__codelineno-133-19"></a><span class="w">    </span><span class="n">lua_setuserdatametatable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">kFooTag</span><span class="p">);</span>
</span><span id="__span-133-20"><a id="__codelineno-133-20" name="__codelineno-133-20" href="#__codelineno-133-20"></a><span class="p">}</span>
</span></code></pre></div></p>
<hr />
<h2 id="ref-functions">Ref Functions<a class="headerlink" href="#ref-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_ref"><span class="subsection"><code>lua_ref</code></span><a class="headerlink" href="#lua_ref" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_ref(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Creates a reference to the given Luau value at <code>idx</code> on the stack. The returned integer can be seen as an opaque handle to the value. Creating a reference is also an easy way to pin a Luau value, preventing it from being GC'd. A reference can be created for any value on the stack. Attempting to create a reference to a nil value will return <code>LUA_REFNIL</code>.</p>
<p>Be sure to call <a href="#lua_unref"><code>lua_unref</code></a> when done with the reference. Call <a href="#lua_getref"><code>lua_getref</code></a> to retrieve the referenced value.</p>
<p><strong>Note:</strong> Unlike in Lua, Luau does <em>not</em> modify the stack when creating a reference. The stack remains the same.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-134-1"><a id="__codelineno-134-1" name="__codelineno-134-1" href="#__codelineno-134-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-134-2"><a id="__codelineno-134-2" name="__codelineno-134-2" href="#__codelineno-134-2"></a><span class="hll"><span class="kt">int</span><span class="w"> </span><span class="n">table_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_ref</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span></span><span id="__span-134-3"><a id="__codelineno-134-3" name="__codelineno-134-3" href="#__codelineno-134-3"></a><span class="n">lua_pop</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-134-4"><a id="__codelineno-134-4" name="__codelineno-134-4" href="#__codelineno-134-4"></a><span class="c1">// GC won&#39;t clean up the table, even though it was popped, becase a reference</span>
</span><span id="__span-134-5"><a id="__codelineno-134-5" name="__codelineno-134-5" href="#__codelineno-134-5"></a><span class="c1">// has been created for the table.</span>
</span></code></pre></div>
<hr />
<h3 id="lua_unref"><span class="subsection"><code>lua_unref</code></span><a class="headerlink" href="#lua_unref" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_unref(lua_State* L, int ref)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>ref</code>: Reference</li>
</ul>
<p>Removes a reference that was originally created with <code>lua_ref</code>. Passing in <code>LUA_REFNIL</code> or <code>LUA_NOREF</code> is allowed (in those cases, the function does nothing). However, passing in an already-removed reference is <em>not</em> allowed and may throw an error, or silently remove another reference. If idempotence is required, ensure your reference variable is set to <code>LUA_REFNIL</code> or <code>LUA_NOREF</code> after calling <code>lua_unref</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-135-1"><a id="__codelineno-135-1" name="__codelineno-135-1" href="#__codelineno-135-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-135-2"><a id="__codelineno-135-2" name="__codelineno-135-2" href="#__codelineno-135-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">table_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_ref</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-135-3"><a id="__codelineno-135-3" name="__codelineno-135-3" href="#__codelineno-135-3"></a>
</span><span id="__span-135-4"><a id="__codelineno-135-4" name="__codelineno-135-4" href="#__codelineno-135-4"></a><span class="c1">// Sometime later:</span>
</span><span id="__span-135-5"><a id="__codelineno-135-5" name="__codelineno-135-5" href="#__codelineno-135-5"></a><span class="hll"><span class="n">lua_unref</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">table_ref</span><span class="p">);</span>
</span></span></code></pre></div>
<hr />
<h3 id="lua_getref"><span class="subsection"><code>lua_getref</code></span><a class="headerlink" href="#lua_getref" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getref(lua_State* L, int ref)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>ref</code>: Reference</li>
</ul>
<p>Retrieves the value from a given reference handle. The value is pushed to the top of the stack.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-136-1"><a id="__codelineno-136-1" name="__codelineno-136-1" href="#__codelineno-136-1"></a><span class="n">lua_newtable</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-136-2"><a id="__codelineno-136-2" name="__codelineno-136-2" href="#__codelineno-136-2"></a><span class="kt">int</span><span class="w"> </span><span class="n">table_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_ref</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-136-3"><a id="__codelineno-136-3" name="__codelineno-136-3" href="#__codelineno-136-3"></a>
</span><span id="__span-136-4"><a id="__codelineno-136-4" name="__codelineno-136-4" href="#__codelineno-136-4"></a><span class="c1">// Sometime later:</span>
</span><span id="__span-136-5"><a id="__codelineno-136-5" name="__codelineno-136-5" href="#__codelineno-136-5"></a><span class="hll"><span class="n">lua_getref</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">table_ref</span><span class="p">);</span>
</span></span><span id="__span-136-6"><a id="__codelineno-136-6" name="__codelineno-136-6" href="#__codelineno-136-6"></a><span class="c1">// Top of stack is now the table from the reference</span>
</span></code></pre></div>
<hr />
<h2 id="type-functions">Type Functions<a class="headerlink" href="#type-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_isfunction"><span class="subsection"><code>lua_isfunction</code></span><a class="headerlink" href="#lua_isfunction" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isfunction(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a function.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-137-1"><a id="__codelineno-137-1" name="__codelineno-137-1" href="#__codelineno-137-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isfunction</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_istable"><span class="subsection"><code>lua_istable</code></span><a class="headerlink" href="#lua_istable" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_istable(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a table.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-138-1"><a id="__codelineno-138-1" name="__codelineno-138-1" href="#__codelineno-138-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_istable</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isnil"><span class="subsection"><code>lua_isnil</code></span><a class="headerlink" href="#lua_isnil" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isnil(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is nil.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-139-1"><a id="__codelineno-139-1" name="__codelineno-139-1" href="#__codelineno-139-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isnil</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isthread"><span class="subsection"><code>lua_isthread</code></span><a class="headerlink" href="#lua_isthread" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isthread(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is a thread.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-140-1"><a id="__codelineno-140-1" name="__codelineno-140-1" href="#__codelineno-140-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isthread</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isnone"><span class="subsection"><code>lua_isnone</code></span><a class="headerlink" href="#lua_isnone" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isnone(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is none.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-141-1"><a id="__codelineno-141-1" name="__codelineno-141-1" href="#__codelineno-141-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isnone</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_isnoneornil"><span class="subsection"><code>lua_isnoneornil</code></span><a class="headerlink" href="#lua_isnoneornil" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_isnoneornil(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Checks if the value at the given stack index is none or nil.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-142-1"><a id="__codelineno-142-1" name="__codelineno-142-1" href="#__codelineno-142-1"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_isnoneornil</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* ... */</span><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lual_typename"><span class="subsection"><code>luaL_typename</code></span><a class="headerlink" href="#lual_typename" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* luaL_typename(lua_State* L, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Returns the name of the type at the given index.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-143-1"><a id="__codelineno-143-1" name="__codelineno-143-1" href="#__codelineno-143-1"></a><span class="n">lua_pushvector</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">);</span>
</span><span id="__span-143-2"><a id="__codelineno-143-2" name="__codelineno-143-2" href="#__codelineno-143-2"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">t_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_typename</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
</span><span id="__span-143-3"><a id="__codelineno-143-3" name="__codelineno-143-3" href="#__codelineno-143-3"></a><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Type: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t_name</span><span class="p">);</span><span class="w"> </span><span class="c1">// &quot;Type: vector&quot;</span>
</span></code></pre></div>
<hr />
<h2 id="string-buffer-functions">String Buffer Functions<a class="headerlink" href="#string-buffer-functions" title="Permanent link">&para;</a></h2>
<h3 id="lual_buffinit"><span class="subsection"><code>luaL_buffinit</code></span><a class="headerlink" href="#lual_buffinit" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_buffinit(lua_State* L, luaL_Buffer* B)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>B</code>: Lua string buffer</li>
</ul>
<p>Initializes a string buffer.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-144-1"><a id="__codelineno-144-1" name="__codelineno-144-1" href="#__codelineno-144-1"></a><span class="n">luaL_Strbuf</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-144-2"><a id="__codelineno-144-2" name="__codelineno-144-2" href="#__codelineno-144-2"></a><span class="n">luaL_buffinit</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lual_buffinitsize"><span class="subsection"><code>luaL_buffinitsize</code></span><a class="headerlink" href="#lual_buffinitsize" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>char* luaL_buffinitsize(lua_State* L, luaL_Buffer* B, size_t size)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>B</code>: Lua string buffer</li>
<li><code>size</code>: Preallocated size</li>
</ul>
<p>Initializes a string buffer with an initial allocated size. A pointer to the start of the buffer is returned.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-145-1"><a id="__codelineno-145-1" name="__codelineno-145-1" href="#__codelineno-145-1"></a><span class="n">luaL_Strbuf</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-145-2"><a id="__codelineno-145-2" name="__codelineno-145-2" href="#__codelineno-145-2"></a><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_buffinitsize</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">512</span><span class="p">);</span>
</span></code></pre></div>
<hr />
<h3 id="lual_prepbuffsize"><span class="subsection"><code>luaL_prepbuffsize</code></span><a class="headerlink" href="#lual_prepbuffsize" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>char* luaL_prepbuffsize(luaL_Buffer* B, size_t size)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
<li><code>size</code>: Size extension</li>
</ul>
<p>Ensure the string buffer has at least <code>size</code> capacity available. For instance, if 10 characters need to be added to an existing string buffer, it may be more optimal to call <code>luaL_prepbuffsize(&amp;b, 10)</code> before adding each character.</p>
<hr />
<h3 id="lual_addchar"><span class="subsection"><code>luaL_addchar</code></span><a class="headerlink" href="#lual_addchar" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_addchar(luaL_Buffer* B, char c)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
<li><code>c</code>: Character</li>
</ul>
<p>Adds a character to a string buffer.</p>
<hr />
<h3 id="lual_addlstring"><span class="subsection"><code>luaL_addlstring</code></span><a class="headerlink" href="#lual_addlstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_addlstring(luaL_Buffer* B, const char* s, size_t l)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
<li><code>s</code>: String</li>
<li><code>l</code>: String length</li>
</ul>
<p>Adds a string to a string buffer.</p>
<hr />
<h3 id="lual_addstring"><span class="subsection"><code>luaL_addstring</code></span><a class="headerlink" href="#lual_addstring" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_addstring(luaL_Buffer* B, const char* s)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
<li><code>s</code>: String</li>
</ul>
<p>Adds a string to a string buffer. If the length of the string is known, use <code>luaL_addlstring</code> instead.</p>
<hr />
<h3 id="lual_addvalue"><span class="subsection"><code>luaL_addvalue</code></span><a class="headerlink" href="#lual_addvalue" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_addvalue(luaL_Buffer* B)</code></span>
<span class="stack"><code>[-1, +0, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
</ul>
<p>Pops a value from the top of the stack and adds it to the buffer.</p>
<hr />
<h3 id="lual_addvalueany"><span class="subsection"><code>luaL_addvalueany</code></span><a class="headerlink" href="#lual_addvalueany" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_addvalueany(luaL_Buffer* B, int idx)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
<li><code>idx</code>: Stack index</li>
</ul>
<p>Adds the value at the given stack index into the buffer. Unlike <code>luaL_addvalue</code>, this does <em>not</em> pop the item from the stack.</p>
<hr />
<h3 id="lual_pushresult"><span class="subsection"><code>luaL_pushresult</code></span><a class="headerlink" href="#lual_pushresult" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_pushresult(luaL_Buffer* B)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
</ul>
<p>Pushes the result of the string buffer onto the stack.</p>
<hr />
<h3 id="lual_pushresultsize"><span class="subsection"><code>luaL_pushresultsize</code></span><a class="headerlink" href="#lual_pushresultsize" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_pushresultsize(luaL_Buffer* B, size_t size)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>B</code>: Lua string buffer</li>
<li><code>size</code>: Size</li>
</ul>
<p>Pushes the result of the string buffer onto the stack, assuming <code>size</code> extra length on the buffer. This is only used if the buffer is being directly written rather than going through other string buffer functions that track the size.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-146-1"><a id="__codelineno-146-1" name="__codelineno-146-1" href="#__codelineno-146-1"></a><span class="c1">// Copied from luau/VM/src/lstrlib.cpp</span>
</span><span id="__span-146-2"><a id="__codelineno-146-2" name="__codelineno-146-2" href="#__codelineno-146-2"></a>
</span><span id="__span-146-3"><a id="__codelineno-146-3" name="__codelineno-146-3" href="#__codelineno-146-3"></a><span class="c1">// Note how the buffer is initialized to the correct size, but</span>
</span><span id="__span-146-4"><a id="__codelineno-146-4" name="__codelineno-146-4" href="#__codelineno-146-4"></a><span class="c1">// the buffer is being written to directly, rather than going</span>
</span><span id="__span-146-5"><a id="__codelineno-146-5" name="__codelineno-146-5" href="#__codelineno-146-5"></a><span class="c1">// through the `luaL_addchar` function.</span>
</span><span id="__span-146-6"><a id="__codelineno-146-6" name="__codelineno-146-6" href="#__codelineno-146-6"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">str_lower</span><span class="p">(</span><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-146-7"><a id="__codelineno-146-7" name="__codelineno-146-7" href="#__codelineno-146-7"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">;</span>
</span><span id="__span-146-8"><a id="__codelineno-146-8" name="__codelineno-146-8" href="#__codelineno-146-8"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_checklstring</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">l</span><span class="p">);</span>
</span><span id="__span-146-9"><a id="__codelineno-146-9" name="__codelineno-146-9" href="#__codelineno-146-9"></a><span class="hll"><span class="w">    </span><span class="n">luaL_Strbuf</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</span></span><span id="__span-146-10"><a id="__codelineno-146-10" name="__codelineno-146-10" href="#__codelineno-146-10"></a><span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">luaL_buffinitsize</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">);</span><span class="w"> </span><span class="c1">// buffer initialized</span>
</span><span id="__span-146-11"><a id="__codelineno-146-11" name="__codelineno-146-11" href="#__codelineno-146-11"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-146-12"><a id="__codelineno-146-12" name="__codelineno-146-12" href="#__codelineno-146-12"></a><span class="w">        </span><span class="o">*</span><span class="n">ptr</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tolower</span><span class="p">(</span><span class="n">uchar</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span><span class="w"> </span><span class="c1">// direct write</span>
</span><span id="__span-146-13"><a id="__codelineno-146-13" name="__codelineno-146-13" href="#__codelineno-146-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-146-14"><a id="__codelineno-146-14" name="__codelineno-146-14" href="#__codelineno-146-14"></a><span class="w">    </span><span class="n">luaL_pushresultsize</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">);</span><span class="w"> </span><span class="c1">// push result</span>
</span><span id="__span-146-15"><a id="__codelineno-146-15" name="__codelineno-146-15" href="#__codelineno-146-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-146-16"><a id="__codelineno-146-16" name="__codelineno-146-16" href="#__codelineno-146-16"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="debug-functions">Debug Functions<a class="headerlink" href="#debug-functions" title="Permanent link">&para;</a></h2>
<h3 id="lua_stackdepth"><span class="subsection"><code>lua_stackdepth</code></span><a class="headerlink" href="#lua_stackdepth" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_stackdepth(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Returns the current stack depth.</p>
<hr />
<h3 id="lua_getinfo"><span class="subsection"><code>lua_getinfo</code></span><a class="headerlink" href="#lua_getinfo" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getinfo(lua_State* L, int level, const char* what, lua_Debug* ar)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
<li><code>what</code>: Desired information</li>
<li><code>ar</code>: Debug info (activation record)</li>
</ul>
<p>Gets debug information for the given stack level. The characters in the <code>what</code> string indicate what information is desired.</p>
<p>The <code>what</code> string may contain:</p>
<ul>
<li><code>n</code>: Fills the <code>name</code> field</li>
<li><code>s</code>: Fills the <code>what</code>, <code>source</code>, <code>short_src</code>, and <code>linedefined</code> fields</li>
<li><code>l</code>: Fills the <code>currentline</code> field</li>
<li><code>u</code>: Fills the <code>nupvals</code> field</li>
<li><code>a</code>: Fills the <code>nparams</code> and <code>isvararg</code> fields</li>
<li><code>f</code>: Pushes closure to the stack</li>
</ul>
<p>For example, if <code>name</code>, <code>currentline</code>, and <code>short_src</code> is desired, the <code>what</code> string could be set to <code>"nsl"</code>.</p>
<p>Returns <code>0</code> on failure, otherwise <code>1</code>.</p>
<div class="language-cpp highlight"><span class="filename">Example</span><pre><span></span><code><span id="__span-147-1"><a id="__codelineno-147-1" name="__codelineno-147-1" href="#__codelineno-147-1"></a><span class="n">lua_State</span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_newthread</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
</span><span id="__span-147-2"><a id="__codelineno-147-2" name="__codelineno-147-2" href="#__codelineno-147-2"></a><span class="c1">// ... setup T to have a function to resume</span>
</span><span id="__span-147-3"><a id="__codelineno-147-3" name="__codelineno-147-3" href="#__codelineno-147-3"></a>
</span><span id="__span-147-4"><a id="__codelineno-147-4" name="__codelineno-147-4" href="#__codelineno-147-4"></a><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_resume</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span><span id="__span-147-5"><a id="__codelineno-147-5" name="__codelineno-147-5" href="#__codelineno-147-5"></a>
</span><span id="__span-147-6"><a id="__codelineno-147-6" name="__codelineno-147-6" href="#__codelineno-147-6"></a><span class="c1">// Use lua_getinfo to create a clearer error message:</span>
</span><span id="__span-147-7"><a id="__codelineno-147-7" name="__codelineno-147-7" href="#__codelineno-147-7"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">LUA_OK</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">LUA_YIELD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-147-8"><a id="__codelineno-147-8" name="__codelineno-147-8" href="#__codelineno-147-8"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">error</span><span class="p">;</span>
</span><span id="__span-147-9"><a id="__codelineno-147-9" name="__codelineno-147-9" href="#__codelineno-147-9"></a>
</span><span id="__span-147-10"><a id="__codelineno-147-10" name="__codelineno-147-10" href="#__codelineno-147-10"></a><span class="hll"><span class="w">    </span><span class="n">lua_Debug</span><span class="w"> </span><span class="n">ar</span><span class="p">;</span>
</span></span><span id="__span-147-11"><a id="__codelineno-147-11" name="__codelineno-147-11" href="#__codelineno-147-11"></a><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lua_getinfo</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;nsl&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span></span><span id="__span-147-12"><a id="__codelineno-147-12" name="__codelineno-147-12" href="#__codelineno-147-12"></a><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ar</span><span class="p">.</span><span class="n">short_src</span><span class="p">;</span>
</span><span id="__span-147-13"><a id="__codelineno-147-13" name="__codelineno-147-13" href="#__codelineno-147-13"></a><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sc">&#39;:&#39;</span><span class="p">;</span>
</span><span id="__span-147-14"><a id="__codelineno-147-14" name="__codelineno-147-14" href="#__codelineno-147-14"></a><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">ar</span><span class="p">.</span><span class="n">currentline</span><span class="p">);</span>
</span><span id="__span-147-15"><a id="__codelineno-147-15" name="__codelineno-147-15" href="#__codelineno-147-15"></a><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="p">;</span>
</span><span id="__span-147-16"><a id="__codelineno-147-16" name="__codelineno-147-16" href="#__codelineno-147-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-147-17"><a id="__codelineno-147-17" name="__codelineno-147-17" href="#__codelineno-147-17"></a>
</span><span id="__span-147-18"><a id="__codelineno-147-18" name="__codelineno-147-18" href="#__codelineno-147-18"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lua_tostring</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-147-19"><a id="__codelineno-147-19" name="__codelineno-147-19" href="#__codelineno-147-19"></a><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>
</span><span id="__span-147-20"><a id="__codelineno-147-20" name="__codelineno-147-20" href="#__codelineno-147-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-147-21"><a id="__codelineno-147-21" name="__codelineno-147-21" href="#__codelineno-147-21"></a>
</span><span id="__span-147-22"><a id="__codelineno-147-22" name="__codelineno-147-22" href="#__codelineno-147-22"></a><span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">stacktrace:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-147-23"><a id="__codelineno-147-23" name="__codelineno-147-23" href="#__codelineno-147-23"></a><span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">lua_debugtrace</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
</span><span id="__span-147-24"><a id="__codelineno-147-24" name="__codelineno-147-24" href="#__codelineno-147-24"></a>
</span><span id="__span-147-25"><a id="__codelineno-147-25" name="__codelineno-147-25" href="#__codelineno-147-25"></a><span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
</span><span id="__span-147-26"><a id="__codelineno-147-26" name="__codelineno-147-26" href="#__codelineno-147-26"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="lua_getargument"><span class="subsection"><code>lua_getargument</code></span><a class="headerlink" href="#lua_getargument" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getargument(lua_State* L, int level, int n)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
<li><code>n</code>: Argument number</li>
</ul>
<p>Gets argument <code>n</code> at the given stack level. If found, the value is pushed to the top of the stack and the function returns <code>1</code>. Otherwise, the function returns <code>0</code> and nothing is pushed to the stack.</p>
<hr />
<h3 id="lua_getlocal"><span class="subsection"><code>lua_getlocal</code></span><a class="headerlink" href="#lua_getlocal" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getlocal(lua_State* L, int level, int n)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
<li><code>n</code>: Argument number</li>
</ul>
<p>Gets a local variable at the given stack level and pushes the value onto the stack. The name of the local variable is returned, and the value on the stack is popped. If no local is found, <code>NULL</code> is returned and nothing is pushed to the stack.</p>
<hr />
<h3 id="lua_setlocal"><span class="subsection"><code>lua_setlocal</code></span><a class="headerlink" href="#lua_setlocal" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setlocal(lua_State* L, int level, int n)</code></span>
<span class="stack"><code>[-(0|1), +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
<li><code>n</code>: Argument number</li>
</ul>
<p>Sets a local variable at the given stack level to the value at the top of the stack. The name of the local variable is returned, and the value on the stack is popped. If no local is found, <code>NULL</code> is returned and nothing is popped from the stack.</p>
<hr />
<h3 id="lua_getupvalue"><span class="subsection"><code>lua_getupvalue</code></span><a class="headerlink" href="#lua_getupvalue" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_getupvalue(lua_State* L, int level, int n)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
<li><code>n</code>: Argument number</li>
</ul>
<p>Pushes an upvalue to the stack, and returns its name. If not found, returns <code>NULL</code> and nothing is pushed to the stack.</p>
<hr />
<h3 id="lua_setupvalue"><span class="subsection"><code>lua_setupvalue</code></span><a class="headerlink" href="#lua_setupvalue" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_setupvalue(lua_State* L, int level, int n)</code></span>
<span class="stack"><code>[-0, +(0|1), -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
<li><code>n</code>: Argument number</li>
</ul>
<p>Pops a value off the stack and sets the given upvalue with the popped value, and returns its name. If not found, returns <code>NULL</code> and nothing is popped from the stack.</p>
<hr />
<h3 id="lua_singlestep"><span class="subsection"><code>lua_singlestep</code></span><a class="headerlink" href="#lua_singlestep" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_singlestep(lua_State* L, int enabled)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>enabled</code>: Enabled</li>
</ul>
<p>Enables or disables single-step mode.</p>
<hr />
<h3 id="lua_breakpoint"><span class="subsection"><code>lua_breakpoint</code></span><a class="headerlink" href="#lua_breakpoint" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>int lua_breakpoint(lua_State* L, int funcindex, int line, int enabled)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>funcindex</code>: Function index</li>
<li><code>line</code>: Line</li>
<li><code>enabled</code>: Enabled</li>
</ul>
<p>Enables or disables a breakpoint at the given line within the given function at <code>funcindex</code> on the stack.</p>
<hr />
<h3 id="lua_getcoverage"><span class="subsection"><code>lua_getcoverage</code></span><a class="headerlink" href="#lua_getcoverage" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void lua_getcoverage(lua_State* L, int funcindex, void* context, lua_Coverage callback)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>funcindex</code>: Function index</li>
<li><code>context</code>: Context</li>
<li><code>callback</code>: Coverage callback function</li>
</ul>
<p>Get coverage.</p>
<hr />
<h3 id="lua_debugtrace"><span class="subsection"><code>lua_debugtrace</code></span><a class="headerlink" href="#lua_debugtrace" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>const char* lua_debugtrace(lua_State* L)</code></span>
<span class="stack"><code>[-0, +0, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
</ul>
<p>Gets a traceback string.</p>
<p><strong>Note:</strong> Internally, this uses a static string buffer. Thus, this function is not thread-safe, nor is it safe to hold onto the returned value. Create a copy of the returned string if needed.</p>
<hr />
<h3 id="lual_where"><span class="subsection"><code>luaL_where</code></span><a class="headerlink" href="#lual_where" title="Permanent link">&para;</a></h3>
<p><span class="signature"><code>void luaL_where(lua_State* L, int level)</code></span>
<span class="stack"><code>[-0, +1, -]</code></span></p>
<ul>
<li><code>L</code>: Lua thread</li>
<li><code>level</code>: Stack level</li>
</ul>
<p>Pushes a string onto the stack containing the short source and current line, e.g. <code>"some/script.luau:10: "</code>. This is often used as a prefix for other debug logging information.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Home">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Home
              </div>
            </div>
          </a>
        
        
          
          <a href="guides/setup.html" class="md-footer__link md-footer__link--next" aria-label="Next: Setup">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Setup
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["content.code.copy", "navigation.instant", "navigation.tabs", "navigation.footer", "toc.integrate"], "search": "assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>